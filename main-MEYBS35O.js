import{A as $b,B as En,C as ci,D as Yd,E as $c,F as hy,G as qb,H as Hb,I as G,J as en,K as ut,L as fy,M as Gb,N as qc,O as ue,P as ln,Q as Zd,R as py,S as In,T as li,U as ls,V as Xd,W as zb,X as jn,Y as Ct,a as A,b as le,c as ly,d as v,e as Pb,f as Gd,g as kb,h as Ob,i as T,j as Ro,k as zd,l as Fb,m as Lb,n as pt,o as Wd,p as Bc,q as uy,r as Vb,s as nr,t as dy,u as Kd,v as jb,w as Ub,x as Qd,y as et,z as Bb}from"./chunk-QKIWL4TY.js";var Wb=null;var gy=1,my=Symbol("SIGNAL");function Ie(t){let e=Wb;return Wb=t,e}var Kb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function eV(t){if(!(vy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===gy)){if(!t.producerMustRecompute(t)&&!yy(t)){t.dirty=!1,t.lastCleanEpoch=gy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=gy}}function Qb(t){return t&&(t.nextProducerIndex=0),Ie(t)}function Yb(t,e){if(Ie(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(vy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)_y(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function yy(t){Jd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(eV(n),r!==n.version))return!0}return!1}function Zb(t){if(Jd(t),vy(t))for(let e=0;e<t.producerNode.length;e++)_y(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function _y(t,e){if(tV(t),Jd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)_y(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Jd(i),i.producerIndexOfThis[r]=e}}function vy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Jd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function tV(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function nV(){throw new Error}var rV=nV;function Xb(t){rV=t}function Q(t){return typeof t=="function"}function No(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var eh=No(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function us(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ke=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Q(r))try{r()}catch(s){e=s instanceof eh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Jb(s)}catch(o){e=e??[],o instanceof eh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new eh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Jb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&us(n,e)}remove(e){let{_finalizers:n}=this;n&&us(n,e),e instanceof t&&e._removeParent(this)}};Ke.EMPTY=(()=>{let t=new Ke;return t.closed=!0,t})();var wy=Ke.EMPTY;function th(t){return t instanceof Ke||t&&"closed"in t&&Q(t.remove)&&Q(t.add)&&Q(t.unsubscribe)}function Jb(t){Q(t)?t():t.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Po={setTimeout(t,e,...n){let{delegate:r}=Po;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Po;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function nh(t){Po.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(t);else throw t})}function ds(){}var eT=Ey("C",void 0,void 0);function tT(t){return Ey("E",void 0,t)}function nT(t){return Ey("N",t,void 0)}function Ey(t,e,n){return{kind:t,value:e,error:n}}var hs=null;function ko(t){if(Un.useDeprecatedSynchronousErrorHandling){let e=!hs;if(e&&(hs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=hs;if(hs=null,n)throw r}}else t()}function rT(t){Un.useDeprecatedSynchronousErrorHandling&&hs&&(hs.errorThrown=!0,hs.error=t)}var fs=class extends Ke{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,th(e)&&e.add(this)):this.destination=oV}static create(e,n,r){return new Or(e,n,r)}next(e){this.isStopped?Cy(nT(e),this):this._next(e)}error(e){this.isStopped?Cy(tT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Cy(eT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},iV=Function.prototype.bind;function Iy(t,e){return iV.call(t,e)}var Dy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){rh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){rh(r)}else rh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){rh(n)}}},Or=class extends fs{constructor(e,n,r){super();let i;if(Q(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Un.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Iy(e.next,s),error:e.error&&Iy(e.error,s),complete:e.complete&&Iy(e.complete,s)}):i=e}this.destination=new Dy(i)}};function rh(t){Un.useDeprecatedSynchronousErrorHandling?rT(t):nh(t)}function sV(t){throw t}function Cy(t,e){let{onStoppedNotification:n}=Un;n&&Po.setTimeout(()=>n(t,e))}var oV={closed:!0,next:ds,error:sV,complete:ds};var Oo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Dt(t){return t}function by(...t){return Ty(t)}function Ty(t){return t.length===0?Dt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=cV(n)?n:new Or(n,r,i);return ko(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=iT(r),new r((i,s)=>{let o=new Or({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Oo](){return this}pipe(...n){return Ty(n)(this)}toPromise(n){return n=iT(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function iT(t){var e;return(e=t??Un.Promise)!==null&&e!==void 0?e:Promise}function aV(t){return t&&Q(t.next)&&Q(t.error)&&Q(t.complete)}function cV(t){return t&&t instanceof fs||aV(t)&&th(t)}function Sy(t){return Q(t?.lift)}function X(t){return e=>{if(Sy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,i){return new Ay(t,e,n,r,i)}var Ay=class extends fs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Fo(){return X((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Lo=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Sy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ke;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ke.EMPTY)}return e}refCount(){return Fo()(this)}};var sT=No(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var tt=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new ih(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new sT}next(n){ko(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){ko(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){ko(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?wy:(this.currentObservers=null,s.push(n),new Ke(()=>{this.currentObservers=null,us(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new ih(e,n),t})(),ih=class extends tt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:wy}};var bt=class extends tt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Hc={now(){return(Hc.delegate||Date).now()},delegate:void 0};var sh=class extends tt{constructor(e=1/0,n=1/0,r=Hc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var oh=class extends Ke{constructor(e,n){super()}schedule(e,n=0){return this}};var Gc={setInterval(t,e,...n){let{delegate:r}=Gc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Gc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Vo=class extends oh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Gc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Gc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,us(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var jo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};jo.now=Hc.now;var Uo=class extends jo{constructor(e,n=jo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var ps=new Uo(Vo);var ah=class extends Vo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var ch=class extends Uo{};var xy=new ch(ah);var tn=new ne(t=>t.complete());function oT(t){return t&&Q(t.schedule)}function My(t){return t[t.length-1]}function Bo(t){return Q(My(t))?t.pop():void 0}function rr(t){return oT(My(t))?t.pop():void 0}function aT(t,e){return typeof My(t)=="number"?t.pop():e}var lh=t=>t&&typeof t.length=="number"&&typeof t!="function";function uh(t){return Q(t?.then)}function dh(t){return Q(t[Oo])}function hh(t){return Symbol.asyncIterator&&Q(t?.[Symbol.asyncIterator])}function fh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function lV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ph=lV();function gh(t){return Q(t?.[ph])}function mh(t){return kb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Gd(n.read());if(i)return yield Gd(void 0);yield yield Gd(r)}}finally{n.releaseLock()}})}function yh(t){return Q(t?.getReader)}function Te(t){if(t instanceof ne)return t;if(t!=null){if(dh(t))return uV(t);if(lh(t))return dV(t);if(uh(t))return hV(t);if(hh(t))return cT(t);if(gh(t))return fV(t);if(yh(t))return pV(t)}throw fh(t)}function uV(t){return new ne(e=>{let n=t[Oo]();if(Q(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function dV(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function hV(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,nh)})}function fV(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function cT(t){return new ne(e=>{gV(t,e).catch(n=>e.error(n))})}function pV(t){return cT(mh(t))}function gV(t,e){var n,r,i,s;return Pb(this,void 0,void 0,function*(){try{for(n=Ob(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function nn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Cn(t,e=0){return X((n,r)=>{n.subscribe(Y(r,i=>nn(r,t,()=>r.next(i),e),()=>nn(r,t,()=>r.complete(),e),i=>nn(r,t,()=>r.error(i),e)))})}function Bn(t,e=0){return X((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function lT(t,e){return Te(t).pipe(Bn(e),Cn(e))}function uT(t,e){return Te(t).pipe(Bn(e),Cn(e))}function dT(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function hT(t,e){return new ne(n=>{let r;return nn(n,e,()=>{r=t[ph](),nn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Q(r?.return)&&r.return()})}function _h(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{nn(n,e,()=>{let r=t[Symbol.asyncIterator]();nn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function fT(t,e){return _h(mh(t),e)}function pT(t,e){if(t!=null){if(dh(t))return lT(t,e);if(lh(t))return dT(t,e);if(uh(t))return uT(t,e);if(hh(t))return _h(t,e);if(gh(t))return hT(t,e);if(yh(t))return fT(t,e)}throw fh(t)}function pe(t,e){return e?pT(t,e):Te(t)}function U(...t){let e=rr(t);return pe(t,e)}function $o(t,e){let n=Q(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function Ry(t){return!!t&&(t instanceof ne||Q(t.lift)&&Q(t.subscribe))}var Fr=No(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:mV}=Array;function yV(t,e){return mV(e)?t(...e):t(e)}function vh(t){return j(e=>yV(t,e))}var{isArray:_V}=Array,{getPrototypeOf:vV,prototype:wV,keys:EV}=Object;function wh(t){if(t.length===1){let e=t[0];if(_V(e))return{args:e,keys:null};if(IV(e)){let n=EV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function IV(t){return t&&typeof t=="object"&&vV(t)===wV}function Eh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function zc(...t){let e=rr(t),n=Bo(t),{args:r,keys:i}=wh(t);if(r.length===0)return pe([],e);let s=new ne(CV(r,e,i?o=>Eh(i,o):Dt));return n?s.pipe(vh(n)):s}function CV(t,e,n=Dt){return r=>{gT(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)gT(e,()=>{let l=pe(t[c],e),u=!1;l.subscribe(Y(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function gT(t,e,n){t?nn(n,t,e):e()}function mT(t,e,n,r,i,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<r?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let m=!1;Te(n(g,u++)).subscribe(Y(e,w=>{i?.(w),s?f(w):e.next(w)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<r;){let w=c.shift();o?nn(e,o,()=>p(w)):p(w)}h()}catch(w){e.error(w)}}))};return t.subscribe(Y(e,f,()=>{d=!0,h()})),()=>{a?.()}}function nt(t,e,n=1/0){return Q(e)?nt((r,i)=>j((s,o)=>e(r,s,i,o))(Te(t(r,i))),n):(typeof e=="number"&&(n=e),X((r,i)=>mT(r,i,t,n)))}function ui(t=1/0){return nt(Dt,t)}function yT(){return ui(1)}function qo(...t){return yT()(pe(t,rr(t)))}function Ih(t){return new ne(e=>{Te(t()).subscribe(e)})}function Ny(...t){let e=Bo(t),{args:n,keys:r}=wh(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;Te(n[u]).subscribe(Y(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(r?Eh(r,a):a),s.complete())}))}});return e?i.pipe(vh(e)):i}function Ho(...t){let e=rr(t),n=aT(t,1/0),r=t;return r.length?r.length===1?Te(r[0]):ui(n)(pe(r,e)):tn}function dt(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>t.call(e,s,i++)&&r.next(s)))})}function di(t){return X((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Y(n,void 0,void 0,o=>{s=Te(t(o,di(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function _T(t,e,n,r,i){return(s,o)=>{let a=n,c=e,l=0;s.subscribe(Y(o,u=>{let d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Lr(t,e){return Q(e)?nt(t,e,1):nt(t,1)}function hi(t){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Vr(t){return t<=0?()=>tn:X((e,n)=>{let r=0;e.subscribe(Y(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Py(t){return j(()=>t)}function Wc(t,e=Dt){return t=t??DV,X((n,r)=>{let i,s=!0;n.subscribe(Y(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function DV(t,e){return t===e}function Ch(t=bV){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function bV(){return new Fr}function fi(t){return X((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Dn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dt((i,s)=>t(i,s,r)):Dt,Vr(1),n?hi(e):Ch(()=>new Fr))}function Go(t){return t<=0?()=>tn:X((e,n)=>{let r=[];e.subscribe(Y(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function ky(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dt((i,s)=>t(i,s,r)):Dt,Go(1),n?hi(e):Ch(()=>new Fr))}function Kc(){return X((t,e)=>{let n,r=!1;t.subscribe(Y(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function ir(t,e){return X(_T(t,e,arguments.length>=2,!0))}function Qc(t={}){let{connector:e=()=>new tt,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,l=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return X((g,m)=>{l++,!d&&!u&&h();let w=c=c??e();m.add(()=>{l--,l===0&&!d&&!u&&(a=Oy(p,i))}),w.subscribe(m),!o&&l>0&&(o=new Or({next:O=>w.next(O),error:O=>{d=!0,h(),a=Oy(f,n,O),w.error(O)},complete:()=>{u=!0,h(),a=Oy(f,r),w.complete()}}),Te(g).subscribe(o))})(s)}}function Oy(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Or({next:()=>{r.unsubscribe(),t()}});return Te(e(...n)).subscribe(r)}function Dh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Qc({connector:()=>new sh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Fy(t){return X((e,n)=>{let r=!1,i=0;e.subscribe(Y(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function gs(...t){let e=rr(t);return X((n,r)=>{(e?qo(t,n,e):qo(t,n)).subscribe(r)})}function Me(t,e){return X((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Y(r,c=>{i?.unsubscribe();let l=0,u=s++;Te(t(c,u)).subscribe(i=Y(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function bh(t,e){return Q(e)?Me(()=>t,e):Me(()=>t)}function Ly(t){return X((e,n)=>{Te(t).subscribe(Y(n,()=>n.complete(),ds)),!n.closed&&e.subscribe(n)})}function Qe(t,e,n){let r=Q(t)||e||n?{next:t,error:e,complete:n}:t;return r?X((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Y(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Dt}function Vy(...t){let e=Bo(t);return X((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Te(t[c]).subscribe(Y(r,l=>{s[c]=l,!a&&!o[c]&&(o[c]=!0,(a=o.every(Dt))&&(o=null))},ds));n.subscribe(Y(r,c=>{if(a){let l=[c,...s];r.next(e?e(...l):l)}}))})}var iS="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(sf(e,n)),this.code=e}};function sf(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var e_=class extends tt{constructor(e=!1){super(),this.__isAsync=e}emit(e){let n=Ie(null);try{super.next(e)}finally{Ie(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=jy(s),i&&(i=jy(i)),o&&(o=jy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ke&&e.add(a),a}};function jy(t){return e=>{setTimeout(t,void 0,e)}}var ht=e_;var ae=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ae||{});function Ut(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Ut).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function vT(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var sS=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(sS||{}),ar=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(ar||{});function cl(t){return{toString:t}.toString()}var Bt=globalThis;var Xo={},Tn=[];function Se(t){for(let e in t)if(t[e]===Se)return e;throw Error("Could not find renamed property on target object.")}function TV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}var SV=Se({\u0275cmp:Se}),AV=Se({\u0275dir:Se}),xV=Se({\u0275pipe:Se}),MV=Se({\u0275mod:Se}),Fh=Se({\u0275fac:Se}),Yc=Se({__NG_ELEMENT_ID__:Se}),wT=Se({__NG_ENV_ID__:Se}),$t=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}($t||{});function oS(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function t_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];RV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function aS(t){return t===3||t===4||t===6}function RV(t){return t.charCodeAt(0)===64}function Xc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?ET(t,n,i,null,e[++r]):ET(t,n,i,null,null))}}return t}function ET(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var cS="ng-template";function NV(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&oS(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function lS(t){return t.type===4&&t.value!==cS}function PV(t,e,n){let r=t.type===4&&!n?cS:t.value;return e===r}function kV(t,e,n){let r=4,i=t.attrs||[],s=LV(i),o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!$n(r)&&!$n(c))return!1;if(o&&$n(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!PV(t,c,n)||c===""&&e.length===1){if($n(r))return!1;o=!0}}else{let l=r&8?c:e[++a];if(r&8&&t.attrs!==null){if(!NV(t.attrs,l,n)){if($n(r))return!1;o=!0}continue}let u=r&8?"class":c,d=OV(u,i,lS(t),n);if(d===-1){if($n(r))return!1;o=!0;continue}if(l!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&oS(f,l,0)!==-1||r&2&&l!==h){if($n(r))return!1;o=!0}}}}return $n(r)||o}function $n(t){return(t&1)===0}function OV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return VV(e,t)}function FV(t,e,n=!1){for(let r=0;r<e.length;r++)if(kV(t,e[r],n))return!0;return!1}function LV(t){for(let e=0;e<t.length;e++){let n=t[e];if(aS(n))return e}return t.length}function VV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function IT(t,e){return t?":not("+e.trim()+")":e}function jV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!$n(o)&&(e+=IT(s,i),i=""),r=o,s=s||!$n(r);n++}return i!==""&&(e+=IT(s,i)),e}function UV(t){return t.map(jV).join(",")}function BV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!$n(i))break;i=s}r++}return{attrs:e,classes:n}}function Rt(t){return cl(()=>{let e=pS(t),n=le(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===sS.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||ar.Emulated,styles:t.styles||Tn,_:null,schemas:t.schemas||null,tView:null,id:""});gS(n);let r=t.dependencies;return n.directiveDefs=DT(r,!1),n.pipeDefs=DT(r,!0),n.id=HV(n),n})}function $V(t){return mi(t)||uS(t)}function qV(t){return t!==null}function $e(t){return cl(()=>({type:t.type,bootstrap:t.bootstrap||Tn,declarations:t.declarations||Tn,imports:t.imports||Tn,exports:t.exports||Tn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function CT(t,e){if(t==null)return Xo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=$t.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==$t.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Tt(t){return cl(()=>{let e=pS(t);return gS(e),e})}function mi(t){return t[SV]||null}function uS(t){return t[AV]||null}function dS(t){return t[xV]||null}function hS(t){let e=mi(t)||uS(t)||dS(t);return e!==null?e.standalone:!1}function fS(t,e){let n=t[MV]||null;if(!n&&e===!0)throw new Error(`Type ${Ut(t)} does not have '\u0275mod' property.`);return n}function pS(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Xo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Tn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:CT(t.inputs,e),outputs:CT(t.outputs),debugInfo:null}}function gS(t){t.features?.forEach(e=>e(t))}function DT(t,e){if(!t)return null;let n=e?dS:$V;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(qV)}function HV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var $r=0,ge=1,W=2,Mt=3,qn=4,Gn=5,Lh=6,Jc=7,Hn=8,Jo=9,jr=10,rt=11,el=12,bT=13,aa=14,cr=15,of=16,zo=17,ea=18,af=19,mS=20,gi=21,Uy=22,_s=23,yi=25,yS=1;var vs=7,Vh=8,jh=9,Sn=10,B_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(B_||{});function ms(t){return Array.isArray(t)&&typeof t[yS]=="object"}function qr(t){return Array.isArray(t)&&t[yS]===!0}function _S(t){return(t.flags&4)!==0}function cf(t){return t.componentOffset>-1}function $_(t){return(t.flags&1)===1}function _i(t){return!!t.template}function GV(t){return(t[W]&512)!==0}var zV="svg",WV="math",KV=!1;function QV(){return KV}function lr(t){for(;Array.isArray(t);)t=t[$r];return t}function vS(t,e){return lr(e[t])}function An(t,e){return lr(e[t.index])}function wS(t,e){return t.data[e]}function wi(t,e){let n=e[t];return ms(n)?n:n[$r]}function q_(t){return(t[W]&128)===128}function YV(t){return qr(t[Mt])}function Uh(t,e){return e==null?null:t[e]}function ES(t){t[zo]=0}function ZV(t){t[W]&1024||(t[W]|=1024,q_(t)&&tl(t))}function XV(t,e){for(;t>0;)e=e[aa],t--;return e}function H_(t){return!!(t[W]&9216||t[_s]?.dirty)}function n_(t){H_(t)?tl(t):t[W]&64&&(QV()?(t[W]|=1024,tl(t)):t[jr].changeDetectionScheduler?.notify())}function tl(t){t[jr].changeDetectionScheduler?.notify();let e=nl(t);for(;e!==null&&!(e[W]&8192||(e[W]|=8192,!q_(e)));)e=nl(e)}function IS(t,e){if((t[W]&256)===256)throw new $(911,!1);t[gi]===null&&(t[gi]=[]),t[gi].push(e)}function JV(t,e){if(t[gi]===null)return;let n=t[gi].indexOf(e);n!==-1&&t[gi].splice(n,1)}function nl(t){let e=t[Mt];return qr(e)?e[Mt]:e}var he={lFrame:xS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function e2(){return he.lFrame.elementDepthCount}function t2(){he.lFrame.elementDepthCount++}function n2(){he.lFrame.elementDepthCount--}function CS(){return he.bindingsEnabled}function r2(){return he.skipHydrationRootTNode!==null}function i2(t){return he.skipHydrationRootTNode===t}function s2(){he.skipHydrationRootTNode=null}function Re(){return he.lFrame.lView}function rn(){return he.lFrame.tView}function un(t){return he.lFrame.contextLView=t,t[Hn]}function dn(t){return he.lFrame.contextLView=null,t}function sn(){let t=DS();for(;t!==null&&t.type===64;)t=t.parent;return t}function DS(){return he.lFrame.currentTNode}function o2(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function ll(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function bS(){return he.lFrame.isParent}function a2(){he.lFrame.isParent=!1}function c2(t){return he.lFrame.bindingIndex=t}function lf(){return he.lFrame.bindingIndex++}function l2(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function u2(){return he.lFrame.inI18n}function d2(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,r_(e)}function h2(){return he.lFrame.currentDirectiveIndex}function r_(t){he.lFrame.currentDirectiveIndex=t}function f2(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function TS(t){he.lFrame.currentQueryIndex=t}function p2(t){let e=t[ge];return e.type===2?e.declTNode:e.type===1?t[Gn]:null}function SS(t,e,n){if(n&ae.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ae.Host);)if(i=p2(s),i===null||(s=s[aa],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=AS();return r.currentTNode=e,r.lView=t,!0}function G_(t){let e=AS(),n=t[ge];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function AS(){let t=he.lFrame,e=t===null?null:t.child;return e===null?xS(t):e}function xS(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function MS(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var RS=MS;function z_(){let t=MS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function g2(t){return(he.lFrame.contextLView=XV(t,he.lFrame.contextLView))[Hn]}function ca(){return he.lFrame.selectedIndex}function ws(t){he.lFrame.selectedIndex=t}function uf(){let t=he.lFrame;return wS(t.tView,t.selectedIndex)}function m2(){return he.lFrame.currentNamespace}var NS=!0;function W_(){return NS}function K_(t){NS=t}function y2(){return df(sn(),Re())}function df(t,e){return new dr(An(t,e))}var dr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=y2;let t=e;return t})();function Q_(t,e){t.forEach(n=>Array.isArray(n)?Q_(n,e):e(n))}function PS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Bh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function _2(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function v2(t,e,n){let r=ul(t,e);return r>=0?t[r|1]=n:(r=~r,_2(t,r,e,n)),r}function By(t,e){let n=ul(t,e);if(n>=0)return t[n|1]}function ul(t,e){return w2(t,e,1)}function w2(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}function kS(t){return(t.flags&128)===128}var i_;function OS(t){i_=t}function E2(){if(i_!==void 0)return i_;if(typeof document<"u")return document;throw new $(210,!1)}function F(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function qe(t){return{providers:t.providers||[],imports:t.imports||[]}}function hf(t){return TT(t,LS)||TT(t,VS)}function FS(t){return hf(t)!==null}function TT(t,e){return t.hasOwnProperty(e)?t[e]:null}function I2(t){let e=t&&(t[LS]||t[VS]);return e||null}function ST(t){return t&&(t.hasOwnProperty(AT)||t.hasOwnProperty(C2))?t[AT]:null}var LS=Se({\u0275prov:Se}),AT=Se({\u0275inj:Se}),VS=Se({ngInjectableDef:Se}),C2=Se({ngInjectorDef:Se}),N=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=F({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}},ff=new N("",{providedIn:"root",factory:()=>D2}),D2="ng",Y_=new N(""),gt=new N("",{providedIn:"platform",factory:()=>"unknown"});var Z_=new N("",{providedIn:"root",factory:()=>E2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var b2=Se({__forward_ref__:Se});function Ei(t){return t.__forward_ref__=Ei,t.toString=function(){return Ut(this())},t}function jt(t){return jS(t)?t():t}function jS(t){return typeof t=="function"&&t.hasOwnProperty(b2)&&t.__forward_ref__===Ei}function US(t){return t&&!!t.\u0275providers}function pf(t){return typeof t=="string"?t:t==null?"":String(t)}function T2(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():pf(t)}function S2(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function X_(t,e){throw new $(-201,!1)}var s_;function BS(){return s_}function bn(t){let e=s_;return s_=t,e}function $S(t,e,n){let r=hf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ae.Optional)return null;if(e!==void 0)return e;X_(t,"Injector")}var A2={},rl=A2,o_="__NG_DI_FLAG__",$h="ngTempTokenPath",x2="ngTokenPath",M2=/\n/gm,R2="\u0275",xT="__source",Yo;function N2(){return Yo}function pi(t){let e=Yo;return Yo=t,e}function P2(t,e=ae.Default){if(Yo===void 0)throw new $(-203,!1);return Yo===null?$S(t,void 0,e):Yo.get(t,e&ae.Optional?null:void 0,e)}function E(t,e=ae.Default){return(BS()||P2)(jt(t),e)}function M(t,e=ae.Default){return E(t,gf(e))}function gf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function a_(t){let e=[];for(let n=0;n<t.length;n++){let r=jt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=ae.Default;for(let o=0;o<r.length;o++){let a=r[o],c=k2(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function qS(t,e){return t[o_]=e,t.prototype[o_]=e,t}function k2(t){return t[o_]}function O2(t,e,n,r){let i=t[$h];throw e[xT]&&i.unshift(e[xT]),t.message=F2(`
`+t.message,i,n,r),t[x2]=i,t[$h]=null,t}function F2(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==R2?t.slice(2):t;let i=Ut(e);if(Array.isArray(e))i=e.map(Ut).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Ut(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(M2,`
  `)}`}var L2="h",V2="b";var j2=()=>null;function J_(t,e,n=!1){return j2(t,e,n)}var Th="__parameters__";function U2(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function HS(t,e,n){return cl(()=>{let r=U2(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(Th)?c[Th]:Object.defineProperty(c,Th,{value:[]})[Th];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var la=qS(HS("Optional"),8);var ev=qS(HS("SkipSelf"),4);function ta(t,e){let n=t.hasOwnProperty(Fh);return n?t[Fh]:null}var na=new N(""),GS=new N("",-1),zS=new N(""),qh=class{get(e,n=rl){if(n===rl){let r=new Error(`NullInjectorError: No provider for ${Ut(e)}!`);throw r.name="NullInjectorError",r}return n}};function mf(t){return{\u0275providers:t}}function B2(...t){return{\u0275providers:WS(!0,t),\u0275fromNgModule:!0}}function WS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Q_(e,o=>{let a=o;c_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&KS(i,s),n}function KS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];tv(i,s=>{e(s,r)})}}function c_(t,e,n,r){if(t=jt(t),!t)return!1;let i=null,s=ST(t),o=!s&&mi(t);if(!s&&!o){let c=t.ngModule;if(s=ST(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)c_(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Q_(s.imports,u=>{c_(u,e,n,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&KS(l,e)}if(!a){let l=ta(i)||(()=>new i);e({provide:i,useFactory:l,deps:Tn},i),e({provide:zS,useValue:i,multi:!0},i),e({provide:na,useValue:()=>E(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=t;tv(c,u=>{e(u,l)})}}else return!1;return i!==t&&t.providers!==void 0}function tv(t,e){for(let n of t)US(n)&&(n=n.\u0275providers),Array.isArray(n)?tv(n,e):e(n)}var $2=Se({provide:String,useValue:Se});function QS(t){return t!==null&&typeof t=="object"&&$2 in t}function q2(t){return!!(t&&t.useExisting)}function H2(t){return!!(t&&t.useFactory)}function ra(t){return typeof t=="function"}function G2(t){return!!t.useClass}var yf=new N(""),Rh={},z2={},$y;function nv(){return $y===void 0&&($y=new qh),$y}var qt=class{},il=class extends qt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,u_(e,o=>this.processProvider(o)),this.records.set(GS,Wo(void 0,this)),i.has("environment")&&this.records.set(qt,Wo(void 0,this));let s=this.records.get(yf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(zS,Tn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ie(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ie(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=pi(this),r=bn(void 0),i;try{return e()}finally{pi(n),bn(r)}}get(e,n=rl,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(wT))return e[wT](this);r=gf(r);let i,s=pi(this),o=bn(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=Z2(e)&&hf(e);l&&this.injectableDefInScope(l)?c=Wo(l_(e),Rh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?nv():this.parent;return n=r&ae.Optional&&n===rl?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[$h]=a[$h]||[]).unshift(Ut(e)),s)throw a;return O2(a,e,"R3InjectorError",this.source)}else throw a}finally{bn(o),pi(s)}}resolveInjectorInitializers(){let e=Ie(null),n=pi(this),r=bn(void 0),i;try{let s=this.get(na,Tn,ae.Self);for(let o of s)o()}finally{pi(n),bn(r),Ie(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Ut(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=jt(e);let n=ra(e)?e:jt(e&&e.provide),r=K2(e);if(!ra(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Wo(void 0,Rh,!0),i.factory=()=>a_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Ie(null);try{return n.value===Rh&&(n.value=z2,n.value=n.factory()),typeof n.value=="object"&&n.value&&Y2(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Ie(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=jt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function l_(t){let e=hf(t),n=e!==null?e.factory:ta(t);if(n!==null)return n;if(t instanceof N)throw new $(204,!1);if(t instanceof Function)return W2(t);throw new $(204,!1)}function W2(t){if(t.length>0)throw new $(204,!1);let n=I2(t);return n!==null?()=>n.factory(t):()=>new t}function K2(t){if(QS(t))return Wo(void 0,t.useValue);{let e=YS(t);return Wo(e,Rh)}}function YS(t,e,n){let r;if(ra(t)){let i=jt(t);return ta(i)||l_(i)}else if(QS(t))r=()=>jt(t.useValue);else if(H2(t))r=()=>t.useFactory(...a_(t.deps||[]));else if(q2(t))r=()=>E(jt(t.useExisting));else{let i=jt(t&&(t.useClass||t.provide));if(Q2(t))r=()=>new i(...a_(t.deps));else return ta(i)||l_(i)}return r}function Wo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Q2(t){return!!t.deps}function Y2(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function Z2(t){return typeof t=="function"||typeof t=="object"&&t instanceof N}function u_(t,e){for(let n of t)Array.isArray(n)?u_(n,e):n&&US(n)?u_(n.\u0275providers,e):e(n)}function hr(t,e){t instanceof il&&t.assertNotDestroyed();let n,r=pi(t),i=bn(void 0);try{return e()}finally{pi(r),bn(i)}}function X2(t){if(!BS()&&!N2())throw new $(-203,!1)}function J2(t){let e=Bt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function ej(t){return typeof t=="function"}var d_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function ZS(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function bs(){return XS}function XS(t){return t.type.prototype.ngOnChanges&&(t.setInput=nj),tj}bs.ngInherit=!0;function tj(){let t=eA(this),e=t?.current;if(e){let n=t.previous;if(n===Xo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function nj(t,e,n,r,i){let s=this.declaredInputs[r],o=eA(t)||rj(t,{previous:Xo,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new d_(l&&l.currentValue,n,c===Xo),ZS(t,e,i,n)}var JS="__ngSimpleChanges__";function eA(t){return t[JS]||null}function rj(t,e){return t[JS]=e}var MT=null;var sr=function(t,e,n){MT?.(t,e,n)};function ij(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=XS(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function rv(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Nh(t,e,n){tA(t,e,3,n)}function Ph(t,e,n,r){(t[W]&3)===n&&tA(t,e,n,r)}function qy(t,e){let n=t[W];(n&3)===e&&(n&=16383,n+=1,t[W]=n)}function tA(t,e,n,r){let i=r!==void 0?t[zo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[zo]+=65536),(a<s||s==-1)&&(sj(t,n,e,c),t[zo]=(t[zo]&4294901760)+c+2),c++}function RT(t,e){sr(4,t,e);let n=Ie(null);try{e.call(t)}finally{Ie(n),sr(5,t,e)}}function sj(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[W]>>14<t[zo]>>16&&(t[W]&3)===e&&(t[W]+=16384,RT(a,s)):RT(a,s)}var Zo=-1,Es=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function oj(t){return t instanceof Es}function aj(t){return(t.flags&8)!==0}function cj(t){return(t.flags&16)!==0}function nA(t){return t!==Zo}function Hh(t){return t&32767}function lj(t){return t>>16}function Gh(t,e){let n=lj(t),r=e;for(;n>0;)r=r[aa],n--;return r}var h_=!0;function NT(t){let e=h_;return h_=t,e}var uj=256,rA=uj-1,iA=5,dj=0,or={};function hj(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Yc)&&(r=n[Yc]),r==null&&(r=n[Yc]=dj++);let i=r&rA,s=1<<i;e.data[t+(i>>iA)]|=s}function zh(t,e){let n=sA(t,e);if(n!==-1)return n;let r=e[ge];r.firstCreatePass&&(t.injectorIndex=e.length,Hy(r.data,t),Hy(e,null),Hy(r.blueprint,null));let i=iv(t,e),s=t.injectorIndex;if(nA(i)){let o=Hh(i),a=Gh(i,e),c=a[ge].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Hy(t,e){t.push(0,0,0,0,0,0,0,0,e)}function sA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function iv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=uA(i),r===null)return Zo;if(n++,i=i[aa],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Zo}function f_(t,e,n){hj(t,e,n)}function fj(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(aS(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function oA(t,e,n){if(n&ae.Optional||t!==void 0)return t;X_(e,"NodeInjector")}function aA(t,e,n,r){if(n&ae.Optional&&r===void 0&&(r=null),!(n&(ae.Self|ae.Host))){let i=t[Jo],s=bn(void 0);try{return i?i.get(e,r,n&ae.Optional):$S(e,r,n&ae.Optional)}finally{bn(s)}}return oA(r,e,n)}function cA(t,e,n,r=ae.Default,i){if(t!==null){if(e[W]&2048&&!(r&ae.Self)){let o=_j(t,e,n,r,or);if(o!==or)return o}let s=lA(t,e,n,r,or);if(s!==or)return s}return aA(e,n,r,i)}function lA(t,e,n,r,i){let s=mj(n);if(typeof s=="function"){if(!SS(e,t,r))return r&ae.Host?oA(i,n,r):aA(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ae.Optional))X_(n);else return o}finally{RS()}}else if(typeof s=="number"){let o=null,a=sA(t,e),c=Zo,l=r&ae.Host?e[cr][Gn]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?iv(t,e):e[a+8],c===Zo||!kT(r,!1)?a=-1:(o=e[ge],a=Hh(c),e=Gh(c,e)));a!==-1;){let u=e[ge];if(PT(s,a,u.data)){let d=pj(a,e,n,o,r,l);if(d!==or)return d}c=e[a+8],c!==Zo&&kT(r,e[ge].data[a+8]===l)&&PT(s,a,e)?(o=u,a=Hh(c),e=Gh(c,e)):a=-1}}return i}function pj(t,e,n,r,i,s){let o=e[ge],a=o.data[t+8],c=r==null?cf(a)&&h_:r!=o&&(a.type&3)!==0,l=i&ae.Host&&s===a,u=gj(a,o,n,c,l);return u!==null?ia(e,o,u,a):or}function gj(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,l=t.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:l;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&_i(f)&&f.type===n)return c}return null}function ia(t,e,n,r){let i=t[n],s=e.data;if(oj(i)){let o=i;o.resolving&&S2(T2(s[n]));let a=NT(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?bn(o.injectImpl):null,u=SS(t,r,ae.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&ij(n,s[n],e)}finally{l!==null&&bn(l),NT(a),o.resolving=!1,RS()}}return i}function mj(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Yc)?t[Yc]:void 0;return typeof e=="number"?e>=0?e&rA:yj:e}function PT(t,e,n){let r=1<<t;return!!(n[e+(t>>iA)]&r)}function kT(t,e){return!(t&ae.Self)&&!(t&ae.Host&&e)}var ys=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return cA(this._tNode,this._lView,e,gf(r),n)}};function yj(){return new ys(sn(),Re())}function Ii(t){return cl(()=>{let e=t.prototype.constructor,n=e[Fh]||p_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Fh]||p_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function p_(t){return jS(t)?()=>{let e=p_(jt(t));return e&&e()}:ta(t)}function _j(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[W]&2048&&!(o[W]&512);){let a=lA(s,o,n,r|ae.Self,or);if(a!==or)return a;let c=s.parent;if(!c){let l=o[mS];if(l){let u=l.get(n,or,r);if(u!==or)return u}c=uA(o),o=o[aa]}s=c}return i}function uA(t){let e=t[ge],n=e.type;return n===2?e.declTNode:n===1?t[Gn]:null}function sv(t){return fj(sn(),t)}function OT(t,e=null,n=null,r){let i=dA(t,e,n,r);return i.resolveInjectorInitializers(),i}function dA(t,e=null,n=null,r,i=new Set){let s=[n||Tn,B2(t)];return r=r||(typeof t=="object"?void 0:Ut(t)),new il(s,e||nv(),r||null,i)}var zn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return OT({name:""},i,r,"");{let s=r.name??"";return OT({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=rl,e.NULL=new qh,e.\u0275prov=F({token:e,providedIn:"any",factory:()=>E(GS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})(),vj="ngOriginalError";function Gy(t){return t[vj]}var ur=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Gy(e);for(;n&&Gy(n);)n=Gy(n);return n||null}},hA=new N("",{providedIn:"root",factory:()=>M(ur).handleError.bind(void 0)});var fA=!1,wj=new N("",{providedIn:"root",factory:()=>fA});var Sh;function Ej(){if(Sh===void 0&&(Sh=null,Bt.trustedTypes))try{Sh=Bt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Sh}function FT(t){return Ej()?.createScriptURL(t)||t}var Wh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${iS})`}};function dl(t){return t instanceof Wh?t.changingThisBreaksApplicationSecurity:t}function ov(t,e){let n=Ij(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${iS})`)}return n===e}function Ij(t){return t instanceof Wh&&t.getTypeName()||null}var Cj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function pA(t){return t=String(t),t.match(Cj)?t:"unsafe:"+t}var _f=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(_f||{});function av(t){let e=mA();return e?e.sanitize(_f.URL,t)||"":ov(t,"URL")?dl(t):pA(pf(t))}function Dj(t){let e=mA();if(e)return FT(e.sanitize(_f.RESOURCE_URL,t)||"");if(ov(t,"ResourceURL"))return FT(dl(t));throw new $(904,!1)}function bj(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?Dj:av}function gA(t,e,n){return bj(e,n)(t)}function mA(){let t=Re();return t&&t[jr].sanitizer}var yA=new Map,Tj=0;function Sj(){return Tj++}function Aj(t){yA.set(t[af],t)}function xj(t){yA.delete(t[af])}var LT="__ngContext__";function Is(t,e){ms(e)?(t[LT]=e[af],Aj(e)):t[LT]=e}function _A(t){return t instanceof Function?t():t}function Mj(t){return(t??M(zn)).get(gt)==="browser"}var Ur=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Ur||{}),Rj;function cv(t,e){return Rj(t,e)}function Ko(t,e,n,r,i){if(r!=null){let s,o=!1;qr(r)?s=r:ms(r)&&(o=!0,r=r[$r]);let a=lr(r);t===0&&n!==null?i==null?CA(e,n,a):Kh(e,n,a,i||null,!0):t===1&&n!==null?Kh(e,n,a,i||null,!0):t===2?Kj(e,a,o):t===3&&e.destroyNode(a),s!=null&&Yj(e,t,s,n,i)}}function Nj(t,e){return t.createText(e)}function Pj(t,e,n){t.setValue(e,n)}function vA(t,e,n){return t.createElement(e,n)}function kj(t,e){wA(t,e),e[$r]=null,e[Gn]=null}function Oj(t,e,n,r,i,s){r[$r]=i,r[Gn]=e,vf(t,r,n,1,i,s)}function wA(t,e){vf(t,e,e[rt],2,null,null)}function Fj(t){let e=t[el];if(!e)return zy(t[ge],t);for(;e;){let n=null;if(ms(e))n=e[el];else{let r=e[Sn];r&&(n=r)}if(!n){for(;e&&!e[qn]&&e!==t;)ms(e)&&zy(e[ge],e),e=e[Mt];e===null&&(e=t),ms(e)&&zy(e[ge],e),n=e&&e[qn]}e=n}}function Lj(t,e,n,r){let i=Sn+r,s=n.length;r>0&&(n[i-1][qn]=e),r<s-Sn?(e[qn]=n[i],PS(n,Sn+r,e)):(n.push(e),e[qn]=null),e[Mt]=n;let o=e[of];o!==null&&n!==o&&Vj(o,e);let a=e[ea];a!==null&&a.insertView(t),n_(e),e[W]|=128}function Vj(t,e){let n=t[jh],i=e[Mt][Mt][cr];e[cr]!==i&&(t[W]|=B_.HasTransplantedViews),n===null?t[jh]=[e]:n.push(e)}function EA(t,e){let n=t[jh],r=n.indexOf(e);n.splice(r,1)}function g_(t,e){if(t.length<=Sn)return;let n=Sn+e,r=t[n];if(r){let i=r[of];i!==null&&i!==t&&EA(i,r),e>0&&(t[n-1][qn]=r[qn]);let s=Bh(t,Sn+e);kj(r[ge],r);let o=s[ea];o!==null&&o.detachView(s[ge]),r[Mt]=null,r[qn]=null,r[W]&=-129}return r}function IA(t,e){if(!(e[W]&256)){let n=e[rt];n.destroyNode&&vf(t,e,n,3,null,null),Fj(e)}}function zy(t,e){if(e[W]&256)return;let n=Ie(null);try{e[W]&=-129,e[W]|=256,e[_s]&&Zb(e[_s]),Uj(t,e),jj(t,e),e[ge].type===1&&e[rt].destroy();let r=e[of];if(r!==null&&qr(e[Mt])){r!==e[Mt]&&EA(r,e);let i=e[ea];i!==null&&i.detachView(t)}xj(e)}finally{Ie(n)}}function jj(t,e){let n=t.cleanup,r=e[Jc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Jc]=null);let i=e[gi];if(i!==null){e[gi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Uj(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Es)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];sr(4,a,c);try{c.call(a)}finally{sr(5,a,c)}}else{sr(4,i,s);try{s.call(i)}finally{sr(5,i,s)}}}}}function Bj(t,e,n){return $j(t,e.parent,n)}function $j(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[$r];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===ar.None||s===ar.Emulated)return null}return An(r,n)}}function Kh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function CA(t,e,n){t.appendChild(e,n)}function VT(t,e,n,r,i){r!==null?Kh(t,e,n,r,i):CA(t,e,n)}function qj(t,e,n,r){t.removeChild(e,n,r)}function lv(t,e){return t.parentNode(e)}function Hj(t,e){return t.nextSibling(e)}function Gj(t,e,n){return Wj(t,e,n)}function zj(t,e,n){return t.type&40?An(t,n):null}var Wj=zj,jT;function uv(t,e,n,r){let i=Bj(t,r,e),s=e[rt],o=r.parent||e[Gn],a=Gj(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)VT(s,i,n[c],a,!1);else VT(s,i,n,a,!1);jT!==void 0&&jT(s,r,e,n,i)}function kh(t,e){if(e!==null){let n=e.type;if(n&3)return An(e,t);if(n&4)return m_(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return kh(t,r);{let i=t[e.index];return qr(i)?m_(-1,i):lr(i)}}else{if(n&32)return cv(e,t)()||lr(t[e.index]);{let r=DA(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=nl(t[cr]);return kh(i,r)}else return kh(t,e.next)}}}return null}function DA(t,e){if(e!==null){let r=t[cr][Gn],i=e.projection;return r.projection[i]}return null}function m_(t,e){let n=Sn+t+1;if(n<e.length){let r=e[n],i=r[ge].firstChild;if(i!==null)return kh(r,i)}return e[vs]}function Kj(t,e,n){let r=lv(t,e);r&&qj(t,r,e,n)}function dv(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Is(lr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)dv(t,e,n.child,r,i,s,!1),Ko(e,t,i,a,s);else if(c&32){let l=cv(n,r),u;for(;u=l();)Ko(e,t,i,u,s);Ko(e,t,i,a,s)}else c&16?Qj(t,e,r,n,i,s):Ko(e,t,i,a,s);n=o?n.projectionNext:n.next}}function vf(t,e,n,r,i,s){dv(n,r,t.firstChild,e,i,s,!1)}function Qj(t,e,n,r,i,s){let o=n[cr],c=o[Gn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Ko(e,t,i,u,s)}else{let l=c,u=o[Mt];kS(r)&&(l.flags|=128),dv(t,e,l,u,i,s,!0)}}function Yj(t,e,n,r,i){let s=n[vs],o=lr(n);s!==o&&Ko(e,t,r,s,i);for(let a=Sn;a<n.length;a++){let c=n[a];vf(c[ge],c,t,e,r,s)}}function Zj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Ur.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Ur.Important),t.setStyle(n,r,i,s))}}function Xj(t,e,n){t.setAttribute(e,"style",n)}function bA(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function TA(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&t_(t,e,r),i!==null&&bA(t,e,i),s!==null&&Xj(t,e,s)}var Ts={};function K(t=1){SA(rn(),Re(),ca()+t,!1)}function SA(t,e,n,r){if(!r)if((e[W]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Nh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Ph(e,s,0,n)}ws(n)}function ie(t,e=ae.Default){let n=Re();if(n===null)return E(t,e);let r=sn();return cA(r,n,jt(t),e)}function AA(){let t="invalid";throw new Error(t)}function xA(t,e,n,r,i,s){let o=Ie(null);try{let a=null;i&$t.SignalBased&&(a=e[r][my]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&$t.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):ZS(e,a,r,s)}finally{Ie(o)}}function Jj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ws(~i);else{let s=i,o=n[++r],a=n[++r];d2(o,s);let c=e[s];a(2,c)}}}finally{ws(-1)}}function wf(t,e,n,r,i,s,o,a,c,l,u){let d=e.blueprint.slice();return d[$r]=i,d[W]=r|4|128|8|64,(l!==null||t&&t[W]&2048)&&(d[W]|=2048),ES(d),d[Mt]=d[aa]=t,d[Hn]=n,d[jr]=o||t&&t[jr],d[rt]=a||t&&t[rt],d[Jo]=c||t&&t[Jo]||null,d[Gn]=s,d[af]=Sj(),d[Lh]=u,d[mS]=l,d[cr]=e.type==2?t[cr]:d,d}function Ef(t,e,n,r,i){let s=t.data[e];if(s===null)s=eU(t,e,n,r,i),u2()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=o2();s.injectorIndex=o===null?-1:o.injectorIndex}return ll(s,!0),s}function eU(t,e,n,r,i){let s=DS(),o=bS(),a=o?s:s&&s.parent,c=t.data[e]=sU(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function MA(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function RA(t,e,n,r,i){let s=ca(),o=r&2;try{ws(-1),o&&e.length>yi&&SA(t,e,yi,!1),sr(o?2:0,i),n(r,i)}finally{ws(s),sr(o?3:1,i)}}function NA(t,e,n){if(_S(e)){let r=Ie(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{Ie(r)}}}function PA(t,e,n){CS()&&(dU(t,e,n,An(n,e)),(n.flags&64)===64&&VA(t,e,n))}function kA(t,e,n=An){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function OA(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=hv(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function hv(t,e,n,r,i,s,o,a,c,l,u){let d=yi+r,h=d+i,f=tU(d,h),p=typeof l=="function"?l():l;return f[ge]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function tU(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ts);return n}function nU(t,e,n,r){let s=r.get(wj,fA)||n===ar.ShadowDom,o=t.selectRootElement(e,s);return rU(o),o}function rU(t){iU(t)}var iU=()=>null;function sU(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return r2()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function UT(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=$t.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}t===0?BT(r,n,l,a,c):BT(r,n,l,a)}return r}function BT(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function oU(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,l=null;for(let u=r;u<i;u++){let d=s[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=UT(0,d.inputs,u,c,f),l=UT(1,d.outputs,u,l,p);let g=c!==null&&o!==null&&!lS(e)?IU(c,u,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function aU(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function fv(t,e,n,r,i,s,o,a){let c=An(e,n),l=e.inputs,u;!a&&l!=null&&(u=l[r])?(pv(t,n,u,r,i),cf(e)&&cU(n,e.index)):e.type&3?(r=aU(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function cU(t,e){let n=wi(e,t);n[W]&16||(n[W]|=64)}function FA(t,e,n,r){if(CS()){let i=r===null?null:{"":-1},s=fU(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&LA(t,e,n,o,i,a),i&&pU(n,r,i)}n.mergedAttrs=Xc(n.mergedAttrs,n.attrs)}function LA(t,e,n,r,i,s){for(let l=0;l<r.length;l++)f_(zh(n,e),t,r[l].type);mU(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let u=r[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=MA(t,e,r.length,null);for(let l=0;l<r.length;l++){let u=r[l];n.mergedAttrs=Xc(n.mergedAttrs,u.hostAttrs),yU(t,n,e,c,u),gU(c,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}oU(t,n,s)}function lU(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;uU(o)!=a&&o.push(a),o.push(n,r,s)}}function uU(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function dU(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;cf(n)&&_U(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||zh(n,e),Is(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],l=ia(e,t,a,n);if(Is(l,e),o!==null&&EU(e,a-i,l,c,n,o),_i(c)){let u=wi(n.index,e);u[Hn]=ia(e,t,a,n)}}}function VA(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=h2();try{ws(s);for(let a=r;a<i;a++){let c=t.data[a],l=e[a];r_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&hU(c,l)}}finally{ws(-1),r_(o)}}function hU(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function fU(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(FV(e,o.selectors,!1))if(r||(r=[]),_i(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;y_(t,e,c)}else r.unshift(o),y_(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function y_(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function pU(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function gU(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;_i(e)&&(n[""]=t)}}function mU(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function yU(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=ta(i.type,!0)),o=new Es(s,_i(i),ie);t.blueprint[r]=o,n[r]=o,lU(t,e,r,MA(t,n,i.hostVars,Ts),i)}function _U(t,e,n){let r=An(e,t),i=OA(n),s=t[jr].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=If(t,wf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function vU(t,e,n,r,i,s){let o=An(t,e);wU(e[rt],o,s,t.value,n,r,i)}function wU(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?pf(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function EU(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],d=o[a++];xA(r,n,c,l,u,d)}}function IU(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function jA(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function UA(t,e){let n=t.contentQueries;if(n!==null){let r=Ie(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];TS(s),a.contentQueries(2,e[o],o)}}}finally{Ie(r)}}}function If(t,e){return t[el]?t[bT][qn]=e:t[el]=e,t[bT]=e,e}function __(t,e,n){TS(0);let r=Ie(null);try{e(t,n)}finally{Ie(r)}}function CU(t){return t[Jc]||(t[Jc]=[])}function DU(t){return t.cleanup||(t.cleanup=[])}function BA(t,e){let n=t[Jo],r=n?n.get(ur,null):null;r&&r.handleError(e)}function pv(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],l=e[o],u=t.data[o];xA(u,l,r,a,c,i)}}function bU(t,e,n){let r=vS(e,t);Pj(t[rt],r,n)}function TU(t,e){let n=wi(e,t),r=n[ge];SU(r,n);let i=n[$r];i!==null&&n[Lh]===null&&(n[Lh]=J_(i,n[Jo])),gv(r,n,n[Hn])}function SU(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function gv(t,e,n){G_(e);try{let r=t.viewQuery;r!==null&&__(1,r,n);let i=t.template;i!==null&&RA(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[ea]?.finishViewCreation(t),t.staticContentQueries&&UA(t,e),t.staticViewQueries&&__(2,t.viewQuery,n);let s=t.components;s!==null&&AU(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[W]&=-5,z_()}}function AU(t,e){for(let n=0;n<e.length;n++)TU(t,e[n])}function xU(t,e,n,r){let i=Ie(null);try{let s=e.tView,a=t[W]&4096?4096:16,c=wf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),l=t[e.index];c[of]=l;let u=t[ea];return u!==null&&(c[ea]=u.createEmbeddedView(s)),gv(s,c,n),c}finally{Ie(i)}}function $T(t,e){return!e||e.firstChild===null||kS(t)}function MU(t,e,n,r=!0){let i=e[ge];if(Lj(i,e,t,n),r){let o=m_(n,t),a=e[rt],c=lv(a,t[vs]);c!==null&&Oj(i,t[Gn],a,e,c,o)}let s=e[Lh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Qh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(lr(s)),qr(s)&&RU(s,r);let o=n.type;if(o&8)Qh(t,e,n.child,r);else if(o&32){let a=cv(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=DA(e,n);if(Array.isArray(a))r.push(...a);else{let c=nl(e[cr]);Qh(c[ge],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function RU(t,e){for(let n=Sn;n<t.length;n++){let r=t[n],i=r[ge].firstChild;i!==null&&Qh(r[ge],r,i,e)}t[vs]!==t[$r]&&e.push(t[vs])}var $A=[];function NU(t){return t[_s]??PU(t)}function PU(t){let e=$A.pop()??Object.create(OU);return e.lView=t,e}function kU(t){t.lView[_s]!==t&&(t.lView=null,$A.push(t))}var OU=le(A({},Kb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{tl(t.lView)},consumerOnSignalRead(){this.lView[_s]=this}});function qA(t){return GA(t[el])}function HA(t){return GA(t[qn])}function GA(t){for(;t!==null&&!qr(t);)t=t[qn];return t}var zA=100;function WA(t,e=!0,n=0){let r=t[jr],i=r.rendererFactory,s=!1;s||i.begin?.();try{FU(t,n)}catch(o){throw e&&BA(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function FU(t,e){v_(t,e);let n=0;for(;H_(t);){if(n===zA)throw new $(103,!1);n++,v_(t,1)}}function LU(t,e,n,r){let i=e[W];if((i&256)===256)return;let s=!1;!s&&e[jr].inlineEffectRunner?.flush(),G_(e);let o=null,a=null;!s&&VU(t)&&(a=NU(e),o=Qb(a));try{ES(e),c2(t.bindingStartIndex),n!==null&&RA(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Nh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Ph(e,d,0,null),qy(e,0)}if(jU(e),KA(e,0),t.contentQueries!==null&&UA(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Nh(e,d)}else{let d=t.contentHooks;d!==null&&Ph(e,d,1),qy(e,1)}Jj(t,e);let l=t.components;l!==null&&YA(e,l,0);let u=t.viewQuery;if(u!==null&&__(2,u,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Nh(e,d)}else{let d=t.viewHooks;d!==null&&Ph(e,d,2),qy(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Uy]){for(let d of e[Uy])d();e[Uy]=null}s||(e[W]&=-73)}catch(c){throw tl(e),c}finally{a!==null&&(Yb(a,o),kU(a)),z_()}}function VU(t){return t.type!==2}function KA(t,e){for(let n=qA(t);n!==null;n=HA(n))for(let r=Sn;r<n.length;r++){let i=n[r];QA(i,e)}}function jU(t){for(let e=qA(t);e!==null;e=HA(e)){if(!(e[W]&B_.HasTransplantedViews))continue;let n=e[jh];for(let r=0;r<n.length;r++){let i=n[r],s=i[Mt];ZV(i)}}}function UU(t,e,n){let r=wi(e,t);QA(r,n)}function QA(t,e){q_(t)&&v_(t,e)}function v_(t,e){let r=t[ge],i=t[W],s=t[_s],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&yy(s)),s&&(s.dirty=!1),t[W]&=-9217,o)LU(r,t,r.template,t[Hn]);else if(i&8192){KA(t,1);let a=r.components;a!==null&&YA(t,a,1)}}function YA(t,e,n){for(let r=0;r<e.length;r++)UU(t,e[r],n)}function mv(t){for(t[jr].changeDetectionScheduler?.notify();t;){t[W]|=64;let e=nl(t);if(GV(t)&&!e)return t;t=e}return null}var Cs=class{get rootNodes(){let e=this._lView,n=e[ge];return Qh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hn]}set context(e){this._lView[Hn]=e}get destroyed(){return(this._lView[W]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mt];if(qr(e)){let n=e[Vh],r=n?n.indexOf(this):-1;r>-1&&(g_(e,r),Bh(n,r))}this._attachedToViewContainer=!1}IA(this._lView[ge],this._lView)}onDestroy(e){IS(this._lView,e)}markForCheck(){mv(this._cdRefInjectingView||this._lView)}detach(){this._lView[W]&=-129}reattach(){n_(this._lView),this._lView[W]|=128}detectChanges(){this._lView[W]|=1024,WA(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,wA(this._lView[ge],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,n_(this._lView)}},Cf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=qU;let t=e;return t})(),BU=Cf,$U=class extends BU{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=xU(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Cs(i)}};function qU(){return HU(sn(),Re())}function HU(t,e){return t.type&4?new $U(e,t,df(t,e)):null}var LJ=new RegExp(`^(\\d+)*(${V2}|${L2})*(.*)`);var GU=()=>null;function qT(t,e){return GU(t,e)}var w_=class{},E_=class{},Yh=class{};function zU(t){let e=Error(`No component factory found for ${Ut(t)}.`);return e[WU]=t,e}var WU="ngComponent";var I_=class{resolveComponentFactory(e){throw zU(e)}},Df=(()=>{let e=class e{};e.NULL=new I_;let t=e;return t})(),sl=class{},Hr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>KU();let t=e;return t})();function KU(){let t=Re(),e=sn(),n=wi(e.index,t);return(ms(n)?n:t)[rt]}var QU=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Wy={},ZA=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=YU,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),C_=class extends ZA{constructor(e){super(),this._lView=e}onDestroy(e){return IS(this._lView,e),()=>JV(this._lView,e)}};function YU(){return new C_(Re())}var HT=new Set;function bf(t){HT.has(t)||(HT.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function GT(...t){}function ZU(){let t=typeof Bt.requestAnimationFrame=="function",e=Bt[t?"requestAnimationFrame":"setTimeout"],n=Bt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var de=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ht(!1),this.onMicrotaskEmpty=new ht(!1),this.onStable=new ht(!1),this.onError=new ht(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=ZU().nativeRequestAnimationFrame,eB(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,XU,GT,GT);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},XU={};function yv(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function JU(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Bt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,D_(t),t.isCheckStableRunning=!0,yv(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),D_(t))}function eB(t){let e=()=>{JU(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(tB(a))return n.invokeTask(i,s,o,a);try{return zT(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),WT(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return zT(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),WT(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,D_(t),yv(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function D_(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function zT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function WT(t){t._nesting--,yv(t)}var b_=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ht,this.onMicrotaskEmpty=new ht,this.onStable=new ht,this.onError=new ht}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function tB(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function nB(t="zone.js",e){return t==="noop"?new b_:t==="zone.js"?new de(e):t}var Qo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Qo||{}),rB={destroy(){}};function _v(t,e){!e&&X2(_v);let n=e?.injector??M(zn);if(!Mj(n))return rB;bf("NgAfterNextRender");let r=n.get(vv),i=r.handler??=new S_,s=e?.phase??Qo.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(ZA).onDestroy(o),c=new T_(n,s,()=>{o(),t()});return i.register(c),{destroy:o}}var T_=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(de),this.errorHandler=e.get(ur,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},S_=class{constructor(){this.executingCallbacks=!1,this.buckets={[Qo.EarlyRead]:new Set,[Qo.Write]:new Set,[Qo.MixedReadWrite]:new Set,[Qo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},vv=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function A_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=vT(i,a);else if(s==2){let c=a,l=e[++o];r=vT(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Zh=class extends Df{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=mi(e);return new sa(n,this.ngModule)}};function KT(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function iB(t){let e=t.toLowerCase();return e==="svg"?zV:e==="math"?WV:null}var x_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=gf(r);let i=this.injector.get(e,Wy,r);return i!==Wy||n===Wy?i:this.parentInjector.get(e,n,r)}},sa=class extends Yh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=KT(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return KT(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=UV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=Ie(null);try{i=i||this.ngModule;let o=i instanceof qt?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new x_(e,o):e,c=a.get(sl,null);if(c===null)throw new $(407,!1);let l=a.get(QU,null),u=a.get(vv,null),d=a.get(w_,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?nU(f,r,this.componentDef.encapsulation,a):vA(f,p,iB(p)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let w=null;g!==null&&(w=J_(g,a,!0));let O=hv(0,null,null,1,0,null,null,null,null,null,null),S=wf(null,O,null,m,null,null,h,f,a,null,w);G_(S);let V,H;try{let z=this.componentDef,Ee,Jt=null;z.findHostDirectiveDefs?(Ee=[],Jt=new Map,z.findHostDirectiveDefs(z,Ee,Jt),Ee.push(z)):Ee=[z];let cy=sB(S,g),Hd=oB(cy,g,z,Ee,S,h,f);H=wS(O,yi),g&&lB(f,z,g,r),n!==void 0&&uB(H,this.ngContentSelectors,n),V=cB(Hd,z,Ee,Jt,S,[dB]),gv(O,S,null)}finally{z_()}return new M_(this.componentType,V,df(H,S),S,H)}finally{Ie(s)}}},M_=class extends E_{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Cs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;pv(s[ge],s,i,e,n),this.previousInputValues.set(e,n);let o=wi(this._tNode.index,s);mv(o)}}get injector(){return new ys(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function sB(t,e){let n=t[ge],r=yi;return t[r]=e,Ef(n,r,2,"#host",null)}function oB(t,e,n,r,i,s,o){let a=i[ge];aB(r,t,e,o);let c=null;e!==null&&(c=J_(e,i[Jo]));let l=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=wf(i,OA(n),null,u,i[t.index],t,s,l,null,null,c);return a.firstCreatePass&&y_(a,t,r.length-1),If(i,d),i[t.index]=d}function aB(t,e,n,r){for(let i of t)e.mergedAttrs=Xc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(A_(e,e.mergedAttrs,!0),n!==null&&TA(r,n,e))}function cB(t,e,n,r,i,s){let o=sn(),a=i[ge],c=An(o,i);LA(a,i,o,n,null,r);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=ia(i,a,d,o);Is(h,i)}VA(a,i,o),c&&Is(c,i);let l=ia(i,a,o.directiveStart+o.componentOffset,o);if(t[Hn]=i[Hn]=l,s!==null)for(let u of s)u(l,e);return NA(a,o,i),l}function lB(t,e,n,r){if(r)t_(t,n,["ng-version","17.2.4"]);else{let{attrs:i,classes:s}=BV(e.selectors[0]);i&&t_(t,n,i),s&&s.length>0&&bA(t,n,s.join(" "))}}function uB(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function dB(){let t=sn();rv(Re()[ge],t)}var ua=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=hB;let t=e;return t})();function hB(){let t=sn();return pB(t,Re())}var fB=ua,XA=class extends fB{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return df(this._hostTNode,this._hostLView)}get injector(){return new ys(this._hostTNode,this._hostLView)}get parentInjector(){let e=iv(this._hostTNode,this._hostLView);if(nA(e)){let n=Gh(e,this._hostLView),r=Hh(e),i=n[ge].data[r+8];return new ys(i,n)}else return new ys(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=QT(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Sn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=qT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,$T(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!ej(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new sa(mi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?l:this.parentInjector).get(qt,null);g&&(s=g)}let u=mi(c.componentType??{}),d=qT(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(l,i,h,s);return this.insertImpl(f.hostView,a,$T(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(YV(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Mt],l=new XA(c,c[Gn],c[Mt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return MU(o,i,s,r),e.attachToViewContainerRef(),PS(Ky(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=QT(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=g_(this._lContainer,n);r&&(Bh(Ky(this._lContainer),n),IA(r[ge],r))}detach(e){let n=this._adjustIndex(e,-1),r=g_(this._lContainer,n);return r&&Bh(Ky(this._lContainer),n)!=null?new Cs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function QT(t){return t[Vh]}function Ky(t){return t[Vh]||(t[Vh]=[])}function pB(t,e){let n,r=e[t.index];return qr(r)?n=r:(n=jA(r,e,null,t),e[t.index]=n,If(e,n)),mB(n,e,t,r),new XA(n,t,e)}function gB(t,e){let n=t[rt],r=n.createComment(""),i=An(e,t),s=lv(n,i);return Kh(n,s,r,Hj(n,i),!1),r}var mB=vB,yB=()=>!1;function _B(t,e,n){return yB(t,e,n)}function vB(t,e,n,r){if(t[vs])return;let i;n.type&8?i=lr(r):i=gB(e,n),t[vs]=i}function wB(t){return typeof t=="function"&&t[my]!==void 0}function JA(t){return wB(t)&&typeof t.set=="function"}function EB(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(bB))}return s}return Xh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[l+h]=f,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>TB(s));e.push(c)}),CB(),Promise.all(e).then(()=>{})}var Xh=new Map,IB=new Set;function CB(){let t=Xh;return Xh=new Map,t}function DB(){return Xh.size===0}function bB(t){return typeof t=="string"?t:t.text()}function TB(t){IB.delete(t)}function SB(t){return Object.getPrototypeOf(t.prototype).constructor}function Gr(t){let e=SB(t.type),n=!0,r=[t];for(;e;){let i;if(_i(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Ah(t.inputs),o.inputTransforms=Ah(t.inputTransforms),o.declaredInputs=Ah(t.declaredInputs),o.outputs=Ah(t.outputs);let a=i.hostBindings;a&&NB(t,a);let c=i.viewQuery,l=i.contentQueries;if(c&&MB(t,c),l&&RB(t,l),AB(t,i),TV(t.outputs,i.outputs),_i(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Gr&&(n=!1)}}e=Object.getPrototypeOf(e)}xB(r)}function AB(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function xB(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Xc(i.hostAttrs,n=Xc(n,i.hostAttrs))}}function Ah(t){return t===Xo?{}:t===Tn?[]:t}function MB(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function RB(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function NB(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function wv(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var vi=class{},ol=class{};var Jh=class extends vi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Zh(this);let i=fS(e);this._bootstrapComponents=_A(i.bootstrap),this._r3Injector=dA(e,n,[{provide:vi,useValue:this},{provide:Df,useValue:this.componentFactoryResolver},...r],Ut(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ef=class extends ol{constructor(e){super(),this.moduleType=e}create(e){return new Jh(this.moduleType,e,[])}};function PB(t,e,n){return new Jh(t,e,n)}var R_=class extends vi{constructor(e){super(),this.componentFactoryResolver=new Zh(this),this.instance=null;let n=new il([...e.providers,{provide:vi,useValue:this},{provide:Df,useValue:this.componentFactoryResolver}],e.parent||nv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Tf(t,e,n=null){return new R_({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Ss=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new bt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ex(t){return OB(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function kB(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function OB(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function hl(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function FB(t,e,n,r,i,s,o,a,c){let l=e.consts,u=Ef(e,t,4,o||null,Uh(l,a));FA(e,n,u,Uh(l,c)),rv(e,u);let d=u.tView=hv(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function on(t,e,n,r,i,s,o,a){let c=Re(),l=rn(),u=t+yi,d=l.firstCreatePass?FB(u,l,c,e,n,r,i,s,o):l.data[u];ll(d,!1);let h=LB(l,c,d,t);W_()&&uv(l,c,h,d),Is(h,c);let f=jA(h,c,h,d);return c[u]=f,If(c,f),_B(f,d,c),$_(d)&&PA(l,c,d),o!=null&&kA(c,d,a),on}var LB=VB;function VB(t,e,n,r){return K_(!0),e[rt].createComment("")}function Sf(t,e,n,r){let i=Re(),s=lf();if(hl(i,s,e)){let o=rn(),a=uf();vU(a,i,t,e,n,r)}return Sf}function tx(t,e,n,r){return hl(t,lf(),n)?e+pf(n)+r:Ts}function xh(t,e){return t<<17|e<<2}function Ds(t){return t>>17&32767}function jB(t){return(t&2)==2}function UB(t,e){return t&131071|e<<17}function N_(t){return t|2}function oa(t){return(t&131068)>>2}function Qy(t,e){return t&-131069|e<<2}function BB(t){return(t&1)===1}function P_(t){return t|1}function $B(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ds(o),c=oa(o);t[r]=n;let l=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||ul(d,u)>0)&&(l=!0)}else u=n;if(i)if(c!==0){let h=Ds(t[a+1]);t[r+1]=xh(h,a),h!==0&&(t[h+1]=Qy(t[h+1],r)),t[a+1]=UB(t[a+1],r)}else t[r+1]=xh(a,0),a!==0&&(t[a+1]=Qy(t[a+1],r)),a=r;else t[r+1]=xh(c,0),a===0?a=r:t[c+1]=Qy(t[c+1],r),c=r;l&&(t[r+1]=N_(t[r+1])),YT(t,u,r,!0),YT(t,u,r,!1),qB(e,u,t,r,s),o=xh(a,c),s?e.classBindings=o:e.styleBindings=o}function qB(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&ul(s,e)>=0&&(n[r+1]=P_(n[r+1]))}function YT(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ds(i):oa(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],l=t[o+1];HB(c,e)&&(a=!0,t[o+1]=r?P_(l):N_(l)),o=r?Ds(l):oa(l)}a&&(t[n+1]=r?N_(i):P_(i))}function HB(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?ul(t,e)>=0:!1}function Fe(t,e,n){let r=Re(),i=lf();if(hl(r,i,e)){let s=rn(),o=uf();fv(s,o,r,t,e,r[rt],n,!1)}return Fe}function ZT(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";pv(t,n,s[o],o,r)}function Ev(t,e){return GB(t,e,null,!0),Ev}function GB(t,e,n,r){let i=Re(),s=rn(),o=l2(2);if(s.firstUpdatePass&&WB(s,t,o,r),e!==Ts&&hl(i,o,e)){let a=s.data[ca()];XB(s,a,i,i[rt],t,i[o+1]=JB(e,n),r,o)}}function zB(t,e){return e>=t.expandoStartIndex}function WB(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ca()],o=zB(t,n);e$(s,r)&&e===null&&!o&&(e=!1),e=KB(i,s,e,r),$B(i,s,e,n,o,r)}}function KB(t,e,n,r){let i=f2(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Yy(null,t,e,n,r),n=al(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Yy(i,t,e,n,r),s===null){let c=QB(t,e,r);c!==void 0&&Array.isArray(c)&&(c=Yy(null,t,e,c[1],r),c=al(c,e.attrs,r),YB(t,e,r,c))}else s=ZB(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function QB(t,e,n){let r=n?e.classBindings:e.styleBindings;if(oa(r)!==0)return t[Ds(r)]}function YB(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ds(i)]=r}function ZB(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=al(r,o,n)}return al(r,e.attrs,n)}function Yy(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=al(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function al(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),v2(t,o,n?!0:e[++s]))}return t===void 0?null:t}function XB(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,l=c[a+1],u=BB(l)?XT(c,e,n,i,oa(l),o):void 0;if(!tf(u)){tf(s)||jB(l)&&(s=XT(c,null,n,i,a,o));let d=vS(ca(),n);Zj(r,o,d,i,s)}}function XT(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=n[i+1];h===Ts&&(h=d?Tn:void 0);let f=d?By(h,r):u===r?h:void 0;if(l&&!tf(f)&&(f=By(c,r)),tf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Ds(p):oa(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=By(c,r))}return a}function tf(t){return t!==void 0}function JB(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Ut(dl(t)))),t}function e$(t,e){return(t.flags&(e?8:16))!==0}function t$(t,e,n,r,i,s){let o=e.consts,a=Uh(o,i),c=Ef(e,t,2,r,a);return FA(e,n,c,Uh(o,s)),c.attrs!==null&&A_(c,c.attrs,!1),c.mergedAttrs!==null&&A_(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function D(t,e,n,r){let i=Re(),s=rn(),o=yi+t,a=i[rt],c=s.firstCreatePass?t$(o,s,i,e,n,r):s.data[o],l=n$(s,i,c,a,e,t);i[o]=l;let u=$_(c);return ll(c,!0),TA(a,l,c),(c.flags&32)!==32&&W_()&&uv(s,i,l,c),e2()===0&&Is(l,i),t2(),u&&(PA(s,i,c),NA(s,c,i)),r!==null&&kA(i,c),D}function b(){let t=sn();bS()?a2():(t=t.parent,ll(t,!1));let e=t;i2(e)&&s2(),n2();let n=rn();return n.firstCreatePass&&(rv(n,t),_S(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&aj(e)&&ZT(n,e,Re(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&cj(e)&&ZT(n,e,Re(),e.stylesWithoutHost,!1),b}function it(t,e,n,r){return D(t,e,n,r),b(),it}var n$=(t,e,n,r,i,s)=>(K_(!0),vA(r,i,m2()));function As(){return Re()}var nf="en-US";var r$=nf;function i$(t){typeof t=="string"&&(r$=t.toLowerCase().replace(/_/g,"-"))}function je(t,e,n,r){let i=Re(),s=rn(),o=sn();return nx(s,i,i[rt],o,t,e,r),je}function s$(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Jc],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function nx(t,e,n,r,i,s,o){let a=$_(r),l=t.firstCreatePass&&DU(t),u=e[Hn],d=CU(e),h=!0;if(r.type&3||o){let g=An(r,e),m=o?o(g):g,w=d.length,O=o?V=>o(lr(V[r.index])):r.index,S=null;if(!o&&a&&(S=s$(t,e,i,r.index)),S!==null){let V=S.__ngLastListenerFn__||S;V.__ngNextListenerFn__=s,S.__ngLastListenerFn__=s,h=!1}else{s=eS(r,e,u,s,!1);let V=n.listen(m,i,s);d.push(s,V),l&&l.push(i,O,w,w+1)}}else s=eS(r,e,u,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let w=p[m],O=p[m+1],H=e[w][O].subscribe(s),z=d.length;if(d.push(s,H),l){let Ee=typeof H=="function"?z+1:-(z+1);l.push(i,r.index,z,Ee)}}}}function JT(t,e,n,r){let i=Ie(null);try{return sr(6,e,n),n(r)!==!1}catch(s){return BA(t,s),!1}finally{sr(7,e,n),Ie(i)}}function eS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?wi(t.index,e):e;mv(a);let c=JT(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)c=JT(e,n,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function Nt(t=1){return g2(t)}function da(t,e,n){return rx(t,"",e,"",n),da}function rx(t,e,n,r,i){let s=Re(),o=tx(s,e,n,r);if(o!==Ts){let a=rn(),c=uf();fv(a,c,s,t,o,s[rt],i,!1)}return rx}function x(t,e=""){let n=Re(),r=rn(),i=t+yi,s=r.firstCreatePass?Ef(r,i,1,e,null):r.data[i],o=o$(r,n,s,e,t);n[i]=o,W_()&&uv(r,n,o,s),ll(s,!1)}var o$=(t,e,n,r,i)=>(K_(!0),Nj(e[rt],r));function hn(t){return ha("",t,""),hn}function ha(t,e,n){let r=Re(),i=tx(r,t,e,n);return i!==Ts&&bU(r,ca(),i),ha}function Ht(t,e,n){JA(e)&&(e=e());let r=Re(),i=lf();if(hl(r,i,e)){let s=rn(),o=uf();fv(s,o,r,t,e,r[rt],n,!1)}return Ht}function an(t,e){let n=JA(t);return n&&t.set(e),n}function Gt(t,e){let n=Re(),r=rn(),i=sn();return nx(r,n,n[rt],i,t,e),Gt}function a$(t,e,n){let r=rn();if(r.firstCreatePass){let i=_i(t);k_(n,r.data,r.blueprint,i,!0),k_(e,r.data,r.blueprint,i,!1)}}function k_(t,e,n,r,i){if(t=jt(t),Array.isArray(t))for(let s=0;s<t.length;s++)k_(t[s],e,n,r,i);else{let s=rn(),o=Re(),a=sn(),c=ra(t)?t:jt(t.provide),l=YS(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(ra(t)||!t.multi){let f=new Es(l,i,ie),p=Xy(c,e,i?u:u+h,d);p===-1?(f_(zh(a,o),s,c),Zy(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=Xy(c,e,u+h,d),p=Xy(c,e,u,u+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){f_(zh(a,o),s,c);let w=u$(i?l$:c$,n.length,i,r,l);!i&&m&&(n[p].providerFactory=w),Zy(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(w),o.push(w)}else{let w=ix(n[i?p:f],l,!i&&r);Zy(s,t,f>-1?f:p,w)}!i&&r&&m&&n[p].componentProviders++}}}function Zy(t,e,n,r){let i=ra(e),s=G2(e);if(i||s){let c=(s?jt(e.useClass):e).prototype.ngOnDestroy;if(c){let l=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=l.indexOf(n);u===-1?l.push(n,[r,c]):l[u+1].push(r,c)}else l.push(n,c)}}}function ix(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Xy(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function c$(t,e,n,r){return O_(this.multi,[])}function l$(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ia(n,n[ge],this.providerFactory.index,r);s=a.slice(0,o),O_(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],O_(i,s);return s}function O_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function u$(t,e,n,r,i){let s=new Es(t,n,ie);return s.multi=[],s.index=e,s.componentProviders=0,ix(s,i,r&&!n),s}function fa(t,e=[]){return n=>{n.providersResolver=(r,i)=>a$(r,i?i(t):t,e)}}var d$=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=WS(!1,r.type),s=i.length>0?Tf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=F({token:e,providedIn:"environment",factory:()=>new e(E(qt))});let t=e;return t})();function sx(t){bf("NgStandalone"),t.getStandaloneInjector=e=>e.get(d$).getOrCreateStandaloneInjector(t)}var Mh=null;function h$(t){Mh!==null&&(t.defaultEncapsulation!==Mh.defaultEncapsulation||t.preserveWhitespaces!==Mh.preserveWhitespaces)||(Mh=t)}var Br=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},ox=new Br("17.2.4"),Af=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var Iv=new N(""),fl=new N(""),xf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Cv||(f$(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(de),E(Mf),E(fl))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Mf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Cv?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function f$(t){Cv=t}var Cv;function xs(t){return!!t&&typeof t.then=="function"}function ax(t){return!!t&&typeof t.subscribe=="function"}var Rf=new N(""),cx=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=M(Rf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(xs(o))r.push(o);else if(ax(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Nf=new N("");function p$(){Xb(()=>{throw new $(600,!1)})}function g$(t){return t.isBoundToModule}function m$(t,e,n){try{let r=n();return xs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function lx(t,e){return Array.isArray(e)?e.reduce(lx,t):A(A({},t),e)}var Ms=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=M(hA),this.afterRenderEffectManager=M(vv),this.componentTypes=[],this.components=[],this.isStable=M(Ss).hasPendingTasks.pipe(j(r=>!r)),this._injector=M(qt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Yh;if(!this._injector.get(cx).done){let f=!s&&hS(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(Df).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=g$(a)?void 0:this._injector.get(vi),l=i||a.selector,u=a.create(zn.NULL,[],l,c),d=u.location.nativeElement,h=u.injector.get(Iv,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),Oh(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new $(101,!1);let r=Ie(null);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,Ie(r)}}detectChangesInAttachedViews(){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===zA)throw new $(103,!1);let s=r===0;for(let{_lView:o,notifyErrorHandler:a}of this._views)!s&&!Jy(o)||this.detectChangesInView(o,a,s);if(r++,i.executeInternalCallbacks(),!this._views.some(({_lView:o})=>Jy(o))&&(i.execute(),!this._views.some(({_lView:o})=>Jy(o))))break}}detectChangesInView(r,i,s){let o;s?(o=0,r[W]|=1024):r[W]&64?o=0:o=1,WA(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Oh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Nf,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Oh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Oh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Jy(t){return H_(t)}var F_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Pf=(()=>{let e=class e{compileModuleSync(r){return new ef(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=fS(r),o=_A(s.declarations).reduce((a,c)=>{let l=mi(c);return l&&a.push(new sa(l)),a},[]);return new F_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),y$=new N("");function _$(t,e,n){let r=new ef(n);return Promise.resolve(r)}function tS(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var v$=(()=>{let e=class e{constructor(){this.zone=M(de),this.applicationRef=M(Ms)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function w$(t){return[{provide:de,useFactory:t},{provide:na,multi:!0,useFactory:()=>{let e=M(v$,{optional:!0});return()=>e.initialize()}},{provide:na,multi:!0,useFactory:()=>{let e=M(C$);return()=>{e.initialize()}}},{provide:hA,useFactory:E$}]}function E$(){let t=M(de),e=M(ur);return n=>t.runOutsideAngular(()=>e.handleError(n))}function I$(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var C$=(()=>{let e=class e{constructor(){this.subscription=new Ke,this.initialized=!1,this.zone=M(de),this.pendingTasks=M(Ss)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{de.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function D$(){return typeof $localize<"u"&&$localize.locale||nf}var Dv=new N("",{providedIn:"root",factory:()=>M(Dv,ae.Optional|ae.SkipSelf)||D$()});var ux=new N(""),dx=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=nB(i?.ngZone,I$({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=PB(r.moduleType,this.injector,w$(()=>s)),a=o.injector.get(ur,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Oh(this._modules,o),c.unsubscribe()})}),m$(a,s,()=>{let c=o.injector.get(cx);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(Dv,nf);return i$(l||nf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=lx({},i);return _$(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Ms);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(ux,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(zn))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Zc=null,hx=new N("");function b$(t){if(Zc&&!Zc.get(hx,!1))throw new $(400,!1);p$(),Zc=t;let e=t.get(dx);return A$(t),e}function bv(t,e,n=[]){let r=`Platform: ${e}`,i=new N(r);return(s=[])=>{let o=fx();if(!o||o.injector.get(hx,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):b$(T$(a,r))}return S$(i)}}function T$(t=[],e){return zn.create({name:e,providers:[{provide:yf,useValue:"platform"},{provide:ux,useValue:new Set([()=>Zc=null])},...t]})}function S$(t){let e=fx();if(!e)throw new $(401,!1);return e}function fx(){return Zc?.get(dx)??null}function A$(t){t.get(Y_,null)?.forEach(n=>n())}function Tv(){return!1}var Rs=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=x$;let t=e;return t})();function x$(t){return M$(sn(),Re(),(t&16)===16)}function M$(t,e,n){if(cf(t)&&!n){let r=wi(t.index,e);return new Cs(r,r)}else if(t.type&47){let r=e[cr];return new Cs(r,e)}return null}var L_=class{constructor(){}supports(e){return ex(e)}create(e){return new V_(e)}},R$=(t,e)=>e,V_=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||R$}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<nS(r,i,s)?n:r,a=nS(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let h=0;h<l;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!ex(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,kB(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new j_(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new rf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new rf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},j_=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},U_=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},rf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new U_,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function nS(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function rS(){return new Sv([new L_])}var Sv=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||rS()),deps:[[e,new ev,new la]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=F({token:e,providedIn:"root",factory:rS});let t=e;return t})();var px=bv(null,"core",[]),gx=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(Ms))},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({});let t=e;return t})();function Ns(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function mx(t){let e=mi(t);if(!e)return null;let n=new sa(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var Ex=null;function fr(){return Ex}function Ix(t){Ex??=t}var kf=class{};var Pt=new N(""),Nv=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(N$),providedIn:"platform"});let t=e;return t})(),Cx=new N(""),N$=(()=>{let e=class e extends Nv{constructor(){super(),this._doc=M(Pt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fr().getBaseHref(this._doc)}onPopState(r){let i=fr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=fr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Pv(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function yx(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function zr(t){return t&&t[0]!=="?"?"?"+t:t}var Wr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(kv),providedIn:"root"});let t=e;return t})(),Dx=new N(""),kv=(()=>{let e=class e extends Wr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??M(Pt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Pv(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+zr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Nv),E(Dx,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bx=(()=>{let e=class e extends Wr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Pv(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Nv),E(Dx,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),ga=(()=>{let e=class e{constructor(r){this._subject=new ht,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=O$(yx(_x(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+zr(i))}normalize(r){return e.stripTrailingSlash(k$(this._basePath,_x(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=zr,e.joinWithSlash=Pv,e.stripTrailingSlash=yx,e.\u0275fac=function(i){return new(i||e)(E(Wr))},e.\u0275prov=F({token:e,factory:()=>P$(),providedIn:"root"});let t=e;return t})();function P$(){return new ga(E(Wr))}function k$(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function _x(t){return t.replace(/\/index.html$/,"")}function O$(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function Of(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Av=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ma=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new Av(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),vx(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);vx(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ie(ua),ie(Cf),ie(Sv))},e.\u0275dir=Tt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function vx(t,e){t.context.$implicit=e.item}var Ff=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new xv,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){wx("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){wx("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ie(ua),ie(Cf))},e.\u0275dir=Tt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),xv=class{constructor(){this.$implicit=null,this.ngIf=null}};function wx(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Ut(e)}'.`)}var Tx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({});let t=e;return t})(),Ov="browser",F$="server";function L$(t){return t===Ov}function Ps(t){return t===F$}var Sx=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>L$(M(gt))?new Mv(M(Pt),window):new Rv});let t=e;return t})(),Mv=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=V$(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function V$(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Rv=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},pa=class{};var ml=class{},Vf=class{},ks=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var Lv=class{encodeKey(e){return Ax(e)}encodeValue(e){return Ax(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function B$(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=n.get(o)||[];c.push(a),n.set(o,c)}),n}var $$=/%(\d[a-f0-9])/gi,q$={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ax(t){return encodeURIComponent(t).replace($$,(e,n)=>q$[n]??e)}function Lf(t){return`${t}`}var Ci=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Lv,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=B$(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(Lf):[Lf(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{n.push({param:r,value:s,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Lf(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Lf(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Vv=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function H$(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function xx(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Mx(t){return typeof Blob<"u"&&t instanceof Blob}function Rx(t){return typeof FormData<"u"&&t instanceof FormData}function G$(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var gl=class t{constructor(e,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(H$(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ks,this.context??=new Vv,!this.params)this.params=new Ci,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+o}}}serializeBody(){return this.body===null?null:xx(this.body)||Mx(this.body)||Rx(this.body)||G$(this.body)||typeof this.body=="string"?this.body:this.body instanceof Ci?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Rx(this.body)?null:Mx(this.body)?this.body.type||null:xx(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Ci?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.body!==void 0?e.body:this.body,o=e.withCredentials!==void 0?e.withCredentials:this.withCredentials,a=e.reportProgress!==void 0?e.reportProgress:this.reportProgress,c=e.headers||this.headers,l=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(c=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),l)),new t(n,r,s,{params:l,headers:c,context:u,reportProgress:a,responseType:i,withCredentials:o})}},ya=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(ya||{}),yl=class{constructor(e,n=Bf.Ok,r="OK"){this.headers=e.headers||new ks,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},jv=class t extends yl{constructor(e={}){super(e),this.type=ya.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},jf=class t extends yl{constructor(e={}){super(e),this.type=ya.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Uf=class extends yl{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Bf=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(Bf||{});function Fv(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var z$=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof gl)o=r;else{let l;s.headers instanceof ks?l=s.headers:l=new ks(s.headers);let u;s.params&&(s.params instanceof Ci?u=s.params:u=new Ci({fromObject:s.params})),o=new gl(r,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:u,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=U(o).pipe(Lr(l=>this.handler.handle(l)));if(r instanceof gl||s.observe==="events")return a;let c=a.pipe(dt(l=>l instanceof jf));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(j(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(j(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(j(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(j(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Ci().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,Fv(s,i))}post(r,i,s={}){return this.request("POST",r,Fv(s,i))}put(r,i,s={}){return this.request("PUT",r,Fv(s,i))}};e.\u0275fac=function(i){return new(i||e)(E(ml))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function Ox(t,e){return e(t)}function W$(t,e){return(n,r)=>e.intercept(n,{handle:i=>t(i,r)})}function K$(t,e,n){return(r,i)=>hr(n,()=>e(r,s=>t(s,i)))}var Q$=new N(""),Uv=new N(""),Y$=new N(""),Z$=new N("");function X$(){let t=null;return(e,n)=>{t===null&&(t=(M(Q$,{optional:!0})??[]).reduceRight(W$,Ox));let r=M(Ss),i=r.add();return t(e,n).pipe(fi(()=>r.remove(i)))}}var Nx=(()=>{let e=class e extends ml{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=M(Ss);let s=M(Z$,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(Uv),...this.injector.get(Y$,[])]));this.chain=s.reduceRight((o,a)=>K$(o,a,this.injector),Ox)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(fi(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(E(Vf),E(qt))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();var J$=/^\)\]\}',?\n/;function e4(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var Px=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new $(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?pe(i.\u0275loadImpl()):U(null)).pipe(Me(()=>new ne(o=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((m,w)=>a.setRequestHeader(m,w.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let m=r.detectContentTypeHeader();m!==null&&a.setRequestHeader("Content-Type",m)}if(r.responseType){let m=r.responseType.toLowerCase();a.responseType=m!=="json"?m:"text"}let c=r.serializeBody(),l=null,u=()=>{if(l!==null)return l;let m=a.statusText||"OK",w=new ks(a.getAllResponseHeaders()),O=e4(a)||r.url;return l=new jv({headers:w,status:a.status,statusText:m,url:O}),l},d=()=>{let{headers:m,status:w,statusText:O,url:S}=u(),V=null;w!==Bf.NoContent&&(V=typeof a.response>"u"?a.responseText:a.response),w===0&&(w=V?Bf.Ok:0);let H=w>=200&&w<300;if(r.responseType==="json"&&typeof V=="string"){let z=V;V=V.replace(J$,"");try{V=V!==""?JSON.parse(V):null}catch(Ee){V=z,H&&(H=!1,V={error:Ee,text:V})}}H?(o.next(new jf({body:V,headers:m,status:w,statusText:O,url:S||void 0})),o.complete()):o.error(new Uf({error:V,headers:m,status:w,statusText:O,url:S||void 0}))},h=m=>{let{url:w}=u(),O=new Uf({error:m,status:a.status||0,statusText:a.statusText||"Unknown Error",url:w||void 0});o.error(O)},f=!1,p=m=>{f||(o.next(u()),f=!0);let w={type:ya.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),r.responseType==="text"&&a.responseText&&(w.partialText=a.responseText),o.next(w)},g=m=>{let w={type:ya.UploadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),o.next(w)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),r.reportProgress&&(a.addEventListener("progress",p),c!==null&&a.upload&&a.upload.addEventListener("progress",g)),a.send(c),o.next({type:ya.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),r.reportProgress&&(a.removeEventListener("progress",p),c!==null&&a.upload&&a.upload.removeEventListener("progress",g)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(E(pa))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Fx=new N(""),t4="XSRF-TOKEN",n4=new N("",{providedIn:"root",factory:()=>t4}),r4="X-XSRF-TOKEN",i4=new N("",{providedIn:"root",factory:()=>r4}),$f=class{},s4=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=Of(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(E(Pt),E(gt),E(n4))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function o4(t,e){let n=t.url.toLowerCase();if(!M(Fx)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=M($f).getToken(),i=M(i4);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}var Lx=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(Lx||{});function a4(t,e){return{\u0275kind:t,\u0275providers:e}}function c4(...t){let e=[z$,Px,Nx,{provide:ml,useExisting:Nx},{provide:Vf,useExisting:Px},{provide:Uv,useValue:o4,multi:!0},{provide:Fx,useValue:!0},{provide:$f,useClass:s4}];for(let n of t)e.push(...n.\u0275providers);return mf(e)}var kx=new N("");function l4(){return a4(Lx.LegacyInterceptors,[{provide:kx,useFactory:X$},{provide:Uv,useExisting:kx,multi:!0}])}var Vx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({providers:[c4(l4())]});let t=e;return t})();var qv=class extends kf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Hv=class t extends qv{static makeCurrent(){Ix(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=u4();return n==null?null:d4(n)}resetBaseElement(){_l=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Of(document.cookie,e)}},_l=null;function u4(){return _l=_l||document.querySelector("base"),_l?_l.getAttribute("href"):null}function d4(t){return new URL(t,document.baseURI).pathname}var Gv=class{addToWindow(e){Bt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Bt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Bt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Bt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Bt.frameworkStabilizers||(Bt.frameworkStabilizers=[]),Bt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?fr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},h4=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),zv=new N(""),$x=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(zv),E(de))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),qf=class{constructor(e){this._doc=e}},Bv="ng-app-id",qx=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ps(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Bv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Bv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Bv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(Pt),E(ff),E(Z_,8),E(gt))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),$v={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Kv=/%COMP%/g,Hx="%COMP%",f4=`_nghost-${Hx}`,p4=`_ngcontent-${Hx}`,g4=!0,m4=new N("",{providedIn:"root",factory:()=>g4});function y4(t){return p4.replace(Kv,t)}function _4(t){return f4.replace(Kv,t)}function Gx(t,e){return e.map(n=>n.replace(Kv,t))}var jx=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Ps(c),this.defaultRenderer=new vl(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ar.ShadowDom&&(i=le(A({},i),{encapsulation:ar.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Hf?s.applyToHost(r):s instanceof wl&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case ar.Emulated:o=new Hf(l,u,i,this.appId,d,a,c,h);break;case ar.ShadowDom:return new Wv(l,u,r,i,a,c,this.nonce,h);default:o=new wl(l,u,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E($x),E(qx),E(ff),E(m4),E(Pt),E(gt),E(de),E(Z_))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),vl=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS($v[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(Ux(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(Ux(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=$v[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=$v[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Ur.DashCase|Ur.Important)?e.style.setProperty(n,r,i&Ur.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Ur.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=fr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function Ux(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Wv=class extends vl{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=Gx(i.id,i.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},wl=class extends vl{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?Gx(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Hf=class extends wl{constructor(e,n,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,n,r,s,o,a,c,l),this.contentAttr=y4(l),this.hostAttr=_4(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},v4=(()=>{let e=class e extends qf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(Pt))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Bx=["alt","control","meta","shift"],w4={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},E4={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},I4=(()=>{let e=class e extends qf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),Bx.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=w4[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Bx.forEach(a=>{if(a!==s){let c=E4[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(Pt))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function C4(){Hv.makeCurrent()}function D4(){return new ur}function b4(){return OS(document),document}var T4=[{provide:gt,useValue:Ov},{provide:Y_,useValue:C4,multi:!0},{provide:Pt,useFactory:b4,deps:[]}],zx=bv(px,"browser",T4),S4=new N(""),A4=[{provide:fl,useClass:Gv,deps:[]},{provide:Iv,useClass:xf,deps:[de,Mf,fl]},{provide:xf,useClass:xf,deps:[de,Mf,fl]}],x4=[{provide:yf,useValue:"root"},{provide:ur,useFactory:D4,deps:[]},{provide:zv,useClass:v4,multi:!0,deps:[Pt,de,gt]},{provide:zv,useClass:I4,multi:!0,deps:[Pt]},jx,qx,$x,{provide:sl,useExisting:jx},{provide:pa,useClass:h4,deps:[]},[]],Wx=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:ff,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(S4,12))},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({providers:[...x4,...A4],imports:[Tx,gx]});let t=e;return t})();var Kx=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(Pt))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var M4="firebase",R4="10.8.1";jn(M4,R4,"app");var Os=new Br("ANGULARFIRE2_VERSION");var N4=(t,e)=>{let n=e?[e]:zb(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Kr=class{constructor(){return N4(P4)}},P4="app-check";function Qv(){}var Gf=class{zone;delegate;constructor(e,n=xy){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Yv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Qv,{},Qv,Qv)),n.pipe(Qe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},_a=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Gf(Zone.current)),this.insideAngular=n.run(()=>new Gf(Zone.current,ps)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(de))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function k4(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ye(t){return O4(k4())(t)}function O4(t){return function(n){return n=n.lift(new Yv(t.ngZone)),n.pipe(Bn(t.outsideAngular),Cn(t.insideAngular))}}var F4="firebase",L4="10.8.1";Ct.registerVersion(F4,L4,"app-compat");var V4=["ngOnDestroy"],Zx=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(V4.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>n.run(()=>l)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(u=>{let d=u?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,d),d})})})});var zf=class{constructor(e){return e}},Di=new N("angularfire2.app.options"),bi=new N("angularfire2.app.name");function Fs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Ct.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ct.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;j4("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new zf(o)}var j4=(t,...e)=>{Tv()&&typeof console<"u"&&console[t](...e)},U4={provide:zf,useFactory:Fs,deps:[Di,de,[new la,bi]]},Xx=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Di,useValue:n},{provide:bi,useValue:r}]}}constructor(n){Ct.registerVersion("angularfire",Os.full,"core"),Ct.registerVersion("angularfire",Os.full,"app-compat"),Ct.registerVersion("angular",ox.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(gt))};static \u0275mod=$e({type:t});static \u0275inj=qe({providers:[U4]})}return t})();function va(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return B4(i,o)||(Yx("error",`${e} was already initialized on the ${n} Firebase App with different settings.${$4?" You may need to reload as Firebase is not HMR aware.":""}`),Yx("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function B4(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var $4=typeof module<"u"&&!!module.hot,Yx=(t,...e)=>{Tv()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var q4=new Map,H4={activated:!1,tokenObservers:[]},G4={initialized:!1,enabled:!1};function Wn(t){return q4.get(t)||Object.assign({},H4)}function sM(){return G4}var z4="https://content-firebaseappcheck.googleapis.com/v1";var W4="exchangeDebugToken",Jx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},fte=24*60*60*1e3;var Jv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new pt,this.pending.promise.catch(n=>{}),yield K4(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new pt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function K4(t){return new Promise(e=>{setTimeout(e,t)})}var Q4={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ti=new Ub("appCheck","AppCheck",Q4);function oM(t){if(!Wn(t).activated)throw Ti.create("use-before-activation",{appName:t.name})}function aM(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Ti.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Ti.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(f){throw Ti.create("fetch-parse-error",{originalErrorMessage:f?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Ti.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:l.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function cM(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${z4}/projects/${n}/apps/${r}:${W4}?key=${i}`,body:{debug_token:e}}}var Y4="firebase-app-check-database",Z4=1,ew="firebase-app-check-store";var Wf=null;function X4(){return Wf||(Wf=new Promise((t,e)=>{try{let n=indexedDB.open(Y4,Z4);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Ti.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ew,{keyPath:"compositeKey"})}}}catch(n){e(Ti.create("storage-open",{originalErrorMessage:n?.message}))}}),Wf)}function J4(t,e){return eq(tq(t),e)}function eq(t,e){return v(this,null,function*(){let r=(yield X4()).transaction(ew,"readwrite"),s=r.objectStore(ew).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Ti.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function tq(t){return`${t.options.appId}-${t.name}`}var tw=new li("@firebase/app-check");function Xv(t,e){return Kd()?J4(t,e).catch(n=>{tw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function lM(){return sM().enabled}function uM(){return v(this,null,function*(){let t=sM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var nq={error:"UNKNOWN_ERROR"};function rq(t){return zd.encodeString(JSON.stringify(t),!1)}function nw(t,e=!1){return v(this,null,function*(){let n=t.app;oM(n);let r=Wn(n),i=r.token,s;if(i&&!El(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(El(c)?i=c:yield Xv(n,void 0))}if(!e&&i&&El(i))return{token:i.token};let o=!1;if(lM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=aM(cM(n,yield uM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Xv(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Wn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?tw.warn(c.message):tw.error(c),s=c}let a;return i?s?El(i)?a={token:i.token,internalError:s}:a=tM(s):(a={token:i.token},r.token=i,yield Xv(n,i)):a=tM(s),o&&aq(n,a),a})}function iq(t){return v(this,null,function*(){let e=t.app;oM(e);let{provider:n}=Wn(e);if(lM()){let r=yield uM(),{token:i}=yield aM(cM(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function sq(t,e,n,r){let{app:i}=t,s=Wn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&El(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),eM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>eM(t))}function dM(t,e){let n=Wn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function eM(t){let{app:e}=t,n=Wn(e),r=n.tokenRefresher;r||(r=oq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function oq(t){let{app:e}=t;return new Jv(()=>v(this,null,function*(){let n=Wn(e),r;if(n.token?r=yield nw(t,!0):r=yield nw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Wn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Jx.RETRIAL_MIN_WAIT,Jx.RETRIAL_MAX_WAIT)}function aq(t,e){let n=Wn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function El(t){return t.expireTimeMillis-Date.now()>0}function tM(t){return{token:rq(nq),error:t}}var rw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Wn(this.app);for(let n of e)dM(this.app,n.next);return Promise.resolve()}};function cq(t,e){return new rw(t,e)}function lq(t){return{getToken:e=>nw(t,e),getLimitedUseToken:()=>iq(t),addTokenListener:e=>sq(t,"INTERNAL",e),removeTokenListener:e=>dM(t.app,e)}}var uq="@firebase/app-check",dq="0.8.2";var hq="app-check",nM="app-check-internal";function fq(){ls(new ln(hq,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return cq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(nM).initialize()})),ls(new ln(nM,t=>{let e=t.getProvider("app-check").getImmediate();return lq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),jn(uq,dq)}fq();var pq=["localhost","0.0.0.0","127.0.0.1"],bte=typeof window<"u"&&pq.includes(window.location.hostname);var Il=new N("angularfire2.auth.use-emulator"),Cl=new N("angularfire2.auth.settings"),Dl=new N("angularfire2.auth.tenant-id"),bl=new N("angularfire2.auth.langugage-code"),Tl=new N("angularfire2.auth.use-device-language"),Sl=new N("angularfire.auth.persistence"),Al=(t,e,n,r,i,s,o,a)=>va(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,u]of Object.entries(o))c.settings[l]=u;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),Kf=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,l,u,d,h,f){let p=new tt,g=U(void 0).pipe(Cn(o.outsideAngular),Me(()=>s.runOutsideAngular(()=>import("./chunk-KPF5FW2Q.js"))),j(()=>Fs(n,s,r)),j(m=>Al(m,s,a,l,u,d,c,h)),Dh({bufferSize:1,refCount:!1}));if(Ps(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(Dn()).subscribe();let m=g.pipe(Me(S=>S.getRedirectResult().then(V=>V,()=>null)),Ye,Dh({bufferSize:1,refCount:!1})),w=g.pipe(Me(S=>new ne(V=>({unsubscribe:s.runOutsideAngular(()=>S.onAuthStateChanged(H=>V.next(H),H=>V.error(H),()=>V.complete()))})))),O=g.pipe(Me(S=>new ne(V=>({unsubscribe:s.runOutsideAngular(()=>S.onIdTokenChanged(H=>V.next(H),H=>V.error(H),()=>V.complete()))}))));this.authState=m.pipe(bh(w),Bn(o.outsideAngular),Cn(o.insideAngular)),this.user=m.pipe(bh(O),Bn(o.outsideAngular),Cn(o.insideAngular)),this.idToken=this.user.pipe(Me(S=>S?pe(S.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(Me(S=>S?pe(S.getIdTokenResult()):U(null))),this.credential=Ho(m,p,this.authState.pipe(dt(S=>!S))).pipe(j(S=>S?.user?S:null),Bn(o.outsideAngular),Cn(o.insideAngular))}return Zx(this,g,s,{spy:{apply:(m,w,O)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&O.then(S=>p.next(S))}}})}static \u0275fac=function(r){return new(r||t)(E(Di),E(bi,8),E(gt),E(de),E(_a),E(Il,8),E(Cl,8),E(Dl,8),E(bl,8),E(Tl,8),E(Sl,8),E(Kr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var fM="@firebase/database",pM="1.0.3";var mE="";function yE(t){mE=t}var hw=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),et(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Qd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var fw=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return En(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var GM=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new hw(e)}}catch{}return new fw},Vs=GM("localStorage"),pw=GM("sessionStorage");var Ca=new li("@firebase/database"),zM=function(){let t=1;return function(){return t++}}(),WM=function(t){let e=Gb(t),n=new Hb;n.update(e);let r=n.digest();return zd.encodeByteArray(r)},Xl=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Xl.apply(null,r):typeof r=="object"?e+=et(r):e+=r,e+=" "}return e},js=null,gM=!0,KM=function(t,e){T(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Ca.logLevel=In.VERBOSE,js=Ca.log.bind(Ca),e&&pw.set("logging_enabled",!0)):typeof t=="function"?js=t:(js=null,pw.remove("logging_enabled"))},mt=function(...t){if(gM===!0&&(gM=!1,js===null&&pw.get("logging_enabled")===!0&&KM(!0)),js){let e=Xl.apply(null,t);js(e)}},Jl=function(t){return function(...e){mt(t,...e)}},gw=function(...t){let e="FIREBASE INTERNAL ERROR: "+Xl(...t);Ca.error(e)},mr=function(...t){let e=`FIREBASE FATAL ERROR: ${Xl(...t)}`;throw Ca.error(e),new Error(e)},kt=function(...t){let e="FIREBASE WARNING: "+Xl(...t);Ca.warn(e)},mq=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&kt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ip=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},yq=function(t){if(nr()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Mi="[MIN_NAME]",Qr="[MAX_NAME]",Bs=function(t,e){if(t===e)return 0;if(t===Mi||e===Qr)return-1;if(e===Mi||t===Qr)return 1;{let n=mM(t),r=mM(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},_q=function(t,e){return t===e?0:t<e?-1:1},xl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+et(e))},_E=function(t){if(typeof t!="object"||t===null)return et(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=et(e[r]),n+=":",n+=_E(t[e[r]]);return n+="}",n},QM=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function yt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var YM=function(t){T(!Ip(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(u.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},vq=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},wq=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Eq(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var Iq=new RegExp("^-?(0*)\\d{1,10}$"),Cq=-2147483648,Dq=2147483647,mM=function(t){if(Iq.test(t)){let e=Number(t);if(e>=Cq&&e<=Dq)return e}return null},Na=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw kt("Exception was thrown by user callback.",n),e},Math.floor(0))}},bq=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Pl=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var mw=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){kt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var yw=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(mt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',kt(e)}},kl=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Yf="5",ZM="v",XM="s",JM="r",eR="f",tR=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nR="ls",rR="p",_w="ac",iR="websocket",sR="long_polling";var Zf=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Tq(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function oR(t,e,n){T(typeof e=="string","typeof type must == string"),T(typeof n=="object","typeof params must == object");let r;if(e===iR)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===sR)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Tq(t)&&(n.ns=t.namespace);let i=[];return yt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var vw=class{constructor(){this.counters_={}}incrementCounter(e,n=1){En(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Lb(this.counters_)}};var sw={},ow={};function vE(t){let e=t.toString();return sw[e]||(sw[e]=new vw),sw[e]}function Sq(t,e){let n=t.toString();return ow[n]||(ow[n]=e()),ow[n]}var ww=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Na(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var yM="start",Aq="close",xq="pLPCommand",Mq="pRTLPCB",aR="id",cR="pw",lR="ser",Rq="cb",Nq="seg",Pq="ts",kq="d",Oq="dframe",uR=1870,dR=30,Fq=uR-dR,Lq=25e3,Vq=3e4,Vl=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Jl(e),this.stats_=vE(n),this.urlFn=c=>(this.appCheckToken&&(c[_w]=this.appCheckToken),oR(n,sR,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ww(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Vq)),yq(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ew((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===yM)this.id=a,this.password=c;else if(o===Aq)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[yM]="t",r[lR]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Rq]=this.scriptTagHolder.uniqueCallbackIdentifier),r[ZM]=Yf,this.transportSessionId&&(r[XM]=this.transportSessionId),this.lastSessionId&&(r[nR]=this.lastSessionId),this.applicationId&&(r[rR]=this.applicationId),this.appCheckToken&&(r[_w]=this.appCheckToken),typeof location<"u"&&location.hostname&&tR.test(location.hostname)&&(r[JM]=eR);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return nr()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vq()&&!wq()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Fb(n),i=QM(r,Fq);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(nr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Oq]="t",r[aR]=e,r[cR]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Ew=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,nr())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=zM(),window[xq+this.uniqueCallbackIdentifier]=e,window[Mq+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){mt("frame writing exception"),a.stack&&mt(a.stack),mt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||mt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[aR]=this.myID,e[cR]=this.myPW,e[lR]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+dR+r.length<=uR;){let o=this.pendingSegs.shift();r=r+"&"+Nq+i+"="+o.seg+"&"+Pq+i+"="+o.ts+"&"+kq+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(Lq)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){nr()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{mt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var jq=16384,Uq=45e3,Xf=null;typeof MozWebSocket<"u"?Xf=MozWebSocket:typeof WebSocket<"u"&&(Xf=WebSocket);var Ea=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Jl(this.connId),this.stats_=vE(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[ZM]=Yf,!nr()&&typeof location<"u"&&location.hostname&&tR.test(location.hostname)&&(a[JM]=eR),r&&(a[XM]=r),i&&(a[nR]=i),s&&(a[_w]=s),o&&(a[rR]=o),oR(n,iR,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vs.set("previous_websocket_failure",!0);try{let i;if(nr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Yf}/${mE}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Xf(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Xf!==null&&!t.forceDisallow_}static previouslyFailed(){return Vs.isInMemoryStorage||Vs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vs.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Qd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(T(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=et(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=QM(r,jq);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Uq))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),hR=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Vl,Ea]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Ea&&Ea.isAvailable(),i=r&&!Ea.previouslyFailed();if(n.webSocketOnly&&(r||kt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ea];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),Bq=6e4,$q=5e3,qq=10*1024,Hq=100*1024,aw="t",_M="d",Gq="s",vM="r",zq="e",wM="o",EM="a",IM="n",CM="p",Wq="h",Iw=class{constructor(e,n,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Jl("c:"+this.id+":"),this.transportManager_=new hR(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Pl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Hq?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>qq?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(aw in e){let n=e[aw];n===EM?this.upgradeIfSecondaryHealthy_():n===vM?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===wM&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=xl("t",e),r=xl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:CM,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:EM,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:IM,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=xl("t",e),r=xl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=xl(aw,e);if(_M in e){let r=e[_M];if(n===Wq){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===IM){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Gq?this.onConnectionShutdown_(r):n===vM?this.onReset_(r):n===zq?gw("Server Error: "+r):n===wM?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gw("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Yf!==r&&kt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Pl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Bq))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Pl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($q))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:CM,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Jf=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var ep=class{constructor(e){this.allowedEvents_=e,this.listeners_={},T(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){T(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var tp=class t extends ep{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!uy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return T(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var DM=32,bM=768,we=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new we("")}function se(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ri(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function wE(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Kq(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function jl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function fR(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function Le(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new we(n,0)}function oe(t){return t.pieceNum_>=t.pieces_.length}function zt(t,e){let n=se(t),r=se(e);if(n===null)return e;if(n===r)return zt(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Qq(t,e){let n=jl(t,0),r=jl(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Bs(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function EE(t,e){if(Ri(t)!==Ri(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function xn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ri(t)>Ri(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Cw=class{constructor(e,n){this.errorPrefix_=n,this.parts_=jl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=qc(this.parts_[r]);pR(this)}};function Yq(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=qc(e),pR(t)}function Zq(t){let e=t.parts_.pop();t.byteLength_-=qc(e),t.parts_.length>0&&(t.byteLength_-=1)}function pR(t){if(t.byteLength_>bM)throw new Error(t.errorPrefix_+"has a key path longer than "+bM+" bytes ("+t.byteLength_+").");if(t.parts_.length>DM)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+DM+") or object contains a cycle "+Ls(t))}function Ls(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Dw=class t extends ep{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return T(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ml=1e3,Xq=60*5*1e3,TM=30*1e3,Jq=1.3,eH=3e4,tH="server_kill",SM=3,IE=(()=>{class t extends Jf{constructor(n,r,i,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=Jl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ml,this.maxReconnectDelay_=Xq,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!nr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Dw.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&tp.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(et(o)),T(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new pt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),T(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&En(n,"w")){let i=ci(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();kt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||$b(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=TM)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Bb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+et(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):gw("Unrecognized action received from server: "+et(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){T(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ml,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ml,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>eH&&(this.reconnectDelay_=Ml),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Jq)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(h){T(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?mt("getToken() completed but was canceled"):(mt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new Iw(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{kt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(tH)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&kt(h),l())}}})}interrupt(n){mt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){mt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Yd(this.interruptReasons_)&&(this.reconnectDelay_=Ml,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>_E(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new we(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){mt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=SM&&(this.reconnectDelay_=TM,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){mt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=SM&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";nr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+mE.replace(/\./g,"-")]=1,uy()?n["framework.cordova"]=1:Vb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=tp.getInstance().currentlyOnline();return Yd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Da=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(Mi,e),i=new ce(Mi,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var Qf,np=class extends Da{static get __EMPTY_NODE(){return Qf}static set __EMPTY_NODE(e){Qf=e}compare(e,n){return Bs(e.name,n.name)}isDefinedOn(e){throw Ro("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(Qr,Qf)}makePost(e,n){return T(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,Qf)}toString(){return".key"}},gr=new np;var Ia=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Kn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Mn.EMPTY_NODE,this.right=o??Mn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Mn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Mn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),bw=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Kn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Mn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Kn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Kn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ia(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ia(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ia(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ia(this.root_,null,this.comparator_,!0,e)}};Mn.EMPTY_NODE=new bw;function nH(t,e){return Bs(t.name,e.name)}function CE(t,e){return Bs(t,e)}var Tw;function rH(t){Tw=t}var gR=function(t){return typeof t=="number"?"number:"+YM(t):"string:"+t},mR=function(t){if(t.isLeafNode()){let e=t.val();T(typeof e=="string"||typeof e=="number"||typeof e=="object"&&En(e,".sv"),"Priority must be a string or number.")}else T(t===Tw||t.isEmpty(),"priority of unexpected type.");T(t===Tw||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var AM,ba=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,T(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),mR(this.priorityNode_)}static set __childrenNodeConstructor(n){AM=n}static get __childrenNodeConstructor(){return AM}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return oe(n)?this:se(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=se(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(T(i!==".priority"||Ri(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+gR(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=YM(this.value_):n+=this.value_,this.lazyHash_=WM(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(T(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return T(s>=0,"Unknown leaf type: "+r),T(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),yR,_R;function iH(t){yR=t}function sH(t){_R=t}var Sw=class extends Da{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Bs(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(Qr,new ba("[PRIORITY-POST]",_R))}makePost(e,n){let r=yR(e);return new ce(n,new ba("[PRIORITY-POST]",r))}toString(){return".priority"}},Ne=new Sw;var oH=Math.log(2),Aw=class{constructor(e){let n=s=>parseInt(Math.log(s)/oH,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},rp=function(t,e,n,r){t.sort(e);let i=function(c,l){let u=l-c,d,h;if(u===0)return null;if(u===1)return d=t[c],h=n?n(d):d,new Kn(h,d.node,Kn.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=i(c,f),g=i(f+1,l);return d=t[f],h=n?n(d):d,new Kn(h,d.node,Kn.BLACK,p,g)}},s=function(c){let l=null,u=null,d=t.length,h=function(p,g){let m=d-p,w=d;d-=p;let O=i(m+1,w),S=t[m],V=n?n(S):S;f(new Kn(V,S.node,g,null,O))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let g=c.nextBitIsOne(),m=Math.pow(2,c.count-(p+1));g?h(m,Kn.BLACK):(h(m,Kn.BLACK),h(m,Kn.RED))}return u},o=new Aw(t.length),a=s(o);return new Mn(r||e,a)};var cw,wa={},Ta=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return T(wa&&Ne,"ChildrenNode.ts has not been loaded"),cw=cw||new t({".priority":wa},{".priority":Ne}),cw}get(e){let n=ci(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Mn?n:null}hasIndex(e){return En(this.indexSet_,e.toString())}addIndex(e,n){T(e!==gr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=rp(r,e.getCompare()):a=wa;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let r=$c(this.indexes_,(i,s)=>{let o=ci(this.indexSet_,s);if(T(o,"Missing index implementation for "+s),i===wa)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ce.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),rp(a,o.getCompare())}else return wa;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ce(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=$c(this.indexes_,i=>{if(i===wa)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var Rl,J=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&mR(this.priorityNode_),this.children_.isEmpty()&&T(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Rl||(Rl=new t(new Mn(CE),null,Ta.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Rl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Rl:r}}getChild(n){let r=se(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(T(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Rl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=se(n);if(i===null)return r;{T(se(n)!==".priority"||Ri(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ne,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+gR(this.getPriority().val())+":"),this.forEachChild(Ne,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":WM(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===eu?-1:0}withIndex(n){if(n===gr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===gr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ne),s=r.getIterator(Ne),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===gr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),xw=class extends J{constructor(){super(new Mn(CE),J.EMPTY_NODE,Ta.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return J.EMPTY_NODE}isEmpty(){return!1}},eu=new xw;Object.defineProperties(ce,{MIN:{value:new ce(Mi,J.EMPTY_NODE)},MAX:{value:new ce(Qr,eu)}});np.__EMPTY_NODE=J.EMPTY_NODE;ba.__childrenNodeConstructor=J;rH(eu);sH(eu);var aH=!0;function Ue(t,e=null){if(t===null)return J.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),T(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new ba(n,Ue(e))}if(!(t instanceof Array)&&aH){let n=[],r=!1;if(yt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=Ue(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ce(o,c)))}}),n.length===0)return J.EMPTY_NODE;let s=rp(n,nH,o=>o.name,CE);if(r){let o=rp(n,Ne.getCompare());return new J(s,Ue(e),new Ta({".priority":o},{".priority":Ne}))}else return new J(s,Ue(e),Ta.Default)}else{let n=J.EMPTY_NODE;return yt(t,(r,i)=>{if(En(t,r)&&r.substring(0,1)!=="."){let s=Ue(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ue(e))}}iH(Ue);var Ul=class extends Da{constructor(e){super(),this.indexPath_=e,T(!oe(e)&&se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Bs(e.name,n.name):s}makePost(e,n){let r=Ue(e),i=J.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=J.EMPTY_NODE.updateChild(this.indexPath_,eu);return new ce(Qr,e)}toString(){return jl(this.indexPath_,0).join("/")}};var Mw=class extends Da{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Bs(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=Ue(e);return new ce(n,r)}toString(){return".value"}},DE=new Mw;function vR(t){return{type:"value",snapshotNode:t}}function Sa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Bl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function $l(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function cH(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var ql=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){T(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Bl(n,a)):T(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Sa(n,r)):o.trackChildChange($l(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ne,(i,s)=>{n.hasChild(i)||r.trackChildChange(Bl(i,s))}),n.isLeafNode()||n.forEachChild(Ne,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange($l(i,s,o))}else r.trackChildChange(Sa(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?J.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var ip=class t{constructor(e){this.indexedFilter_=new ql(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ce(n,r))||(r=J.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=J.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(J.EMPTY_NODE);let s=this;return n.forEachChild(Ne,(o,a)=>{s.matches(new ce(o,a))||(i=i.updateImmediateChild(o,J.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Rw=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ip(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ce(n,r))||(r=J.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=J.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=J.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(J.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,J.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;T(a.numChildren()===this.limit_,"");let c=new ce(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,l,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(u&&!r.isEmpty()&&f>=0)return s?.trackChildChange($l(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Bl(n,d));let g=a.updateImmediateChild(n,J.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Sa(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Bl(l.name,l.node)),s.trackChildChange(Sa(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,J.EMPTY_NODE)):e}};var Hl=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return T(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return T(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Mi}hasEnd(){return this.endSet_}getIndexEndValue(){return T(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return T(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return T(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ne}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function lH(t){return t.loadsAllData()?new ql(t.getIndex()):t.hasLimit()?new Rw(t):new ip(t)}function uH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function dH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Nw(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function hH(t,e,n){let r;return t.index_===gr||n?r=Nw(t,e,n):r=Nw(t,e,Qr),r.startAfterSet_=!0,r}function Pw(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function fH(t,e,n){let r;return t.index_===gr||n?r=Pw(t,e,n):r=Pw(t,e,Mi),r.endBeforeSet_=!0,r}function Cp(t,e){let n=t.copy();return n.index_=e,n}function xM(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ne?n="$priority":t.index_===DE?n="$value":t.index_===gr?n="$key":(T(t.index_ instanceof Ul,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=et(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+et(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function MM(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ne&&(e.i=t.index_.toString()),e}var kw=class t extends Jf{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Jl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(T(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=xM(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,r),ci(this.listens_,o)===a){let h;l?l===401?h="permission_denied":h="rest_error:"+l:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=xM(e._queryParams),r=e._path.toString(),i=new pt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+qb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Qd(a.responseText)}catch{kt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&kt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Ow=class{constructor(){this.rootNode_=J.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function sp(){return{value:null,children:new Map}}function Pa(t,e,n){if(oe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=se(e);t.children.has(r)||t.children.set(r,sp());let i=t.children.get(r);e=Ae(e),Pa(i,e,n)}}function Fw(t,e){if(oe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ne,(r,i)=>{Pa(t,new we(r),i)}),Fw(t,e)}}else if(t.children.size>0){let n=se(e);return e=Ae(e),t.children.has(n)&&Fw(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Lw(t,e,n){t.value!==null?n(e,t.value):pH(t,(r,i)=>{let s=new we(e.toString()+"/"+r);Lw(i,s,n)})}function pH(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Vw=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&yt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var RM=10*1e3,gH=30*1e3,mH=5*60*1e3,jw=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Vw(e);let r=RM+(gH-RM)*Math.random();Pl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;yt(e,(i,s)=>{s>0&&En(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Pl(this.reportStats_.bind(this),Math.floor(Math.random()*2*mH))}};var pr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(pr||{});function bE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function TE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function SE(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Uw=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=pr.ACK_USER_WRITE,this.source=bE()}operationForChild(e){if(oe(this.path)){if(this.affectedTree.value!=null)return T(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new we(e));return new t(ve(),n,this.revert)}}else return T(se(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var op=class t{constructor(e,n){this.source=e,this.path=n,this.type=pr.LISTEN_COMPLETE}operationForChild(e){return oe(this.path)?new t(this.source,ve()):new t(this.source,Ae(this.path))}};var Aa=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=pr.OVERWRITE}operationForChild(e){return oe(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var Gl=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=pr.MERGE}operationForChild(e){if(oe(this.path)){let n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new Aa(this.source,ve(),n.value):new t(this.source,ve(),n)}else return T(se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var yr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(oe(e))return this.isFullyInitialized()&&!this.filtered_;let n=se(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Bw=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function yH(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(cH(o.childName,o.snapshotNode))}),Nl(t,i,"child_removed",e,r,n),Nl(t,i,"child_added",e,r,n),Nl(t,i,"child_moved",s,r,n),Nl(t,i,"child_changed",e,r,n),Nl(t,i,"value",e,r,n),i}function Nl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>vH(t,a,c)),o.forEach(a=>{let c=_H(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function _H(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function vH(t,e,n){if(e.childName==null||n.childName==null)throw Ro("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Dp(t,e){return{eventCache:t,serverCache:e}}function Ol(t,e,n,r){return Dp(new yr(e,n,r),t.serverCache)}function wR(t,e,n,r){return Dp(t.eventCache,new yr(e,n,r))}function ap(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Us(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var lw,wH=()=>(lw||(lw=new Mn(_q)),lw),Wt=class t{constructor(e,n=wH()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return yt(e,(r,i)=>{n=n.set(new we(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(oe(e))return null;{let r=se(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:Le(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(oe(e))return this;{let n=se(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(oe(e))return new t(n,this.children);{let r=se(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(oe(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=se(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(oe(e))return this.value;{let n=se(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(oe(e))return n;{let r=se(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Le(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(oe(e))return null;{let s=se(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),Le(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(oe(e))return this;{this.value&&r(n,this.value);let i=se(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),Le(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Le(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Qn=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Wt(null))}};function Fl(t,e,n){if(oe(e))return new Qn(new Wt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=zt(i,e);return s=s.updateChild(o,n),new Qn(t.writeTree_.set(i,s))}else{let i=new Wt(n),s=t.writeTree_.setTree(e,i);return new Qn(s)}}}function $w(t,e,n){let r=t;return yt(n,(i,s)=>{r=Fl(r,Le(e,i),s)}),r}function NM(t,e){if(oe(e))return Qn.empty();{let n=t.writeTree_.setTree(e,new Wt(null));return new Qn(n)}}function qw(t,e){return $s(t,e)!=null}function $s(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(zt(n.path,e)):null}function PM(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ne,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function Ai(t,e){if(oe(e))return t;{let n=$s(t,e);return n!=null?new Qn(new Wt(n)):new Qn(t.writeTree_.subtree(e))}}function Hw(t){return t.writeTree_.isEmpty()}function xa(t,e){return ER(ve(),t.writeTree_,e)}function ER(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(T(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=ER(Le(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Le(t,".priority"),r)),n}}function bp(t,e){return bR(e,t)}function EH(t,e,n,r,i){T(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Fl(t.visibleWrites,e,n)),t.lastWriteId=r}function IH(t,e,n,r){T(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=$w(t.visibleWrites,e,n),t.lastWriteId=r}function CH(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function DH(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);T(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&bH(a,r.path)?i=!1:xn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return TH(t),!0;if(r.snap)t.visibleWrites=NM(t.visibleWrites,r.path);else{let a=r.children;yt(a,c=>{t.visibleWrites=NM(t.visibleWrites,Le(r.path,c))})}return!0}else return!1}function bH(t,e){if(t.snap)return xn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&xn(Le(t.path,n),e))return!0;return!1}function TH(t){t.visibleWrites=IR(t.allWrites,SH,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function SH(t){return t.visible}function IR(t,e,n){let r=Qn.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)xn(n,o)?(a=zt(n,o),r=Fl(r,a,s.snap)):xn(o,n)&&(a=zt(o,n),r=Fl(r,ve(),s.snap.getChild(a)));else if(s.children){if(xn(n,o))a=zt(n,o),r=$w(r,a,s.children);else if(xn(o,n))if(a=zt(o,n),oe(a))r=$w(r,ve(),s.children);else{let c=ci(s.children,se(a));if(c){let l=c.getChild(Ae(a));r=Fl(r,ve(),l)}}}else throw Ro("WriteRecord should have .snap or .children")}}return r}function CR(t,e,n,r,i){if(!r&&!i){let s=$s(t.visibleWrites,e);if(s!=null)return s;{let o=Ai(t.visibleWrites,e);if(Hw(o))return n;if(n==null&&!qw(o,ve()))return null;{let a=n||J.EMPTY_NODE;return xa(o,a)}}}else{let s=Ai(t.visibleWrites,e);if(!i&&Hw(s))return n;if(!i&&n==null&&!qw(s,ve()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(xn(l.path,e)||xn(e,l.path))},a=IR(t.allWrites,o,e),c=n||J.EMPTY_NODE;return xa(a,c)}}}function AH(t,e,n){let r=J.EMPTY_NODE,i=$s(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ne,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Ai(t.visibleWrites,e);return n.forEachChild(Ne,(o,a)=>{let c=xa(Ai(s,new we(o)),a);r=r.updateImmediateChild(o,c)}),PM(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Ai(t.visibleWrites,e);return PM(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function xH(t,e,n,r,i){T(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Le(e,n);if(qw(t.visibleWrites,s))return null;{let o=Ai(t.visibleWrites,s);return Hw(o)?i.getChild(n):xa(o,i.getChild(n))}}function MH(t,e,n,r){let i=Le(e,n),s=$s(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Ai(t.visibleWrites,i);return xa(o,r.getNode().getImmediateChild(n))}else return null}function RH(t,e){return $s(t.visibleWrites,e)}function NH(t,e,n,r,i,s,o){let a,c=Ai(t.visibleWrites,e),l=$s(c,ve());if(l!=null)a=l;else if(n!=null)a=xa(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&u.length<i;)d(f,r)!==0&&u.push(f),f=h.getNext();return u}else return[]}function PH(){return{visibleWrites:Qn.empty(),allWrites:[],lastWriteId:-1}}function cp(t,e,n,r){return CR(t.writeTree,t.treePath,e,n,r)}function AE(t,e){return AH(t.writeTree,t.treePath,e)}function kM(t,e,n,r){return xH(t.writeTree,t.treePath,e,n,r)}function lp(t,e){return RH(t.writeTree,Le(t.treePath,e))}function kH(t,e,n,r,i,s){return NH(t.writeTree,t.treePath,e,n,r,i,s)}function xE(t,e,n){return MH(t.writeTree,t.treePath,e,n)}function DR(t,e){return bR(Le(t.treePath,e),t.writeTree)}function bR(t,e){return{treePath:t,writeTree:e}}var Gw=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;T(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),T(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,$l(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Bl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Sa(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,$l(r,e.snapshotNode,i.oldSnap));else throw Ro("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var zw=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},TR=new zw,zl=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new yr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return xE(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Us(this.viewCache_),s=kH(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function OH(t){return{filter:t}}function FH(t,e){T(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),T(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function LH(t,e,n,r,i){let s=new Gw,o,a;if(n.type===pr.OVERWRITE){let l=n;l.source.fromUser?o=Ww(t,e,l.path,l.snap,r,i,s):(T(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!oe(l.path),o=up(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===pr.MERGE){let l=n;l.source.fromUser?o=jH(t,e,l.path,l.children,r,i,s):(T(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Kw(t,e,l.path,l.children,r,i,a,s))}else if(n.type===pr.ACK_USER_WRITE){let l=n;l.revert?o=$H(t,e,l.path,r,i,s):o=UH(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===pr.LISTEN_COMPLETE)o=BH(t,e,n.path,r,s);else throw Ro("Unknown operation type: "+n.type);let c=s.getChanges();return VH(e,o,c),{viewCache:o,changes:c}}function VH(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=ap(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(vR(ap(e)))}}function SR(t,e,n,r,i,s){let o=e.eventCache;if(lp(r,n)!=null)return e;{let a,c;if(oe(n))if(T(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Us(e),u=l instanceof J?l:J.EMPTY_NODE,d=AE(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=cp(r,Us(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=se(n);if(l===".priority"){T(Ri(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=kM(r,n,u,c);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=Ae(n),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let h=kM(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(l).updateChild(u,h):d=o.getNode().getImmediateChild(l)}else d=xE(r,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,u,i,s):a=o.getNode()}}return Ol(e,a,o.isFullyInitialized()||oe(n),t.filter.filtersNodes())}}function up(t,e,n,r,i,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(oe(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{let f=se(n);if(!c.isCompleteForPath(n)&&Ri(n)>1)return e;let p=Ae(n),m=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),m):l=u.updateChild(c.getNode(),f,m,p,TR,null)}let d=wR(e,l,c.isFullyInitialized()||oe(n),u.filtersNodes()),h=new zl(i,d,s);return SR(t,d,n,i,h,a)}function Ww(t,e,n,r,i,s,o){let a=e.eventCache,c,l,u=new zl(i,e,s);if(oe(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Ol(e,l,!0,t.filter.filtersNodes());else{let d=se(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Ol(e,l,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(oe(h))p=r;else{let g=u.getCompleteChild(d);g!=null?wE(h)===".priority"&&g.getChild(fR(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=J.EMPTY_NODE}if(f.equals(p))c=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,u,o);c=Ol(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function OM(t,e){return t.eventCache.isCompleteForChild(e)}function jH(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=Le(n,c);OM(e,se(u))&&(a=Ww(t,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=Le(n,c);OM(e,se(u))||(a=Ww(t,a,u,l,i,s,o))}),a}function FM(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Kw(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;oe(n)?l=r:l=new Wt(null).setTree(n,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=FM(t,f,h);c=up(t,c,new we(d),p,i,s,o,a)}}),l.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=FM(t,p,h);c=up(t,c,new we(d),g,i,s,o,a)}}),c}function UH(t,e,n,r,i,s,o){if(lp(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(oe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return up(t,e,n,c.getNode().getChild(n),i,s,a,o);if(oe(n)){let l=new Wt(null);return c.getNode().forEachChild(gr,(u,d)=>{l=l.set(new we(u),d)}),Kw(t,e,n,l,i,s,a,o)}else return e}else{let l=new Wt(null);return r.foreach((u,d)=>{let h=Le(n,u);c.isCompleteForPath(h)&&(l=l.set(u,c.getNode().getChild(h)))}),Kw(t,e,n,l,i,s,a,o)}}function BH(t,e,n,r,i){let s=e.serverCache,o=wR(e,s.getNode(),s.isFullyInitialized()||oe(n),s.isFiltered());return SR(t,o,n,r,TR,i)}function $H(t,e,n,r,i,s){let o;if(lp(r,n)!=null)return e;{let a=new zl(r,e,i),c=e.eventCache.getNode(),l;if(oe(n)||se(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=cp(r,Us(e));else{let d=e.serverCache.getNode();T(d instanceof J,"serverChildren would be complete if leaf node"),u=AE(r,d)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=se(n),d=xE(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=t.filter.updateChild(c,u,d,Ae(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,J.EMPTY_NODE,Ae(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=cp(r,Us(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||lp(r,ve())!=null,Ol(e,l,o,t.filter.filtersNodes())}}var Qw=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new ql(r.getIndex()),s=lH(r);this.processor_=OH(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(J.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(J.EMPTY_NODE,a.getNode(),null),u=new yr(c,o.isFullyInitialized(),i.filtersNodes()),d=new yr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Dp(d,u),this.eventGenerator_=new Bw(this.query_)}get query(){return this.query_}};function qH(t){return t.viewCache_.serverCache.getNode()}function HH(t){return ap(t.viewCache_)}function GH(t,e){let n=Us(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!oe(e)&&!n.getImmediateChild(se(e)).isEmpty())?n.getChild(e):null}function LM(t){return t.eventRegistrations_.length===0}function zH(t,e){t.eventRegistrations_.push(e)}function VM(t,e,n){let r=[];if(n){T(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function jM(t,e,n,r){e.type===pr.MERGE&&e.source.queryId!==null&&(T(Us(t.viewCache_),"We should always have a full cache before handling merges"),T(ap(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=LH(t.processor_,i,e,n,r);return FH(t.processor_,s.viewCache),T(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,AR(t,s.changes,s.viewCache.eventCache.getNode(),null)}function WH(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ne,(s,o)=>{r.push(Sa(s,o))}),n.isFullyInitialized()&&r.push(vR(n.getNode())),AR(t,r,n.getNode(),e)}function AR(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return yH(t.eventGenerator_,e,n,i)}var dp,hp=class{constructor(){this.views=new Map}};function KH(t){T(!dp,"__referenceConstructor has already been defined"),dp=t}function QH(){return T(dp,"Reference.ts has not been loaded"),dp}function YH(t){return t.views.size===0}function ME(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return T(s!=null,"SyncTree gave us an op for an invalid query."),jM(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(jM(o,e,n,r));return s}}function xR(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=cp(n,i?r:null),c=!1;a?c=!0:r instanceof J?(a=AE(n,r),c=!1):(a=J.EMPTY_NODE,c=!1);let l=Dp(new yr(a,c,!1),new yr(r,i,!1));return new Qw(e,l)}return o}function ZH(t,e,n,r,i,s){let o=xR(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),zH(o,n),WH(o,n)}function XH(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Ni(t);if(i==="default")for(let[c,l]of t.views.entries())o=o.concat(VM(l,n,r)),LM(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(i);c&&(o=o.concat(VM(c,n,r)),LM(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Ni(t)&&s.push(new(QH())(e._repo,e._path)),{removed:s,events:o}}function MR(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function xi(t,e){let n=null;for(let r of t.views.values())n=n||GH(r,e);return n}function RR(t,e){if(e._queryParams.loadsAllData())return Tp(t);{let r=e._queryIdentifier;return t.views.get(r)}}function NR(t,e){return RR(t,e)!=null}function Ni(t){return Tp(t)!=null}function Tp(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var fp;function JH(t){T(!fp,"__referenceConstructor has already been defined"),fp=t}function eG(){return T(fp,"Reference.ts has not been loaded"),fp}var tG=1,pp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Wt(null),this.pendingWriteTree_=PH(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function RE(t,e,n,r,i){return EH(t.pendingWriteTree_,e,n,r,i),i?ka(t,new Aa(bE(),e,n)):[]}function nG(t,e,n,r){IH(t.pendingWriteTree_,e,n,r);let i=Wt.fromObject(n);return ka(t,new Gl(bE(),e,i))}function Si(t,e,n=!1){let r=CH(t.pendingWriteTree_,e);if(DH(t.pendingWriteTree_,e)){let s=new Wt(null);return r.snap!=null?s=s.set(ve(),!0):yt(r.children,o=>{s=s.set(new we(o),!0)}),ka(t,new Uw(r.path,s,n))}else return[]}function tu(t,e,n){return ka(t,new Aa(TE(),e,n))}function rG(t,e,n){let r=Wt.fromObject(n);return ka(t,new Gl(TE(),e,r))}function iG(t,e){return ka(t,new op(TE(),e))}function sG(t,e,n){let r=NE(t,n);if(r){let i=PE(r),s=i.path,o=i.queryId,a=zt(s,e),c=new op(SE(o),a);return kE(t,s,c)}else return[]}function gp(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||NR(o,e))){let c=XH(o,e,n,r);YH(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Ni(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=cG(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,w=FR(t,g);t.listenProvider_.startListening(Ll(m),Wl(t,m),w.hashFn,w.onComplete)}}}!d&&l.length>0&&!r&&(u?t.listenProvider_.stopListening(Ll(e),null):l.forEach(h=>{let f=t.queryToTagMap.get(Ap(h));t.listenProvider_.stopListening(Ll(h),f)}))}lG(t,l)}return a}function PR(t,e,n,r){let i=NE(t,r);if(i!=null){let s=PE(i),o=s.path,a=s.queryId,c=zt(o,e),l=new Aa(SE(a),c,n);return kE(t,o,l)}else return[]}function oG(t,e,n,r){let i=NE(t,r);if(i){let s=PE(i),o=s.path,a=s.queryId,c=zt(o,e),l=Wt.fromObject(n),u=new Gl(SE(a),c,l);return kE(t,o,u)}else return[]}function Yw(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=zt(h,i);s=s||xi(f,p),o=o||Ni(f)});let a=t.syncPointTree_.get(i);a?(o=o||Ni(a),s=s||xi(a,ve())):(a=new hp,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=J.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=xi(p,ve());g&&(s=s.updateImmediateChild(f,g))}));let l=NR(a,e);if(!l&&!e._queryParams.loadsAllData()){let h=Ap(e);T(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=uG();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=bp(t.pendingWriteTree_,i),d=ZH(a,e,n,u,s,c);if(!l&&!o&&!r){let h=RR(a,e);d=d.concat(dG(t,e,h))}return d}function Sp(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=zt(o,e),l=xi(a,c);if(l)return l});return CR(i,e,s,n,!0)}function aG(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{let d=zt(l,n);r=r||xi(u,d)});let i=t.syncPointTree_.get(n);i?r=r||xi(i,ve()):(i=new hp,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new yr(r,!0,!1):null,a=bp(t.pendingWriteTree_,e._path),c=xR(i,e,a,s?o.getNode():J.EMPTY_NODE,s);return HH(c)}function ka(t,e){return kR(e,t.syncPointTree_,null,bp(t.pendingWriteTree_,ve()))}function kR(t,e,n,r){if(oe(t.path))return OR(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=xi(i,ve()));let s=[],o=se(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=DR(r,o);s=s.concat(kR(a,c,l,u))}return i&&(s=s.concat(ME(i,t,r,n))),s}}function OR(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=xi(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=DR(r,o),u=t.operationForChild(o);u&&(s=s.concat(OR(u,a,c,l)))}),i&&(s=s.concat(ME(i,t,r,n))),s}function FR(t,e){let n=e.query,r=Wl(t,n);return{hashFn:()=>(qH(e)||J.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?sG(t,n._path,r):iG(t,n._path);{let s=Eq(i,n);return gp(t,n,null,s)}}}}function Wl(t,e){let n=Ap(e);return t.queryToTagMap.get(n)}function Ap(t){return t._path.toString()+"$"+t._queryIdentifier}function NE(t,e){return t.tagToQueryMap.get(e)}function PE(t){let e=t.indexOf("$");return T(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function kE(t,e,n){let r=t.syncPointTree_.get(e);T(r,"Missing sync point for query tag that we're tracking");let i=bp(t.pendingWriteTree_,e);return ME(r,n,i,null)}function cG(t){return t.fold((e,n,r)=>{if(n&&Ni(n))return[Tp(n)];{let i=[];return n&&(i=MR(n)),yt(r,(s,o)=>{i=i.concat(o)}),i}})}function Ll(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(eG())(t._repo,t._path):t}function lG(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Ap(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function uG(){return tG++}function dG(t,e,n){let r=e._path,i=Wl(t,e),s=FR(t,n),o=t.listenProvider_.startListening(Ll(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)T(!Ni(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!oe(l)&&u&&Ni(u))return[Tp(u).query];{let h=[];return u&&(h=h.concat(MR(u).map(f=>f.query))),yt(d,(f,p)=>{h=h.concat(p)}),h}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(Ll(u),Wl(t,u))}}return o}var Zw=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},Xw=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Le(this.path_,e);return new t(this.syncTree_,n)}node(){return Sp(this.syncTree_,this.path_)}},hG=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},UM=function(t,e,n){if(!t||typeof t!="object")return t;if(T(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return fG(t[".sv"],e,n);if(typeof t[".sv"]=="object")return pG(t[".sv"],e);T(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},fG=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:T(!1,"Unexpected server value: "+t)}},pG=function(t,e,n){t.hasOwnProperty("increment")||T(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&T(!1,"Unexpected increment value: "+r);let i=e.node();if(T(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},LR=function(t,e,n,r){return FE(e,new Xw(n,t),r)},OE=function(t,e,n){return FE(t,new Zw(e),n)};function FE(t,e,n){let r=t.getPriority().val(),i=UM(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=UM(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new ba(a,Ue(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ba(i))),o.forEachChild(Ne,(a,c)=>{let l=FE(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Kl=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function xp(t,e){let n=e instanceof we?e:new we(e),r=t,i=se(n);for(;i!==null;){let s=ci(r.node.children,i)||{children:{},childCount:0};r=new Kl(i,r,s),n=Ae(n),i=se(n)}return r}function qs(t){return t.node.value}function LE(t,e){t.node.value=e,Jw(t)}function VR(t){return t.node.childCount>0}function gG(t){return qs(t)===void 0&&!VR(t)}function Mp(t,e){yt(t.node.children,(n,r)=>{e(new Kl(n,t,r))})}function jR(t,e,n,r){n&&!r&&e(t),Mp(t,i=>{jR(i,e,!0,r)}),n&&r&&e(t)}function mG(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function nu(t){return new we(t.parent===null?t.name:nu(t.parent)+"/"+t.name)}function Jw(t){t.parent!==null&&yG(t.parent,t.name,t)}function yG(t,e,n){let r=gG(n),i=En(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Jw(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Jw(t))}var _G=/[\[\].#$\/\u0000-\u001F\u007F]/,vG=/[\[\].#$\u0000-\u001F\u007F]/,uw=10*1024*1024,Rp=function(t){return typeof t=="string"&&t.length!==0&&!_G.test(t)},UR=function(t){return typeof t=="string"&&t.length!==0&&!vG.test(t)},wG=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),UR(t)},Ql=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Ip(t)||t&&typeof t=="object"&&En(t,".sv")},_r=function(t,e,n,r){r&&e===void 0||ru(en(t,"value"),e,n)},ru=function(t,e,n){let r=n instanceof we?new Cw(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ls(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ls(r)+" with contents = "+e.toString());if(Ip(e))throw new Error(t+"contains "+e.toString()+" "+Ls(r));if(typeof e=="string"&&e.length>uw/3&&qc(e)>uw)throw new Error(t+"contains a string greater than "+uw+" utf8 bytes "+Ls(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(yt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Rp(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ls(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Yq(r,o),ru(t,a,r),Zq(r)}),i&&s)throw new Error(t+' contains ".value" child '+Ls(r)+" in addition to actual children.")}},EG=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=jl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Rp(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Qq);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&xn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},BR=function(t,e,n,r){if(r&&e===void 0)return;let i=en(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];yt(e,(o,a)=>{let c=new we(o);if(ru(i,a,Le(n,c)),wE(c)===".priority"&&!Ql(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),EG(i,s)},VE=function(t,e,n){if(!(n&&e===void 0)){if(Ip(e))throw new Error(en(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ql(e))throw new Error(en(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},iu=function(t,e,n,r){if(!(r&&n===void 0)&&!Rp(n))throw new Error(en(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Oa=function(t,e,n,r){if(!(r&&n===void 0)&&!UR(n))throw new Error(en(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},IG=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Oa(t,e,n,r)},fn=function(t,e){if(se(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},$R=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Rp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!wG(n))throw new Error(en(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var eE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Np(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!EE(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function qR(t,e,n){Np(t,n),HR(t,r=>EE(r,e))}function pn(t,e,n){Np(t,n),HR(t,r=>xn(r,e)||xn(e,r))}function HR(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(CG(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function CG(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();js&&mt("event: "+n.toString()),Na(r)}}}var GR="repo_interrupt",DG=25,tE=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new eE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sp(),this.transactionQueueTree_=new Kl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function bG(t,e,n){if(t.stats_=vE(t.repoInfo_),t.forceRestClient_||bq())t.server_=new kw(t.repoInfo_,(r,i,s,o)=>{BM(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>$M(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new IE(t.repoInfo_,e,(r,i,s,o)=>{BM(t,r,i,s,o)},r=>{$M(t,r)},r=>{TG(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Sq(t.repoInfo_,()=>new jw(t.stats_,t.server_)),t.infoData_=new Ow,t.infoSyncTree_=new pp({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=tu(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),jE(t,"connected",!1),t.serverSyncTree_=new pp({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);pn(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function zR(t){let n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function su(t){return hG({timestamp:zR(t)})}function BM(t,e,n,r,i){t.dataUpdateCount++;let s=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=$c(n,l=>Ue(l));o=oG(t.serverSyncTree_,s,c,i)}else{let c=Ue(n);o=PR(t.serverSyncTree_,s,c,i)}else if(r){let c=$c(n,l=>Ue(l));o=rG(t.serverSyncTree_,s,c)}else{let c=Ue(n);o=tu(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Ma(t,s)),pn(t.eventQueue_,a,o)}function $M(t,e){jE(t,"connected",e),e===!1&&xG(t)}function TG(t,e){yt(e,(n,r)=>{jE(t,n,r)})}function jE(t,e,n){let r=new we("/.info/"+e),i=Ue(n);t.infoData_.updateSnapshot(r,i);let s=tu(t.infoSyncTree_,r,i);pn(t.eventQueue_,r,s)}function Pp(t){return t.nextWriteId_++}function SG(t,e,n){let r=aG(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ue(i).withIndex(e._queryParams.getIndex());Yw(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=tu(t.serverSyncTree_,e._path,s);else{let a=Wl(t.serverSyncTree_,e);o=PR(t.serverSyncTree_,e._path,s,a)}return pn(t.eventQueue_,e._path,o),gp(t.serverSyncTree_,e,n,null,!0),s},i=>(Fa(t,"get for query "+et(e)+" failed: "+i),Promise.reject(new Error(i))))}function UE(t,e,n,r,i){Fa(t,"set",{path:e.toString(),value:n,priority:r});let s=su(t),o=Ue(n,r),a=Sp(t.serverSyncTree_,e),c=OE(o,a,s),l=Pp(t),u=RE(t.serverSyncTree_,e,c,l,!0);Np(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||kt("set at "+e+" failed: "+h);let g=Si(t.serverSyncTree_,l,!p);pn(t.eventQueue_,e,g),Pi(t,i,h,f)});let d=$E(t,e);Ma(t,d),pn(t.eventQueue_,d,[])}function AG(t,e,n,r){Fa(t,"update",{path:e.toString(),value:n});let i=!0,s=su(t),o={};if(yt(n,(a,c)=>{i=!1,o[a]=LR(Le(e,a),Ue(c),t.serverSyncTree_,s)}),i)mt("update() called with empty data.  Don't do anything."),Pi(t,r,"ok",void 0);else{let a=Pp(t),c=nG(t.serverSyncTree_,e,o,a);Np(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{let d=l==="ok";d||kt("update at "+e+" failed: "+l);let h=Si(t.serverSyncTree_,a,!d),f=h.length>0?Ma(t,e):e;pn(t.eventQueue_,f,h),Pi(t,r,l,u)}),yt(n,l=>{let u=$E(t,Le(e,l));Ma(t,u)}),pn(t.eventQueue_,e,[])}}function xG(t){Fa(t,"onDisconnectEvents");let e=su(t),n=sp();Lw(t.onDisconnect_,ve(),(i,s)=>{let o=LR(i,s,t.serverSyncTree_,e);Pa(n,i,o)});let r=[];Lw(n,ve(),(i,s)=>{r=r.concat(tu(t.serverSyncTree_,i,s));let o=$E(t,i);Ma(t,o)}),t.onDisconnect_=sp(),pn(t.eventQueue_,ve(),r)}function MG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&Fw(t.onDisconnect_,e),Pi(t,n,r,i)})}function qM(t,e,n,r){let i=Ue(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Pa(t.onDisconnect_,e,i),Pi(t,r,s,o)})}function RG(t,e,n,r,i){let s=Ue(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Pa(t.onDisconnect_,e,s),Pi(t,i,o,a)})}function NG(t,e,n,r){if(Yd(n)){mt("onDisconnect().update() called with empty data.  Don't do anything."),Pi(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&yt(n,(o,a)=>{let c=Ue(a);Pa(t.onDisconnect_,Le(e,o),c)}),Pi(t,r,i,s)})}function PG(t,e,n){let r;se(e._path)===".info"?r=Yw(t.infoSyncTree_,e,n):r=Yw(t.serverSyncTree_,e,n),qR(t.eventQueue_,e._path,r)}function nE(t,e,n){let r;se(e._path)===".info"?r=gp(t.infoSyncTree_,e,n):r=gp(t.serverSyncTree_,e,n),qR(t.eventQueue_,e._path,r)}function WR(t){t.persistentConnection_&&t.persistentConnection_.interrupt(GR)}function kG(t){t.persistentConnection_&&t.persistentConnection_.resume(GR)}function Fa(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),mt(n,...e)}function Pi(t,e,n,r){e&&Na(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function OG(t,e,n,r,i,s){Fa(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:zM(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=BE(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{ru("transaction failed: Data returned ",c,o.path),o.status=0;let l=xp(t.transactionQueueTree_,e),u=qs(l)||[];u.push(o),LE(l,u);let d;typeof c=="object"&&c!==null&&En(c,".priority")?(d=ci(c,".priority"),T(Ql(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Sp(t.serverSyncTree_,e)||J.EMPTY_NODE).getPriority().val();let h=su(t),f=Ue(c,d),p=OE(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Pp(t);let g=RE(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);pn(t.eventQueue_,e,g),kp(t,t.transactionQueueTree_)}}function BE(t,e,n){return Sp(t.serverSyncTree_,e,n)||J.EMPTY_NODE}function kp(t,e=t.transactionQueueTree_){if(e||Op(t,e),qs(e)){let n=QR(t,e);T(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&FG(t,nu(e),n)}else VR(e)&&Mp(e,n=>{kp(t,n)})}function FG(t,e,n){let r=n.map(l=>l.currentWriteId),i=BE(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let u=n[l];T(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=zt(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{Fa(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(Si(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Op(t,xp(t.transactionQueueTree_,e)),kp(t,t.transactionQueueTree_),pn(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Na(d[h])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{kt("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}Ma(t,e)}},o)}function Ma(t,e){let n=KR(t,e),r=nu(n),i=QR(t,n);return LG(t,i,r),r}function LG(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=zt(n,c.path),u=!1,d;if(T(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,i=i.concat(Si(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=DG)u=!0,d="maxretry",i=i.concat(Si(t.serverSyncTree_,c.currentWriteId,!0));else{let h=BE(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){ru("transaction failed: Data returned ",f,c.path);let p=Ue(f);typeof f=="object"&&f!=null&&En(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=c.currentWriteId,w=su(t),O=OE(p,h,w);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=O,c.currentWriteId=Pp(t),o.splice(o.indexOf(m),1),i=i.concat(RE(t.serverSyncTree_,c.path,O,c.currentWriteId,c.applyLocally)),i=i.concat(Si(t.serverSyncTree_,m,!0))}else u=!0,d="nodata",i=i.concat(Si(t.serverSyncTree_,c.currentWriteId,!0))}pn(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Op(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Na(r[a]);kp(t,t.transactionQueueTree_)}function KR(t,e){let n,r=t.transactionQueueTree_;for(n=se(e);n!==null&&qs(r)===void 0;)r=xp(r,n),e=Ae(e),n=se(e);return r}function QR(t,e){let n=[];return YR(t,e,n),n.sort((r,i)=>r.order-i.order),n}function YR(t,e,n){let r=qs(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Mp(e,i=>{YR(t,i,n)})}function Op(t,e){let n=qs(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,LE(e,n.length>0?n:void 0)}Mp(e,r=>{Op(t,r)})}function $E(t,e){let n=nu(KR(t,e)),r=xp(t.transactionQueueTree_,e);return mG(r,i=>{dw(t,i)}),dw(t,r),jR(r,i=>{dw(t,i)}),n}function dw(t,e){let n=qs(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(T(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(T(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Si(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?LE(e,void 0):n.length=s+1,pn(t.eventQueue_,nu(e),i);for(let o=0;o<r.length;o++)Na(r[o])}}function VG(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function jG(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):kt(`Invalid query segment '${n}' in query '${t}'`)}return e}var rE=function(t,e){let n=UG(t),r=n.namespace;n.domain==="firebase.com"&&mr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&mr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||mq();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Zf(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new we(n.pathString)}},UG=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=VG(t.substring(u,d)));let h=jG(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var HM="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",BG=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=HM.charAt(n%64),n=Math.floor(n/64);T(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=HM.charAt(e[i]);return T(o.length===20,"nextPushId: Length should be 20."),o}}();var mp=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+et(this.snapshot.exportVal())}},yp=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Yl=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return T(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var _p=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new pt;return MG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){fn("OnDisconnect.remove",this._path);let e=new pt;return qM(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){fn("OnDisconnect.set",this._path),_r("OnDisconnect.set",e,this._path,!1);let n=new pt;return qM(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){fn("OnDisconnect.setWithPriority",this._path),_r("OnDisconnect.setWithPriority",e,this._path,!1),VE("OnDisconnect.setWithPriority",n,!1);let r=new pt;return RG(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){fn("OnDisconnect.update",this._path),BR("OnDisconnect.update",e,this._path,!1);let n=new pt;return NG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Kt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return oe(this._path)?null:wE(this._path)}get ref(){return new gn(this._repo,this._path)}get _queryIdentifier(){let e=MM(this._queryParams),n=_E(e);return n==="{}"?"default":n}get _queryObject(){return MM(this._queryParams)}isEqual(e){if(e=ue(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=EE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Kq(this._path)}};function Fp(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Oi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===gr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Mi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Qr)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ne){if(e!=null&&!Ql(e)||n!=null&&!Ql(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(T(t.getIndex()instanceof Ul||t.getIndex()===DE,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Lp(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var gn=class t extends Kt{constructor(e,n){super(e,n,new Hl,!1)}get parent(){let e=fR(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Ra=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new we(e),r=ki(this.ref,e);return new t(this._node.getChild(n),r,Ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,ki(this.ref,r),Ne)))}hasChild(e){let n=new we(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function qE(t,e){return t=ue(t),t._checkNotDeleted("ref"),e!==void 0?ki(t._root,e):t._root}function HE(t,e){t=ue(t),t._checkNotDeleted("refFromURL");let n=rE(e,t._repo.repoInfo_.nodeAdmin);$R("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&mr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),qE(t,n.path.toString())}function ki(t,e){return t=ue(t),se(t._path)===null?IG("child","path",e,!1):Oa("child","path",e,!1),new gn(t._repo,Le(t._path,e))}function ZR(t,e){t=ue(t),fn("push",t._path),_r("push",e,t._path,!0);let n=zR(t._repo),r=BG(n),i=ki(t,r),s=ki(t,r),o;return e!=null?o=Vp(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function XR(t){return fn("remove",t._path),Vp(t,null)}function Vp(t,e){t=ue(t),fn("set",t._path),_r("set",e,t._path,!1);let n=new pt;return UE(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function JR(t,e){t=ue(t),fn("setPriority",t._path),VE("setPriority",e,!1);let n=new pt;return UE(t._repo,Le(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function eN(t,e,n){if(fn("setWithPriority",t._path),_r("setWithPriority",e,t._path,!1),VE("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new pt;return UE(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function tN(t,e){BR("update",e,t._path,!1);let n=new pt;return AG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function nN(t){t=ue(t);let e=new Yl(()=>{}),n=new Zl(e);return SG(t._repo,t,n).then(r=>new Ra(r,new gn(t._repo,t._path),t._queryParams.getIndex()))}var Zl=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new mp("value",this,new Ra(e.snapshotNode,new gn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yp(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},vp=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yp(this,e,n):null}createEvent(e,n){T(e.childName!=null,"Child events should have a childName.");let r=ki(new gn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new mp(e.type,this,new Ra(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function ou(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,l=(u,d)=>{nE(t._repo,t,a),c(u,d)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new Yl(n,s||void 0),a=e==="value"?new Zl(o):new vp(e,o);return PG(t._repo,t,a),()=>nE(t._repo,t,a)}function jp(t,e,n,r){return ou(t,"value",e,n,r)}function GE(t,e,n,r){return ou(t,"child_added",e,n,r)}function zE(t,e,n,r){return ou(t,"child_changed",e,n,r)}function WE(t,e,n,r){return ou(t,"child_moved",e,n,r)}function KE(t,e,n,r){return ou(t,"child_removed",e,n,r)}function QE(t,e,n){let r=null,i=n?new Yl(n):null;e==="value"?r=new Zl(i):e&&(r=new vp(e,i)),nE(t._repo,t,r)}var mn=class{},wp=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){_r("endAt",this._value,e._path,!0);let n=Pw(e._queryParams,this._value,this._key);if(Lp(n),Oi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Kt(e._repo,e._path,n,e._orderByCalled)}};function rN(t,e){return iu("endAt","key",e,!0),new wp(t,e)}var iE=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){_r("endBefore",this._value,e._path,!1);let n=fH(e._queryParams,this._value,this._key);if(Lp(n),Oi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Kt(e._repo,e._path,n,e._orderByCalled)}};function iN(t,e){return iu("endBefore","key",e,!0),new iE(t,e)}var Ep=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){_r("startAt",this._value,e._path,!0);let n=Nw(e._queryParams,this._value,this._key);if(Lp(n),Oi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Kt(e._repo,e._path,n,e._orderByCalled)}};function sN(t=null,e){return iu("startAt","key",e,!0),new Ep(t,e)}var sE=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){_r("startAfter",this._value,e._path,!1);let n=hH(e._queryParams,this._value,this._key);if(Lp(n),Oi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Kt(e._repo,e._path,n,e._orderByCalled)}};function oN(t,e){return iu("startAfter","key",e,!0),new sE(t,e)}var oE=class extends mn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Kt(e._repo,e._path,uH(e._queryParams,this._limit),e._orderByCalled)}};function aN(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new oE(t)}var aE=class extends mn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Kt(e._repo,e._path,dH(e._queryParams,this._limit),e._orderByCalled)}};function cN(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new aE(t)}var cE=class extends mn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Fp(e,"orderByChild");let n=new we(this._path);if(oe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Ul(n),i=Cp(e._queryParams,r);return Oi(i),new Kt(e._repo,e._path,i,!0)}};function lN(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Oa("orderByChild","path",t,!1),new cE(t)}var lE=class extends mn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Fp(e,"orderByKey");let n=Cp(e._queryParams,gr);return Oi(n),new Kt(e._repo,e._path,n,!0)}};function uN(){return new lE}var uE=class extends mn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Fp(e,"orderByPriority");let n=Cp(e._queryParams,Ne);return Oi(n),new Kt(e._repo,e._path,n,!0)}};function dN(){return new uE}var dE=class extends mn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Fp(e,"orderByValue");let n=Cp(e._queryParams,DE);return Oi(n),new Kt(e._repo,e._path,n,!0)}};function hN(){return new dE}var hE=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(_r("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new wp(this._value,this._key)._apply(new Ep(this._value,this._key)._apply(e))}};function fN(t,e){return iu("equalTo","key",e,!0),new hE(t,e)}function Rn(t,...e){let n=ue(t);for(let r of e)n=r._apply(n);return n}KH(gn);JH(gn);var $G="FIREBASE_DATABASE_EMULATOR_HOST",fE={},qG=!1;function HG(t,e,n,r){t.repoInfo_=new Zf(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function YE(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||mr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),mt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=rE(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[$G]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=rE(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new kl(kl.OWNER):new yw(t.name,t.options,e);$R("Invalid Firebase Database URL",o),oe(o.path)||mr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=zG(a,t,u,new mw(t.name,n));return new pE(d,t)}function GG(t,e){let n=fE[e];(!n||n[t.key]!==t)&&mr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),WR(t),delete n[t.key]}function zG(t,e,n,r){let i=fE[e.name];i||(i={},fE[e.name]=i);let s=i[t.toURLString()];return s&&mr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new tE(t,qG,n,r),i[t.toURLString()]=s,s}var pE=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new gn(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(GG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&mr("Cannot call "+e+" on a deleted database.")}};function pN(){hR.IS_TRANSPORT_INITIALIZED&&kt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function gN(){pN(),Vl.forceDisallow()}function mN(){pN(),Ea.forceDisallow(),Vl.forceAllow()}function yN(t,e,n,r={}){t=ue(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&mr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&mr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new kl(kl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Wd(r.mockUserToken,t.app.options.projectId);s=new kl(o)}HG(i,e,n,s)}function _N(t){t=ue(t),t._checkNotDeleted("goOffline"),WR(t._repo)}function vN(t){t=ue(t),t._checkNotDeleted("goOnline"),kG(t._repo)}function wN(t,e){KM(t,e)}function WG(t){yE(Xd),ls(new ln("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return YE(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),jn(fM,pM,t),jn(fM,pM,"esm2017")}var KG={".sv":"timestamp"};function EN(){return KG}function IN(t){return{".sv":{increment:t}}}var gE=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function CN(t,e,n){var r;if(t=ue(t),fn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new pt,o=(c,l,u)=>{let d=null;c?s.reject(c):(d=new Ra(u,new gn(t._repo,t._path),Ne),s.resolve(new gE(l,d)))},a=jp(t,()=>{});return OG(t._repo,t._path,e,o,a,i),s.promise}IE.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};IE.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};WG();var QG="@firebase/database-compat",YG="1.0.3";var ZG=new li("@firebase/database-compat"),DN=function(t){let e="FIREBASE WARNING: "+t;ZG.warn(e)};var XG=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(en(t,e)+"must be a boolean.")},JG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(en(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var ZE=class{constructor(e){this._delegate=e}cancel(e){G("OnDisconnect.cancel",0,1,arguments.length),ut("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){G("OnDisconnect.remove",0,1,arguments.length),ut("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){G("OnDisconnect.set",1,2,arguments.length),ut("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("OnDisconnect.setWithPriority",2,3,arguments.length),ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(G("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,DN("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ut("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var XE=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return G("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Hs=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return G("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return G("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return G("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return G("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return G("DataSnapshot.child",0,1,arguments.length),e=String(e),Oa("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return G("DataSnapshot.hasChild",1,1,arguments.length),Oa("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return G("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return G("DataSnapshot.forEach",1,1,arguments.length),ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return G("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return G("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return G("DataSnapshot.ref",0,0,arguments.length),new Yr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Up=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;G("Query.on",2,4,arguments.length),ut("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(l,u)=>{n.call(o.context,new Hs(this.database,l),u)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return jp(this._delegate,a,c),n;case"child_added":return GE(this._delegate,a,c),n;case"child_removed":return KE(this._delegate,a,c),n;case"child_changed":return zE(this._delegate,a,c),n;case"child_moved":return WE(this._delegate,a,c),n;default:throw new Error(en("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(G("Query.off",0,3,arguments.length),JG("Query.off",e,!0),ut("Query.off","callback",n,!0),fy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,QE(this._delegate,e,i)}else QE(this._delegate,e)}get(){return nN(this._delegate).then(e=>new Hs(this.database,e))}once(e,n,r,i){G("Query.once",1,4,arguments.length),ut("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new pt,a=(l,u)=>{let d=new Hs(this.database,l);n&&n.call(s.context,d,u),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":jp(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":GE(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":KE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":zE(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":WE(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(en("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return G("Query.limitToFirst",1,1,arguments.length),new t(this.database,Rn(this._delegate,aN(e)))}limitToLast(e){return G("Query.limitToLast",1,1,arguments.length),new t(this.database,Rn(this._delegate,cN(e)))}orderByChild(e){return G("Query.orderByChild",1,1,arguments.length),new t(this.database,Rn(this._delegate,lN(e)))}orderByKey(){return G("Query.orderByKey",0,0,arguments.length),new t(this.database,Rn(this._delegate,uN()))}orderByPriority(){return G("Query.orderByPriority",0,0,arguments.length),new t(this.database,Rn(this._delegate,dN()))}orderByValue(){return G("Query.orderByValue",0,0,arguments.length),new t(this.database,Rn(this._delegate,hN()))}startAt(e=null,n){return G("Query.startAt",0,2,arguments.length),new t(this.database,Rn(this._delegate,sN(e,n)))}startAfter(e=null,n){return G("Query.startAfter",0,2,arguments.length),new t(this.database,Rn(this._delegate,oN(e,n)))}endAt(e=null,n){return G("Query.endAt",0,2,arguments.length),new t(this.database,Rn(this._delegate,rN(e,n)))}endBefore(e=null,n){return G("Query.endBefore",0,2,arguments.length),new t(this.database,Rn(this._delegate,iN(e,n)))}equalTo(e,n){return G("Query.equalTo",1,2,arguments.length),new t(this.database,Rn(this._delegate,fN(e,n)))}toString(){return G("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return G("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(G("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ut(e,"cancel",i.cancel,!0),i.context=r,fy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(en(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Yr(this.database,new gn(this._delegate._repo,this._delegate._path))}},Yr=class t extends Up{constructor(e,n){super(e,new Kt(n._repo,n._path,new Hl,!1)),this.database=e,this._delegate=n}getKey(){return G("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return G("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,ki(this._delegate,e))}getParent(){G("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return G("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){G("Reference.set",1,2,arguments.length),ut("Reference.set","onComplete",n,!0);let r=Vp(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(G("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,DN("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fn("Reference.update",this._delegate._path),ut("Reference.update","onComplete",n,!0);let r=tN(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("Reference.setWithPriority",2,3,arguments.length),ut("Reference.setWithPriority","onComplete",r,!0);let i=eN(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){G("Reference.remove",0,1,arguments.length),ut("Reference.remove","onComplete",e,!0);let n=XR(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){G("Reference.transaction",1,3,arguments.length),ut("Reference.transaction","transactionUpdate",e,!1),ut("Reference.transaction","onComplete",n,!0),XG("Reference.transaction","applyLocally",r,!0);let i=CN(this._delegate,e,{applyLocally:r}).then(s=>new XE(s.committed,new Hs(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){G("Reference.setPriority",1,2,arguments.length),ut("Reference.setPriority","onComplete",n,!0);let r=JR(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){G("Reference.push",0,2,arguments.length),ut("Reference.push","onComplete",n,!0);let r=ZR(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return fn("Reference.onDisconnect",this._delegate._path),new ZE(new _p(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Gs=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:gN,forceLongPolling:mN}}useEmulator(e,n,r={}){yN(this._delegate,e,n,r)}ref(e){if(G("database.ref",0,1,arguments.length),e instanceof Yr){let n=HE(this._delegate,e.toString());return new Yr(this,n)}else{let n=qE(this._delegate,e);return new Yr(this,n)}}refFromURL(e){G("database.refFromURL",1,1,arguments.length);let r=HE(this._delegate,e);return new Yr(this,r)}goOffline(){return G("database.goOffline",0,0,arguments.length),_N(this._delegate)}goOnline(){return G("database.goOnline",0,0,arguments.length),vN(this._delegate)}};Gs.ServerValue={TIMESTAMP:EN(),increment:t=>IN(t)};function ez({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){yE(n);let a=new py("database-standalone"),c=new Zd("auth-internal",a);c.setComponent(new ln("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Zd("app-check-internal",a),l.setComponent(new ln("app-check-internal",()=>i,"PRIVATE"))),{instance:new Gs(YE(t,c,l,e,o),t),namespace:s}}var tz=Object.freeze({__proto__:null,initStandalone:ez});var nz=Gs.ServerValue;function rz(t){t.INTERNAL.registerComponent(new ln("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Gs(i,r)},"PUBLIC").setServiceProps({Reference:Yr,Query:Up,Database:Gs,DataSnapshot:Hs,enableLogging:wN,INTERNAL:tz,ServerValue:nz}).setMultipleInstances(!0)),t.registerVersion(QG,YG)}rz(Ct);function au(t,e,n="on",r=ps){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Qc())}function iz(t){return typeof t=="string"}function sz(t){return typeof t.exportVal=="function"}function xN(t){return t==null}function MN(t){return typeof t.set=="function"}function bN(t,e){return MN(e)?e:t.ref(e)}function RN(t,e){if(iz(t))return e.stringCase();if(MN(t))return e.firebaseCase();if(sz(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function NN(t){return(xN(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function PN(t,e,n){e=NN(e);let r=e.map(i=>au(t,i,"on",n));return Ho(...r)}function oz(t,e,n){let r=PN(t,e).pipe(ir((i,s)=>[...i,s],[]));return cz(t,r,n)}function az(t,e){return au(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function cz(t,e,n){return az(t,n).pipe(Vy(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Fy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function TN(t,e){return function(r,i){return RN(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function lz(t){return function(n){return n?RN(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function uz(t,e,n){return au(t,"value","once",n).pipe(Me(r=>{let i=[U(r)];return e.forEach(s=>i.push(au(t,s,"on",n))),Ho(...i).pipe(ir(hz,[]))}),Wc())}function kN(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function dz(t,e){if(xN(e))return 0;{let n=kN(t,e);return n===-1?t.length:n+1}}function hz(t,e){let{payload:n,prevKey:r,key:i}=e,s=kN(t,i),o=dz(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let l={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,l],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function SN(t,e,n){return e=NN(e),uz(t,e,n)}function fz(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:TN(r,"update"),set:TN(r,"set"),push:i=>r.push(i),remove:lz(r),snapshotChanges(i){return SN(t,i,n).pipe(Ye)},stateChanges(i){return PN(t,i,n).pipe(Ye)},auditTrail(i){return oz(t,i,n).pipe(Ye)},valueChanges(i,s){return SN(t,i,n).pipe(j(a=>a.map(c=>s&&s.idField?le(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),Ye)}}}function AN(t,e){return function(){return au(t,"value","on",e)}}function pz(t,e){return{query:t,snapshotChanges(){return AN(t,e.schedulers.outsideAngular)().pipe(Ye)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return AN(t,e.schedulers.outsideAngular)().pipe(Ye,j(r=>r.payload.exists()?r.payload.val():null))}}}var gz=new N("angularfire2.realtimeDatabaseURL"),mz=new N("angularfire2.database.use-emulator"),yz=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.schedulers=a;let w=c,O=Fs(n,o,r);l&&Al(O,o,u,h,f,p,d,g),this.database=va(`${O.name}.database.${i}`,"AngularFireDatabase",O.name,()=>{let S=o.runOutsideAngular(()=>O.database(i||void 0));return w&&S.useEmulator(...w),S},[w])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>bN(this.database,n)),s=i;return r&&(s=r(i)),fz(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>bN(this.database,n));return pz(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(Di),E(bi,8),E(gz,8),E(gt),E(de),E(_a),E(mz,8),E(Kf,8),E(Il,8),E(Cl,8),E(Dl,8),E(bl,8),E(Tl,8),E(Sl,8),E(Kr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),ON=(()=>{class t{constructor(){Ct.registerVersion("angularfire",Os.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=$e({type:t});static \u0275inj=qe({providers:[yz]})}return t})();var FN={production:!1,firebaseConfig:{apiKey:"AIzaSyANRjC_04UQZRSeFwolwg5_JlvtPTd8AGQ",authDomain:"clientes-57199.firebaseapp.com",projectId:"clientes-57199",storageBucket:"clientes-57199.appspot.com",messagingSenderId:"855641413726",appId:"1:855641413726:web:51496e63bdf81a26087ccf"}};var re="primary",Iu=Symbol("RouteTitle"),rI=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Ba(t){return new rI(t)}function _z(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function vz(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!vr(t[n],e[n]))return!1;return!0}function vr(t,e){let n=t?iI(t):void 0,r=e?iI(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!GN(t[i],e[i]))return!1;return!0}function iI(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function GN(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function zN(t){return t.length>0?t[t.length-1]:null}function Ui(t){return Ry(t)?t:xs(t)?pe(Promise.resolve(t)):U(t)}var wz={exact:KN,subset:QN},WN={exact:Ez,subset:Iz,ignored:()=>!0};function LN(t,e,n){return wz[n.paths](t.root,e.root,n.matrixParams)&&WN[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Ez(t,e){return vr(t,e)}function KN(t,e,n){if(!Ws(t.segments,e.segments)||!qp(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!KN(t.children[r],e.children[r],n))return!1;return!0}function Iz(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>GN(t[n],e[n]))}function QN(t,e,n){return YN(t,e,e.segments,n)}function YN(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ws(i,n)||e.hasChildren()||!qp(i,n,r))}else if(t.segments.length===n.length){if(!Ws(t.segments,n)||!qp(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!QN(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ws(t.segments,i)||!qp(t.segments,i,r)||!t.children[re]?!1:YN(t.children[re],e,s,r)}}function qp(t,e,n){return e.every((r,i)=>WN[n](t[i].parameters,r.parameters))}var Fi=class{constructor(e=new Ce([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ba(this.queryParams),this._queryParamMap}toString(){return bz.serialize(this)}},Ce=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Hp(this)}},zs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Ba(this.parameters),this._parameterMap}toString(){return XN(this)}};function Cz(t,e){return Ws(t,e)&&t.every((n,r)=>vr(n.parameters,e[r].parameters))}function Ws(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function Dz(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===re&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==re&&(n=n.concat(e(i,r)))}),n}var Cu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new pu,providedIn:"root"});let t=e;return t})(),pu=class{parse(e){let n=new oI(e);return new Fi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${cu(e.root,!0)}`,r=Az(e.queryParams),i=typeof e.fragment=="string"?`#${Tz(e.fragment)}`:"";return`${n}${r}${i}`}},bz=new pu;function Hp(t){return t.segments.map(e=>XN(e)).join("/")}function cu(t,e){if(!t.hasChildren())return Hp(t);if(e){let n=t.children[re]?cu(t.children[re],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==re&&r.push(`${i}:${cu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Dz(t,(r,i)=>i===re?[cu(t.children[re],!1)]:[`${i}:${cu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[re]!=null?`${Hp(t)}/${n[0]}`:`${Hp(t)}/(${n.join("//")})`}}function ZN(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Bp(t){return ZN(t).replace(/%3B/gi,";")}function Tz(t){return encodeURI(t)}function sI(t){return ZN(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gp(t){return decodeURIComponent(t)}function VN(t){return Gp(t.replace(/\+/g,"%20"))}function XN(t){return`${sI(t.path)}${Sz(t.parameters)}`}function Sz(t){return Object.entries(t).map(([e,n])=>`;${sI(e)}=${sI(n)}`).join("")}function Az(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Bp(n)}=${Bp(i)}`).join("&"):`${Bp(n)}=${Bp(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var xz=/^[^\/()?;#]+/;function JE(t){let e=t.match(xz);return e?e[0]:""}var Mz=/^[^\/()?;=#]+/;function Rz(t){let e=t.match(Mz);return e?e[0]:""}var Nz=/^[^=?&#]+/;function Pz(t){let e=t.match(Nz);return e?e[0]:""}var kz=/^[^&#]+/;function Oz(t){let e=t.match(kz);return e?e[0]:""}var oI=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ce([],{}):new Ce([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[re]=new Ce(e,n)),r}parseSegment(){let e=JE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new zs(Gp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Rz(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=JE(this.remaining);i&&(r=i,this.capture(r))}e[Gp(n)]=Gp(r)}parseQueryParam(e){let n=Pz(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=Oz(this.remaining);o&&(r=o,this.capture(r))}let i=VN(n),s=VN(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=JE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=re);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[re]:new Ce([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function JN(t){return t.segments.length>0?new Ce([],{[re]:t}):t}function eP(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=eP(i);if(r===re&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ce(t.segments,e);return Fz(n)}function Fz(t){if(t.numberOfChildren===1&&t.children[re]){let e=t.children[re];return new Ce(t.segments.concat(e.segments),e.children)}return t}function $a(t){return t instanceof Fi}function Lz(t,e,n=null,r=null){let i=tP(t);return nP(i,e,n,r)}function tP(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new Ce(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=JN(r);return e??i}function nP(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return eI(i,i,i,n,r);let s=Vz(e);if(s.toRoot())return eI(i,i,new Ce([],{}),n,r);let o=jz(s,i,t),a=o.processChildren?du(o.segmentGroup,o.index,s.commands):iP(o.segmentGroup,o.index,s.commands);return eI(i,o.segmentGroup,a,n,r)}function zp(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function gu(t){return typeof t=="object"&&t!=null&&t.outlets}function eI(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;t===e?o=n:o=rP(t,e,n);let a=JN(eP(o));return new Fi(a,s,i)}function rP(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=rP(s,e,n)}),new Ce(t.segments,r)}var Wp=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&zp(r[0]))throw new $(4003,!1);let i=r.find(gu);if(i&&i!==zN(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Vz(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Wp(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Wp(n,e,r)}var ja=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function jz(t,e,n){if(t.isAbsolute)return new ja(e,!0,0);if(!n)return new ja(e,!1,NaN);if(n.parent===null)return new ja(n,!0,0);let r=zp(t.commands[0])?0:1,i=n.segments.length-1+r;return Uz(n,i,t.numberOfDoubleDots)}function Uz(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new ja(r,!1,i-s)}function Bz(t){return gu(t[0])?t[0].outlets:{[re]:t}}function iP(t,e,n){if(t??=new Ce([],{}),t.segments.length===0&&t.hasChildren())return du(t,e,n);let r=$z(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ce(t.segments.slice(0,r.pathIndex),{});return s.children[re]=new Ce(t.segments.slice(r.pathIndex),t.children),du(s,0,i)}else return r.match&&i.length===0?new Ce(t.segments,{}):r.match&&!t.hasChildren()?aI(t,e,n):r.match?du(t,0,i):aI(t,e,n)}function du(t,e,n){if(n.length===0)return new Ce(t.segments,{});{let r=Bz(n),i={};if(Object.keys(r).some(s=>s!==re)&&t.children[re]&&t.numberOfChildren===1&&t.children[re].segments.length===0){let s=du(t.children[re],e,n);return new Ce(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=iP(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ce(t.segments,i)}}function $z(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(gu(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!UN(c,l,o))return s;r+=2}else{if(!UN(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function aI(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(gu(s)){let c=qz(s.outlets);return new Ce(r,c)}if(i===0&&zp(n[0])){let c=t.segments[e];r.push(new zs(c.path,jN(n[0]))),i++;continue}let o=gu(s)?s.outlets[re]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&zp(a)?(r.push(new zs(o,jN(a))),i+=2):(r.push(new zs(o,{})),i++)}return new Ce(r,{})}function qz(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=aI(new Ce([],{}),0,r))}),e}function jN(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function UN(t,e,n){return t==n.path&&vr(e,n.parameters)}var hu="imperative",_t=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(_t||{}),Pn=class{constructor(e,n){this.id=e,this.url=n}},qa=class extends Pn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=_t.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},wr=class extends Pn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=_t.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Nn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Nn||{}),Kp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Kp||{}),Li=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Vi=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationSkipped}},mu=class extends Pn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=_t.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Qp=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cI=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lI=class extends Pn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=_t.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},uI=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},dI=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hI=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},fI=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},pI=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gI=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mI=class{constructor(e){this.snapshot=e,this.type=_t.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yI=class{constructor(e){this.snapshot=e,this.type=_t.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yp=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=_t.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},yu=class{},_u=class{constructor(e){this.url=e}};var _I=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Du,this.attachRef=null}},Du=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new _I,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Zp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=vI(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=vI(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=wI(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return wI(e,this._root).map(n=>n.value)}};function vI(t,e){if(t===e.value)return e;for(let n of e.children){let r=vI(t,n);if(r)return r}return null}function wI(t,e){if(t===e.value)return[e];for(let n of e.children){let r=wI(t,n);if(r.length)return r.unshift(e),r}return[]}var yn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Va(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Xp=class extends Zp{constructor(e,n){super(e),this.snapshot=n,MI(this,e)}toString(){return this.snapshot.toString()}};function sP(t){let e=Hz(t),n=new bt([new zs("",{})]),r=new bt({}),i=new bt({}),s=new bt({}),o=new bt(""),a=new Ks(n,r,s,o,i,re,t,e.root);return a.snapshot=e.root,new Xp(new yn(a,[]),e)}function Hz(t){let e={},n={},r={},i="",s=new vu([],e,r,i,n,re,t,null,{});return new Jp("",new yn(s,[]))}var Ks=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(l=>l[Iu]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>Ba(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>Ba(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function xI(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&aP(i)&&(r.resolve[Iu]=i.title),r}var vu=class{get title(){return this.data?.[Iu]}constructor(e,n,r,i,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ba(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ba(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Jp=class extends Zp{constructor(e,n){super(n),this.url=e,MI(this,n)}toString(){return oP(this._root)}};function MI(t,e){e.value._routerState=t,e.children.forEach(n=>MI(t,n))}function oP(t){let e=t.children.length>0?` { ${t.children.map(oP).join(", ")} } `:"";return`${t.value}${e}`}function tI(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,vr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),vr(e.params,n.params)||t.paramsSubject.next(n.params),vz(e.url,n.url)||t.urlSubject.next(n.url),vr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function EI(t,e){let n=vr(t.params,e.params)&&Cz(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||EI(t.parent,e.parent))}function aP(t){return typeof t.title=="string"||t.title===null}var RI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=re,this.activateEvents=new ht,this.deactivateEvents=new ht,this.attachEvents=new ht,this.detachEvents=new ht,this.parentContexts=M(Du),this.location=M(ua),this.changeDetector=M(Rs),this.environmentInjector=M(qt),this.inputBinder=M(ig,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new II(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Tt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[bs]});let t=e;return t})(),II=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ks?this.route:e===Du?this.childContexts:this.parent.get(e,n)}},ig=new N(""),BN=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=zc([i.queryParams,i.params,i.data]).pipe(Me(([o,a,c],l)=>(c=A(A(A({},o),a),c),l===0?U(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=mx(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function Gz(t,e,n){let r=wu(t,e._root,n?n._root:void 0);return new Xp(r,e)}function wu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=zz(t,e,n);return new yn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>wu(t,a)),o}}let r=Wz(e.value),i=e.children.map(s=>wu(t,s));return new yn(r,i)}}function zz(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return wu(t,r,i);return wu(t,r)})}function Wz(t){return new Ks(new bt(t.url),new bt(t.params),new bt(t.queryParams),new bt(t.fragment),new bt(t.data),t.outlet,t.component,t)}var cP="ngNavigationCancelingError";function lP(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=$a(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=uP(!1,Nn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function uP(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[cP]=!0,n.cancellationCode=e,n}function Kz(t){return dP(t)&&$a(t.url)}function dP(t){return!!t&&t[cP]}var Qz=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["ng-component"]],standalone:!0,features:[sx],decls:1,vars:0,template:function(i,s){i&1&&it(0,"router-outlet")},dependencies:[RI],encapsulation:2});let t=e;return t})();function Yz(t,e){return t.providers&&!t._injector&&(t._injector=Tf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function NI(t){let e=t.children&&t.children.map(NI),n=e?le(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==re&&(n.component=Qz),n}function Er(t){return t.outlet||re}function Zz(t,e){let n=t.filter(r=>Er(r)===e);return n.push(...t.filter(r=>Er(r)!==e)),n}function bu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Xz=(t,e,n,r)=>j(i=>(new CI(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),CI=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),tI(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Va(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Va(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Va(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Va(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new yI(s.value.snapshot))}),e.children.length&&this.forwardEvent(new gI(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(tI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),tI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=bu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},eg=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ua=class{constructor(e,n){this.component=e,this.route=n}};function Jz(t,e,n){let r=t._root,i=e?e._root:null;return lu(r,i,n,[r.value])}function e3(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ga(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!FS(t)?t:e.get(t):r}function lu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Va(e);return t.children.forEach(o=>{t3(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>fu(a,n.getContext(o),i)),i}function t3(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=n3(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new eg(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?lu(t,e,a?a.children:null,r,i):lu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ua(a.outlet.component,o))}else o&&fu(e,a,i),i.canActivateChecks.push(new eg(r)),s.component?lu(t,null,a?a.children:null,r,i):lu(t,null,n,r,i);return i}function n3(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ws(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ws(t.url,e.url)||!vr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!EI(t,e)||!vr(t.queryParams,e.queryParams);case"paramsChange":default:return!EI(t,e)}}function fu(t,e,n){let r=Va(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?fu(o,e.children.getContext(s),n):fu(o,null,n):fu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ua(e.outlet.component,i)):n.canDeactivateChecks.push(new Ua(null,i)):n.canDeactivateChecks.push(new Ua(null,i))}function Tu(t){return typeof t=="function"}function r3(t){return typeof t=="boolean"}function i3(t){return t&&Tu(t.canLoad)}function s3(t){return t&&Tu(t.canActivate)}function o3(t){return t&&Tu(t.canActivateChild)}function a3(t){return t&&Tu(t.canDeactivate)}function c3(t){return t&&Tu(t.canMatch)}function hP(t){return t instanceof Fr||t?.name==="EmptyError"}var $p=Symbol("INITIAL_VALUE");function Ha(){return Me(t=>zc(t.map(e=>e.pipe(Vr(1),gs($p)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===$p)return $p;if(n===!1||n instanceof Fi)return n}return!0}),dt(e=>e!==$p),Vr(1)))}function l3(t,e){return nt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(le(A({},n),{guardsResult:!0})):u3(o,r,i,t).pipe(nt(a=>a&&r3(a)?d3(r,s,t,e):U(a)),j(a=>le(A({},n),{guardsResult:a})))})}function u3(t,e,n,r){return pe(t).pipe(nt(i=>m3(i.component,i.route,n,e,r)),Dn(i=>i!==!0,!0))}function d3(t,e,n,r){return pe(e).pipe(Lr(i=>qo(f3(i.route.parent,r),h3(i.route,r),g3(t,i.path,n),p3(t,i.route,n))),Dn(i=>i!==!0,!0))}function h3(t,e){return t!==null&&e&&e(new mI(t)),U(!0)}function f3(t,e){return t!==null&&e&&e(new pI(t)),U(!0)}function p3(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>Ih(()=>{let o=bu(e)??n,a=Ga(s,o),c=s3(a)?a.canActivate(e,t):hr(o,()=>a(e,t));return Ui(c).pipe(Dn())}));return U(i).pipe(Ha())}function g3(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>e3(o)).filter(o=>o!==null).map(o=>Ih(()=>{let a=o.guards.map(c=>{let l=bu(o.node)??n,u=Ga(c,l),d=o3(u)?u.canActivateChild(r,t):hr(l,()=>u(r,t));return Ui(d).pipe(Dn())});return U(a).pipe(Ha())}));return U(s).pipe(Ha())}function m3(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let c=bu(e)??i,l=Ga(a,c),u=a3(l)?l.canDeactivate(t,e,n,r):hr(c,()=>l(t,e,n,r));return Ui(u).pipe(Dn())});return U(o).pipe(Ha())}function y3(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=Ga(o,t),c=i3(a)?a.canLoad(e,n):hr(t,()=>a(e,n));return Ui(c)});return U(s).pipe(Ha(),fP(r))}function fP(t){return by(Qe(e=>{if($a(e))throw lP(t,e)}),j(e=>e===!0))}function _3(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=Ga(o,t),c=c3(a)?a.canMatch(e,n):hr(t,()=>a(e,n));return Ui(c)});return U(s).pipe(Ha(),fP(r))}var Eu=class{constructor(e){this.segmentGroup=e||null}},tg=class extends Error{constructor(e){super(),this.urlTree=e}};function La(t){return $o(new Eu(t))}function v3(t){return $o(new $(4e3,!1))}function w3(t){return $o(uP(!1,Nn.GuardRejected))}var DI=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[re])return v3(e.redirectTo);i=i.children[re]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new tg(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Fi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ce(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},bI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function E3(t,e,n,r,i){let s=PI(t,e,n);return s.matched?(r=Yz(e,r),_3(r,e,n,i).pipe(j(o=>o===!0?s:A({},bI)))):U(s)}function PI(t,e,n){if(e.path==="**")return I3(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},bI):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||_z)(n,t,e);if(!i)return A({},bI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function I3(t){return{matched:!0,parameters:t.length>0?zN(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function $N(t,e,n,r){return n.length>0&&b3(t,n,r)?{segmentGroup:new Ce(e,D3(r,new Ce(n,t.children))),slicedSegments:[]}:n.length===0&&T3(t,n,r)?{segmentGroup:new Ce(t.segments,C3(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ce(t.segments,t.children),slicedSegments:n}}function C3(t,e,n,r){let i={};for(let s of n)if(sg(t,e,s)&&!r[Er(s)]){let o=new Ce([],{});i[Er(s)]=o}return A(A({},r),i)}function D3(t,e){let n={};n[re]=e;for(let r of t)if(r.path===""&&Er(r)!==re){let i=new Ce([],{});n[Er(r)]=i}return n}function b3(t,e,n){return n.some(r=>sg(t,e,r)&&Er(r)!==re)}function T3(t,e,n){return n.some(r=>sg(t,e,r))}function sg(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function S3(t,e,n,r){return Er(t)!==r&&(r===re||!sg(e,n,t))?!1:PI(e,t,n).matched}function A3(t,e,n){return e.length===0&&!t.children[n]}var TI=class{};function x3(t,e,n,r,i,s,o="emptyOnly"){return new SI(t,e,n,r,i,o,s).recognize()}var M3=31,SI=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new DI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=$N(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new vu([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},re,this.rootComponentType,null,{}),i=new yn(r,n),s=new Jp("",i),o=Lz(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,re).pipe(di(r=>{if(r instanceof tg)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Eu?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=xI(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof yn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return pe(i).pipe(Lr(s=>{let o=r.children[s],a=Zz(n,s);return this.processSegmentGroup(e,a,o,s)}),ir((s,o)=>(s.push(...o),s)),hi(null),ky(),nt(s=>{if(s===null)return La(r);let o=pP(s);return R3(o),U(o)}))}processSegment(e,n,r,i,s,o){return pe(n).pipe(Lr(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(di(c=>{if(c instanceof Eu)return U(null);throw c}))),Dn(a=>!!a),di(a=>{if(hP(a))return A3(r,i,s)?U(new TI):La(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return S3(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):La(i):La(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=PI(n,i,s);if(!a)return La(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>M3&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,d).pipe(nt(h=>this.processSegment(e,r,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=E3(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Me(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Me(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new vu(u,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,P3(r),Er(r),r.component??r._loadedComponent??null,r,k3(r)),{segmentGroup:p,slicedSegments:g}=$N(n,u,d,c);if(g.length===0&&p.hasChildren())return this.processChildren(l,c,p).pipe(j(w=>w===null?null:new yn(f,w)));if(c.length===0&&g.length===0)return U(new yn(f,[]));let m=Er(r)===s;return this.processSegment(l,c,p,g,m?re:s,!0).pipe(j(w=>new yn(f,w instanceof yn?[w]:[])))}))):La(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):y3(e,n,r,this.urlSerializer).pipe(nt(i=>i?this.configLoader.loadChildren(e,n).pipe(Qe(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):w3(n))):U({routes:[],injector:e})}};function R3(t){t.sort((e,n)=>e.value.outlet===re?-1:n.value.outlet===re?1:e.value.outlet.localeCompare(n.value.outlet))}function N3(t){let e=t.value.routeConfig;return e&&e.path===""}function pP(t){let e=[],n=new Set;for(let r of t){if(!N3(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=pP(r.children);e.push(new yn(r.value,i))}return e.filter(r=>!n.has(r))}function P3(t){return t.data||{}}function k3(t){return t.resolve||{}}function O3(t,e,n,r,i,s){return nt(o=>x3(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:c})=>le(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function F3(t,e){return nt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of gP(c))o.add(l);let a=0;return pe(o).pipe(Lr(c=>s.has(c)?L3(c,r,t,e):(c.data=xI(c,c.parent,t).resolve,U(void 0))),Qe(()=>a++),Go(1),nt(c=>a===o.size?U(n):tn))})}function gP(t){let e=t.children.map(n=>gP(n)).flat();return[t,...e]}function L3(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!aP(i)&&(s[Iu]=i.title),V3(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=xI(t,t.parent,n).resolve,null)))}function V3(t,e,n,r){let i=iI(t);if(i.length===0)return U({});let s={};return pe(i).pipe(nt(o=>j3(t[o],e,n,r).pipe(Dn(),Qe(a=>{s[o]=a}))),Go(1),Py(s),di(o=>hP(o)?tn:$o(o)))}function j3(t,e,n,r){let i=bu(e)??r,s=Ga(t,i),o=s.resolve?s.resolve(e,n):hr(i,()=>s(e,n));return Ui(o)}function nI(t){return Me(e=>{let n=t(e);return n?pe(n).pipe(j(()=>e)):U(e)})}var mP=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===re);return i}getResolvedTitleForRoute(r){return r.data[Iu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(U3),providedIn:"root"});let t=e;return t})(),U3=(()=>{let e=class e extends mP{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(Kx))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Su=new N("",{providedIn:"root",factory:()=>({})}),ng=new N(""),kI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=M(Pf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ui(r.loadComponent()).pipe(j(yP),Qe(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),fi(()=>{this.componentLoaders.delete(r)})),s=new Lo(i,()=>new tt).pipe(Fo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=B3(i,this.compiler,r,this.onLoadEndListener).pipe(fi(()=>{this.childrenLoaders.delete(i)})),a=new Lo(o,()=>new tt).pipe(Fo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function B3(t,e,n,r){return Ui(t.loadChildren()).pipe(j(yP),nt(i=>i instanceof ol||Array.isArray(i)?U(i):pe(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(ng,[],{optional:!0,self:!0}).flat()),{routes:o.map(NI),injector:s}}))}function $3(t){return t&&typeof t=="object"&&"default"in t}function yP(t){return $3(t)?t.default:t}var OI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(q3),providedIn:"root"});let t=e;return t})(),q3=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_P=new N(""),vP=new N("");function H3(t,e,n){let r=t.get(vP),i=t.get(Pt);return t.get(de).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),G3(t))),{onViewTransitionCreated:c}=r;return c&&hr(t,()=>c({transition:a,from:e,to:n})),o})}function G3(t){return new Promise(e=>{_v(e,{injector:t})})}var FI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new tt,this.transitionAbortSubject=new tt,this.configLoader=M(kI),this.environmentInjector=M(qt),this.urlSerializer=M(Cu),this.rootContexts=M(Du),this.location=M(ga),this.inputBindingEnabled=M(ig,{optional:!0})!==null,this.titleStrategy=M(mP),this.options=M(Su,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=M(OI),this.createViewTransition=M(_P,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new hI(s)),i=s=>this.events.next(new fI(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(le(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new bt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:hu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(dt(o=>o.id!==0),j(o=>le(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Me(o=>{this.currentTransition=o;let a=!1,c=!1;return U(o).pipe(Qe(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?le(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Me(l=>{let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Vi(l.id,this.urlSerializer.serialize(l.rawUrl),h,Kp.IgnoredSameUrlNavigation)),l.resolve(null),tn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return U(l).pipe(Me(h=>{let f=this.transitions?.getValue();return this.events.next(new qa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?tn:Promise.resolve(h)}),O3(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Qe(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=le(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Qp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=l,w=new qa(h,this.urlSerializer.serialize(f),p,g);this.events.next(w);let O=sP(this.rootComponentType).snapshot;return this.currentTransition=o=le(A({},l),{targetSnapshot:O,urlAfterRedirects:f,extras:le(A({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new Vi(l.id,this.urlSerializer.serialize(l.extractedUrl),h,Kp.IgnoredByUrlHandlingStrategy)),l.resolve(null),tn}}),Qe(l=>{let u=new cI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),j(l=>(this.currentTransition=o=le(A({},l),{guards:Jz(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),l3(this.environmentInjector,l=>this.events.next(l)),Qe(l=>{if(o.guardsResult=l.guardsResult,$a(l.guardsResult))throw lP(this.urlSerializer,l.guardsResult);let u=new lI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),dt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Nn.GuardRejected),!1)),nI(l=>{if(l.guards.canActivateChecks.length)return U(l).pipe(Qe(u=>{let d=new uI(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Me(u=>{let d=!1;return U(u).pipe(F3(this.paramsInheritanceStrategy,this.environmentInjector),Qe({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",Nn.NoDataFromResolver)}}))}),Qe(u=>{let d=new dI(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),nI(l=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Qe(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...u(f));return h};return zc(u(l.targetSnapshot.root)).pipe(hi(null),Vr(1))}),nI(()=>this.afterPreactivation()),Me(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return d?pe(d).pipe(j(()=>o)):U(o)}),j(l=>{let u=Gz(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=le(A({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),Qe(()=>{this.events.next(new yu)}),Xz(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Vr(1),Qe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new wr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Ly(this.transitionAbortSubject.pipe(Qe(l=>{throw l}))),fi(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Nn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),di(l=>{if(c=!0,dP(l))this.events.next(new Li(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),Kz(l)?this.events.next(new _u(l.url)):o.resolve(!1);else{this.events.next(new mu(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return tn}))}))}cancelNavigationTransition(r,i,s){let o=new Li(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function z3(t){return t!==hu}var W3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(K3),providedIn:"root"});let t=e;return t})(),AI=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},K3=(()=>{let e=class e extends AI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>M(Q3),providedIn:"root"});let t=e;return t})(),Q3=(()=>{let e=class e extends wP{constructor(){super(...arguments),this.location=M(ga),this.urlSerializer=M(Cu),this.options=M(Su,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=M(OI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=sP(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof qa)this.stateMemento=this.createStateMemento();else if(r instanceof Vi)this.rawUrlTree=i.initialUrl;else if(r instanceof Qp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof yu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Li&&(r.code===Nn.GuardRejected||r.code===Nn.NoDataFromResolver)?this.restoreHistory(i):r instanceof mu?this.restoreHistory(i,!0):r instanceof wr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(uu||{});function EP(t,e){t.events.pipe(dt(n=>n instanceof wr||n instanceof Li||n instanceof mu||n instanceof Vi),j(n=>n instanceof wr||n instanceof Vi?uu.COMPLETE:(n instanceof Li?n.code===Nn.Redirect||n.code===Nn.SupersededByNewNavigation:!1)?uu.REDIRECTING:uu.FAILED),dt(n=>n!==uu.REDIRECTING),Vr(1)).subscribe(()=>{e()})}function Y3(t){throw t}var Z3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},X3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ji=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=M(Af),this.stateManager=M(wP),this.options=M(Su,{optional:!0})||{},this.pendingTasks=M(Ss),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=M(FI),this.urlSerializer=M(Cu),this.location=M(ga),this.urlHandlingStrategy=M(OI),this._events=new tt,this.errorHandler=this.options.errorHandler||Y3,this.navigated=!1,this.routeReuseStrategy=M(W3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=M(ng,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!M(ig,{optional:!0}),this.eventsSubscription=new Ke,this.isNgZoneEnabled=M(de)instanceof de&&de.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Li&&i.code!==Nn.Redirect&&i.code!==Nn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof wr)this.navigated=!0;else if(i instanceof _u){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||z3(s.source)};this.scheduleNavigation(a,hu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}eW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=A({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(NI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=tP(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return nP(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=$a(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,hu,null,i)}navigate(r,i={skipLocationChange:!1}){return J3(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},Z3):i===!1?s=A({},X3):s=i,$a(r))return LN(this.currentUrlTree,r,s);let o=this.parseUrl(r);return LN(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((h,f)=>{c=h,l=f});let d=this.pendingTasks.add();return EP(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function J3(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function eW(t){return!(t instanceof yu)&&!(t instanceof _u)}var IP=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(u=>{u instanceof wr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:gA(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(ie(ji),ie(Ks),sv("tabindex"),ie(Hr),ie(dr),ie(Wr))},e.\u0275dir=Tt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&je("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Sf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[$t.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ns],skipLocationChange:[$t.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ns],replaceUrl:[$t.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ns],routerLink:"routerLink"},standalone:!0,features:[wv,bs]});let t=e;return t})();var rg=class{};var tW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(dt(r=>r instanceof wr),Lr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Tf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return pe(s).pipe(ui())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(nt(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return pe([o,a]).pipe(ui())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(ji),E(Pf),E(qt),E(rg),E(kI))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),CP=new N(""),nW=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof qa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof wr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Vi&&r.code===Kp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Yp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Yp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){AA()},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function rW(t){return t.routerState.root}function Au(t,e){return{\u0275kind:t,\u0275providers:e}}function iW(){let t=M(zn);return e=>{let n=t.get(Ms);if(e!==n.components[0])return;let r=t.get(ji),i=t.get(DP);t.get(LI)===1&&r.initialNavigation(),t.get(bP,null,ae.Optional)?.setUpPreloading(),t.get(CP,null,ae.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var DP=new N("",{factory:()=>new tt}),LI=new N("",{providedIn:"root",factory:()=>1});function sW(){return Au(2,[{provide:LI,useValue:0},{provide:Rf,multi:!0,deps:[zn],useFactory:e=>{let n=e.get(Cx,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(ji),s=e.get(DP);EP(i,()=>{r(!0)}),e.get(FI).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function oW(){return Au(3,[{provide:Rf,multi:!0,useFactory:()=>{let e=M(ji);return()=>{e.setUpLocationChangeListener()}}},{provide:LI,useValue:2}])}var bP=new N("");function aW(t){return Au(0,[{provide:bP,useExisting:tW},{provide:rg,useExisting:t}])}function cW(){return Au(8,[BN,{provide:ig,useExisting:BN}])}function lW(t){let e=[{provide:_P,useValue:H3},{provide:vP,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return Au(9,e)}var qN=new N("ROUTER_FORROOT_GUARD"),uW=[ga,{provide:Cu,useClass:pu},ji,Du,{provide:Ks,useFactory:rW,deps:[ji]},kI,[]],VI=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[uW,[],{provide:ng,multi:!0,useValue:r},{provide:qN,useFactory:pW,deps:[[ji,new la,new ev]]},{provide:Su,useValue:i||{}},i?.useHash?hW():fW(),dW(),i?.preloadingStrategy?aW(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?gW(i):[],i?.bindToComponentInputs?cW().\u0275providers:[],i?.enableViewTransitions?lW().\u0275providers:[],mW()]}}static forChild(r){return{ngModule:e,providers:[{provide:ng,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(qN,8))},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({});let t=e;return t})();function dW(){return{provide:CP,useFactory:()=>{let t=M(Sx),e=M(de),n=M(Su),r=M(FI),i=M(Cu);return n.scrollOffset&&t.setOffset(n.scrollOffset),new nW(i,r,t,e,n)}}}function hW(){return{provide:Wr,useClass:bx}}function fW(){return{provide:Wr,useClass:kv}}function pW(t){return"guarded"}function gW(t){return[t.initialNavigation==="disabled"?oW().\u0275providers:[],t.initialNavigation==="enabledBlocking"?sW().\u0275providers:[]]}var HN=new N("");function mW(){return[{provide:HN,useFactory:iW},{provide:Nf,multi:!0,useExisting:HN}]}var SP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-home"]],decls:3,vars:0,consts:[["id","sec0",1,"sec0"],["src","assets/img/pez.png","id","pez"],["src","assets/img/rocas.png","id","rocas"]],template:function(i,s){i&1&&(D(0,"section",0),it(1,"img",1)(2,"img",2),b())},styles:["section[_ngcontent-%COMP%]{width:100%;height:0vh;display:flex;justify-content:center;align-items:center;overflow:hidden;box-shadow:13px 13px 20px #b6b9bd,-13px -13px 20px #fff}section[_ngcontent-%COMP%]   #pez[_ngcontent-%COMP%], #rocas[_ngcontent-%COMP%], #paisaje[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;object-fit:cover;pointer-events:none;image-rendering:pixelated}section[_ngcontent-%COMP%]   img#paisaje[_ngcontent-%COMP%]{opacity:.5}section[_ngcontent-%COMP%]   img#pez[_ngcontent-%COMP%]{z-index:2;filter:drop-shadow(1.5px 1.5px 4px #040018)}section[_ngcontent-%COMP%]   img#rocas[_ngcontent-%COMP%]{z-index:1;filter:drop-shadow(3px 3px 8px #040018)}@media (max-width:767px){section[_ngcontent-%COMP%]   #pez[_ngcontent-%COMP%], #rocas[_ngcontent-%COMP%], #paisaje[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;height:50%;object-fit:cover;pointer-events:none;image-rendering:pixelated}}"]});let t=e;return t})();var AP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-about"]],decls:18,vars:0,consts:[["id","info",1,"info"],["id","info-logo"],["src","assets/img/unnamed.jpg","id","info-logo1"],["id","info-text"]],template:function(i,s){i&1&&(D(0,"div",0)(1,"div",1),it(2,"img",2),b(),D(3,"div",3)(4,"h1"),x(5,"Daniel Alberto Cruz Herrera"),b(),D(6,"h2"),x(7,"Desarrollo Web Profesional"),b(),D(8,"p"),x(9,"\xA0"),b(),D(10,"p"),x(11,"Why that's funny! My voice didn't come back to me. I'll try it again. Hello? Hello?! Oh my goodness! Now my singing voice is gone! My singing voice is gone! My singing voice is gone! My singing voice is gone! My singing voice is gone! My singing voice is gone! My singing voice is gone! My singing voice is\u2014"),b(),D(12,"p"),x(13,"\xA0"),b(),D(14,"h2"),x(15,"Contacto"),b(),D(16,"p"),x(17,"albertoch.ti21@utsjr.edu.mx"),b()()())},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;font-family:Lato,sans-serif;letter-spacing:.5px}@media (min-width:768px){*[_ngcontent-%COMP%]{box-sizing:border-box}.info[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:center;flex-direction:row;justify-content:space-evenly}#info-text[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;width:50%;height:450px;border-radius:25px}h1[_ngcontent-%COMP%]{font-size:50px}p[_ngcontent-%COMP%]{font-size:20px}#info-logo[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;width:400px;height:400px;border-radius:100%;box-shadow:13px 13px 20px #375e9433,-13px -13px 20px #fff6}#info-logo1[_ngcontent-%COMP%]{width:380px;height:380px;object-fit:fill;border-radius:100%;z-index:1}#choices[_ngcontent-%COMP%]{width:100%;height:160px;display:flex;justify-content:space-evenly}.box[_ngcontent-%COMP%]{display:flex;text-align:center;align-items:center;color:#000;width:160px;height:160px;border-radius:25px;cursor:pointer;position:relative;box-shadow:8px 8px 15px #a7aaaf,-8px -8px 15px #fff}}@media (max-width:767px){[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}body[_ngcontent-%COMP%]{height:auto;width:100%;background-color:#ecf0f3}header[_ngcontent-%COMP%]{background-color:#ecf0f3;position:fixed;top:0;left:0;width:100%;display:flex;flex-direction:row-reverse;align-items:center;height:50px;box-shadow:8px 8px 15px #0000002c,0 0 #fff;z-index:10}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:15px;padding-right:15px;height:50px;width:84px;z-index:5;background-color:#ecf0f3;box-shadow:0 0 #ecf0f3,-10px 0 10px #ecf0f3;clip-path:inset(0px 0px -1px -30px);position:2}header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:36.9px;width:54px}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{position:1;overflow:scroll;padding-right:15px;top:0;left:0;display:flex;align-items:center;height:50px;background-color:#ecf0f3}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul1[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul1[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;margin-left:20px}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul1[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;padding:6px 15px;color:#000;border-radius:20px}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul2[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;margin-left:20px;width:140px}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul2[_ngcontent-%COMP%]   #usuario[_ngcontent-%COMP%]{display:flex;list-style:none;text-decoration:none;cursor:pointer;width:100%}header[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .ul2[_ngcontent-%COMP%]   #usuario[_ngcontent-%COMP%]   #boton-usuario[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;padding:6px 15px;list-style:none;text-decoration:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.usuario[_ngcontent-%COMP%]   .desplegar1[_ngcontent-%COMP%]{width:140px;display:none;position:absolute;list-style:none;padding-top:10px;border-radius:20px;background-color:#ecf0f3;z-index:1;border:#ecf0f3 5px solid;box-shadow:inset 8px 8px 8px #cbced1,inset -8px -8px 8px #fff}.desplegar1[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;margin-left:10px;margin-right:10px}.desplegar1[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-decoration:none}.usuario[_ngcontent-%COMP%]:hover > .desplegar1[_ngcontent-%COMP%]{display:block}.boton[_ngcontent-%COMP%]{border-radius:25px;margin:0 auto;cursor:pointer;position:relative;font-size:15px;color:#000;background:#ecf0f3;box-shadow:3px 3px 8px #a7aaaf,-3px -3px 8px #fff}.boton[_ngcontent-%COMP%]:hover{box-shadow:inset 8px 8px 8px #cbced1,inset -8px -8px 8px #fff}.boton#active[_ngcontent-%COMP%]{cursor:default;box-shadow:inset 8px 8px 8px #cbced1,inset -8px -8px 8px #fff}.info[_ngcontent-%COMP%]{display:flex;background-color:unset;width:100vw;height:auto;flex-direction:column;align-items:center;justify-content:space-evenly}#info-logo[_ngcontent-%COMP%]{margin-top:75px;display:flex;align-items:center;justify-content:center;width:70vw;height:70vw;border-radius:100%;box-shadow:13px 13px 20px #cbced1,-13px -13px 20px #fff}#info-logo1[_ngcontent-%COMP%]{width:65vw;height:65vw;border-radius:100%;object-fit:cover}#info-text[_ngcontent-%COMP%]{margin-top:25px;display:flex;justify-content:center;flex-direction:column;width:80%;height:auto;border-radius:25px;text-align:justify;box-shadow:inset 8px 8px 8px #cbced1,inset -8px -8px 8px #fff;padding:15px}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{font-size:15px}#choices[_ngcontent-%COMP%]{width:100%;height:160px;display:flex;justify-content:space-evenly}.box[_ngcontent-%COMP%]{display:flex;text-align:center;align-items:center;color:#000;width:160px;height:160px;border-radius:25px;cursor:pointer;position:relative;box-shadow:8px 8px 15px #a7aaaf,-8px -8px 15px #fff}}"]});let t=e;return t})();var Qs=class{};var yW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zn={},P,oC=oC||{},Z=yW||self;function vg(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function $u(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function _W(t){return Object.prototype.hasOwnProperty.call(t,jI)&&t[jI]||(t[jI]=++vW)}var jI="closure_uid_"+(1e9*Math.random()>>>0),vW=0;function wW(t,e,n){return t.call.apply(t.bind,arguments)}function EW(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ot(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ot=wW:Ot=EW,Ot.apply(null,arguments)}function og(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function wt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Bi(){this.s=this.s,this.o=this.o}var IW=0;Bi.prototype.s=!1;Bi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),IW!=0)&&_W(this)};Bi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var BP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function aC(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function xP(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(vg(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Ft(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Ft.prototype.h=function(){this.defaultPrevented=!0};var CW=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Z.addEventListener("test",n,e),Z.removeEventListener("test",n,e)}catch{}return t}();function ku(t){return/^[\s\xa0]*$/.test(t)}function wg(){var t=Z.navigator;return t&&(t=t.userAgent)?t:""}function Ir(t){return wg().indexOf(t)!=-1}function cC(t){return cC[" "](t),t}cC[" "]=function(){};function DW(t,e){var n=h9;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var bW=Ir("Opera"),Qa=Ir("Trident")||Ir("MSIE"),$P=Ir("Edge"),HI=$P||Qa,qP=Ir("Gecko")&&!(wg().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge"))&&!(Ir("Trident")||Ir("MSIE"))&&!Ir("Edge"),TW=wg().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge");function HP(){var t=Z.document;return t?t.documentMode:void 0}var GI;e:{if(ag="",cg=function(){var t=wg();if(qP)return/rv:([^\);]+)(\)|;)/.exec(t);if($P)return/Edge\/([\d\.]+)/.exec(t);if(Qa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(TW)return/WebKit\/(\S+)/.exec(t);if(bW)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),cg&&(ag=cg?cg[1]:""),Qa&&(lg=HP(),lg!=null&&lg>parseFloat(ag))){GI=String(lg);break e}GI=ag}var ag,cg,lg,zI;Z.document&&Qa?(UI=HP(),zI=UI||parseInt(GI,10)||void 0):zI=void 0;var UI,SW=zI;function Ou(t,e){if(Ft.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qP){e:{try{cC(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:AW[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ou.$.h.call(this)}}wt(Ou,Ft);var AW={2:"touch",3:"pen",4:"mouse"};Ou.prototype.h=function(){Ou.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var qu="closure_listenable_"+(1e6*Math.random()|0),xW=0;function MW(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++xW,this.fa=this.ia=!1}function Eg(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function lC(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function RW(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function GP(t){let e={};for(let n in t)e[n]=t[n];return e}var MP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<MP.length;s++)n=MP[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ig(t){this.src=t,this.g={},this.h=0}Ig.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=KI(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new MW(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function WI(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=BP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Eg(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function KI(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var uC="closure_lm_"+(1e6*Math.random()|0),BI={};function WP(t,e,n,r,i){if(r&&r.once)return QP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)WP(t,e[s],n,r,i);return null}return n=fC(n),t&&t[qu]?t.O(e,n,$u(r)?!!r.capture:!!r,i):KP(t,e,n,!1,r,i)}function KP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=$u(i)?!!i.capture:!!i,a=hC(t);if(a||(t[uC]=a=new Ig(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=NW(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)CW||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ZP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function NW(){function t(n){return e.call(t.src,t.listener,n)}let e=PW;return t}function QP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)QP(t,e[s],n,r,i);return null}return n=fC(n),t&&t[qu]?t.P(e,n,$u(r)?!!r.capture:!!r,i):KP(t,e,n,!0,r,i)}function YP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)YP(t,e[s],n,r,i);else r=$u(r)?!!r.capture:!!r,n=fC(n),t&&t[qu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=KI(s,n,r,i),-1<n&&(Eg(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=hC(t))&&(e=t.g[e.toString()],t=-1,e&&(t=KI(e,n,r,i)),(n=-1<t?e[t]:null)&&dC(n))}function dC(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[qu])WI(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ZP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=hC(e))?(WI(n,t),n.h==0&&(n.src=null,e[uC]=null)):Eg(t)}}}function ZP(t){return t in BI?BI[t]:BI[t]="on"+t}function PW(t,e){if(t.fa)t=!0;else{e=new Ou(e,this);var n=t.listener,r=t.la||t.src;t.ia&&dC(t),t=n.call(r,e)}return t}function hC(t){return t=t[uC],t instanceof Ig?t:null}var $I="__closure_events_fn_"+(1e9*Math.random()>>>0);function fC(t){return typeof t=="function"?t:(t[$I]||(t[$I]=function(e){return t.handleEvent(e)}),t[$I])}function vt(){Bi.call(this),this.i=new Ig(this),this.S=this,this.J=null}wt(vt,Bi);vt.prototype[qu]=!0;vt.prototype.removeEventListener=function(t,e,n,r){YP(this,t,e,n,r)};function At(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Ft(e,t);else if(e instanceof Ft)e.target=e.target||t;else{var i=e;e=new Ft(r,t),zP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=ug(o,r,!0,e)&&i}if(o=e.g=t,i=ug(o,r,!0,e)&&i,i=ug(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=ug(o,r,!1,e)&&i}vt.prototype.N=function(){if(vt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Eg(n[r]);delete t.g[e],t.h--}}this.J=null};vt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};vt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function ug(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&WI(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var pC=Z.JSON.stringify,QI=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function kW(){var t=gC;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var YI=class{constructor(){this.h=this.g=null}add(e,n){let r=XP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},XP=new QI(()=>new ZI,t=>t.reset()),ZI=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function OW(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function FW(t){Z.setTimeout(()=>{throw t},0)}var Fu,Lu=!1,gC=new YI,JP=()=>{let t=Z.Promise.resolve(void 0);Fu=()=>{t.then(LW)}},LW=()=>{for(var t;t=kW();){try{t.h.call(t.g)}catch(n){FW(n)}var e=XP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Lu=!1};function Cg(t,e){vt.call(this),this.h=t||1,this.g=e||Z,this.j=Ot(this.qb,this),this.l=Date.now()}wt(Cg,vt);P=Cg.prototype;P.ga=!1;P.T=null;P.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),At(this,"tick"),this.ga&&(mC(this),this.start()))}};P.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function mC(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}P.N=function(){Cg.$.N.call(this),mC(this),delete this.g};function yC(t,e,n){if(typeof t=="function")n&&(t=Ot(t,n));else if(t&&typeof t.handleEvent=="function")t=Ot(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function ek(t){t.g=yC(()=>{t.g=null,t.i&&(t.i=!1,ek(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var XI=class extends Bi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ek(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Vu(t){Bi.call(this),this.h=t,this.g={}}wt(Vu,Bi);var RP=[];function tk(t,e,n,r){Array.isArray(n)||(n&&(RP[0]=n.toString()),n=RP);for(var i=0;i<n.length;i++){var s=WP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function nk(t){lC(t.g,function(e,n){this.g.hasOwnProperty(n)&&dC(e)},t),t.g={}}Vu.prototype.N=function(){Vu.$.N.call(this),nk(this)};Vu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Dg(){this.g=!0}Dg.prototype.Ea=function(){this.g=!1};function VW(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function jW(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Wa(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+BW(t,n)+(r?" "+r:"")})}function UW(t,e){t.info(function(){return"TIMEOUT: "+e})}Dg.prototype.info=function(){};function BW(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return pC(n)}catch{return e}}var Js={},NP=null;function bg(){return NP=NP||new vt}Js.Ta="serverreachability";function rk(t){Ft.call(this,Js.Ta,t)}wt(rk,Ft);function ju(t){let e=bg();At(e,new rk(e))}Js.STAT_EVENT="statevent";function ik(t,e){Ft.call(this,Js.STAT_EVENT,t),this.stat=e}wt(ik,Ft);function Qt(t){let e=bg();At(e,new ik(e,t))}Js.Ua="timingevent";function sk(t,e){Ft.call(this,Js.Ua,t),this.size=e}wt(sk,Ft);function Hu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){t()},e)}var Tg={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ok={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function _C(){}_C.prototype.h=null;function PP(t){return t.h||(t.h=t.i())}function ak(){}var Gu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function vC(){Ft.call(this,"d")}wt(vC,Ft);function wC(){Ft.call(this,"c")}wt(wC,Ft);var JI;function Sg(){}wt(Sg,_C);Sg.prototype.g=function(){return new XMLHttpRequest};Sg.prototype.i=function(){return{}};JI=new Sg;function zu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Vu(this),this.P=$W,t=HI?125:void 0,this.V=new Cg(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ck}function ck(){this.i=null,this.g="",this.h=!1}var $W=45e3,lk={},eC={};P=zu.prototype;P.setTimeout=function(t){this.P=t};function tC(t,e,n){t.L=1,t.A=xg(Xr(e)),t.u=n,t.S=!0,uk(t,null)}function uk(t,e){t.G=Date.now(),Wu(t),t.B=Xr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),_k(n.i,"t",r),t.o=0,n=t.l.J,t.h=new ck,t.g=jk(t.l,n?e:null,!t.u),0<t.O&&(t.M=new XI(Ot(t.Pa,t,t.g),t.O)),tk(t.U,t.g,"readystatechange",t.nb),e=t.I?GP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),ju(),VW(t.j,t.v,t.B,t.m,t.W,t.u)}P.nb=function(t){t=t.target;let e=this.M;e&&Cr(t)==3?e.l():this.Pa(t)};P.Pa=function(t){try{if(t==this.g)e:{let u=Cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>u)&&(u!=3||HI||this.g&&(this.h.h||this.g.ja()||LP(this.g)))){this.J||u!=4||e==7||(e==8||0>=d?ju(3):ju(2)),Ag(this);var n=this.g.da();this.ca=n;t:if(dk(this)){var r=LP(this.g);t="";var i=r.length,s=Cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ys(this),Pu(this);var o="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,jW(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ku(a)){var l=a;break t}}l=null}if(n=l)Wa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nC(this,n);else{this.i=!1,this.s=3,Qt(12),Ys(this),Pu(this);break e}}this.S?(hk(this,u,o),HI&&this.i&&u==3&&(tk(this.U,this.V,"tick",this.mb),this.V.start())):(Wa(this.j,this.m,o,null),nC(this,o)),u==4&&Ys(this),this.i&&!this.J&&(u==4?Ok(this.l,this):(this.i=!1,Wu(this)))}else l9(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Qt(12)):(this.s=0,Qt(13)),Ys(this),Pu(this)}}}catch{}finally{}};function dk(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function hk(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=qW(t,n),i==eC){e==4&&(t.s=4,Qt(14),r=!1),Wa(t.j,t.m,null,"[Incomplete Response]");break}else if(i==lk){t.s=4,Qt(15),Wa(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Wa(t.j,t.m,i,null),nC(t,i);dk(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Qt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),TC(e),e.M=!0,Qt(11))):(Wa(t.j,t.m,n,"[Invalid Chunked Response]"),Ys(t),Pu(t))}P.mb=function(){if(this.g){var t=Cr(this.g),e=this.g.ja();this.o<e.length&&(Ag(this),hk(this,t,e),this.i&&t!=4&&Wu(this))}};function qW(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?eC:(n=Number(e.substring(n,r)),isNaN(n)?lk:(r+=1,r+n>e.length?eC:(e=e.slice(r,r+n),t.o=r+n,e)))}P.cancel=function(){this.J=!0,Ys(this)};function Wu(t){t.Y=Date.now()+t.P,fk(t,t.P)}function fk(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Hu(Ot(t.lb,t),e)}function Ag(t){t.C&&(Z.clearTimeout(t.C),t.C=null)}P.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(UW(this.j,this.B),this.L!=2&&(ju(),Qt(17)),Ys(this),this.s=2,Pu(this)):fk(this,this.Y-t)};function Pu(t){t.l.H==0||t.J||Ok(t.l,t)}function Ys(t){Ag(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,mC(t.V),nk(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function nC(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||rC(n.i,t))){if(!t.K&&rC(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)gg(n),Ng(n);else break e;bC(n),Qt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Hu(Ot(n.ib,n),6e3));if(1>=Ek(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Zs(n,11)}else if((t.K||n.g==t)&&gg(n),!ku(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];let u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let d=l[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=l[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(EC(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,ke(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=Vk(r,r.J?r.pa:null,r.Y),o.K){Ik(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Ag(a),Wu(a)),r.g=o}else Pk(r);0<n.j.length&&Pg(n)}else l[0]!="stop"&&l[0]!="close"||Zs(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Zs(n,7):DC(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}ju(4)}catch{}}function HW(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(vg(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function GW(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(vg(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function pk(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(vg(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=GW(t),r=HW(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var gk=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zW(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Xs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Xs){this.h=t.h,fg(this,t.j),this.s=t.s,this.g=t.g,pg(this,t.m),this.l=t.l;var e=t.i,n=new Uu;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),kP(this,n),this.o=t.o}else t&&(e=String(t).match(gk))?(this.h=!1,fg(this,e[1]||"",!0),this.s=Ru(e[2]||""),this.g=Ru(e[3]||"",!0),pg(this,e[4]),this.l=Ru(e[5]||"",!0),kP(this,e[6]||"",!0),this.o=Ru(e[7]||"")):(this.h=!1,this.i=new Uu(null,this.h))}Xs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Nu(e,OP,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Nu(e,OP,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Nu(n,n.charAt(0)=="/"?QW:KW,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Nu(n,ZW)),t.join("")};function Xr(t){return new Xs(t)}function fg(t,e,n){t.j=n?Ru(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function pg(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function kP(t,e,n){e instanceof Uu?(t.i=e,XW(t.i,t.h)):(n||(e=Nu(e,YW)),t.i=new Uu(e,t.h))}function ke(t,e,n){t.i.set(e,n)}function xg(t){return ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ru(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Nu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,WW),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function WW(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var OP=/[#\/\?@]/g,KW=/[#\?:]/g,QW=/[#\?]/g,YW=/[#\?@]/g,ZW=/#/g;function Uu(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function $i(t){t.g||(t.g=new Map,t.h=0,t.i&&zW(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=Uu.prototype;P.add=function(t,e){$i(this),this.i=null,t=Ya(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function mk(t,e){$i(t),e=Ya(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function yk(t,e){return $i(t),e=Ya(t,e),t.g.has(e)}P.forEach=function(t,e){$i(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};P.ta=function(){$i(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};P.Z=function(t){$i(this);let e=[];if(typeof t=="string")yk(this,t)&&(e=e.concat(this.g.get(Ya(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};P.set=function(t,e){return $i(this),this.i=null,t=Ya(this,t),yk(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function _k(t,e,n){mk(t,e),0<n.length&&(t.i=null,t.g.set(Ya(t,e),aC(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ya(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function XW(t,e){e&&!t.j&&($i(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(mk(this,r),_k(this,i,n))},t)),t.j=e}var JW=class{constructor(t,e){this.g=t,this.map=e}};function vk(t){this.l=t||e9,Z.PerformanceNavigationTiming?(t=Z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var e9=10;function wk(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Ek(t){return t.h?1:t.g?t.g.size:0}function rC(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function EC(t,e){t.g?t.g.add(e):t.h=e}function Ik(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}vk.prototype.cancel=function(){if(this.i=Ck(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function Ck(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return aC(t.i)}var t9=class{stringify(t){return Z.JSON.stringify(t,void 0)}parse(t){return Z.JSON.parse(t,void 0)}};function n9(){this.g=new t9}function r9(t,e,n){let r=n||"";try{pk(t,function(i,s){let o=i;$u(i)&&(o=pC(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function i9(t,e){let n=new Dg;if(Z.Image){let r=new Image;r.onload=og(dg,n,r,"TestLoadImage: loaded",!0,e),r.onerror=og(dg,n,r,"TestLoadImage: error",!1,e),r.onabort=og(dg,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=og(dg,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function dg(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ku(t){this.l=t.ec||null,this.j=t.ob||!1}wt(Ku,_C);Ku.prototype.g=function(){return new Mg(this.l,this.j)};Ku.prototype.i=function(t){return function(){return t}}({});function Mg(t,e){vt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=IC,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wt(Mg,vt);var IC=0;P=Mg.prototype;P.open=function(t,e){if(this.readyState!=IC)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bu(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qu(this)),this.readyState=IC};P.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bu(this)),this.g&&(this.readyState=3,Bu(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Dk(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Dk(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}P.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Qu(this):Bu(this),this.readyState==3&&Dk(this)}};P.Za=function(t){this.g&&(this.response=this.responseText=t,Qu(this))};P.Ya=function(t){this.g&&(this.response=t,Qu(this))};P.ka=function(){this.g&&Qu(this)};function Qu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bu(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Bu(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Mg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var s9=Z.JSON.parse;function Ge(t){vt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=bk,this.L=this.M=!1}wt(Ge,vt);var bk="",o9=/^https?$/i,a9=["POST","PUT"];P=Ge.prototype;P.Oa=function(t){this.M=t};P.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():JI.g(),this.C=this.u?PP(this.u):PP(JI),this.g.onreadystatechange=Ot(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){FP(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&t instanceof Z.FormData,!(0<=BP(a9,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ak(this),0<this.B&&((this.L=c9(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ot(this.ua,this)):this.A=yC(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){FP(this,s)}};function c9(t){return Qa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}P.ua=function(){typeof oC<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,At(this,"timeout"),this.abort(8))};function FP(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Tk(t),Rg(t)}function Tk(t){t.F||(t.F=!0,At(t,"complete"),At(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,At(this,"complete"),At(this,"abort"),Rg(this))};P.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Rg(this,!0)),Ge.$.N.call(this)};P.La=function(){this.s||(this.G||this.v||this.l?Sk(this):this.kb())};P.kb=function(){Sk(this)};function Sk(t){if(t.h&&typeof oC<"u"&&(!t.C[1]||Cr(t)!=4||t.da()!=2)){if(t.v&&Cr(t)==4)yC(t.La,0,t);else if(At(t,"readystatechange"),Cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(gk)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!o9.test(i?i.toLowerCase():"")}n=r}if(n)At(t,"complete"),At(t,"success");else{t.m=6;try{var s=2<Cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Tk(t)}}finally{Rg(t)}}}}function Rg(t,e){if(t.g){Ak(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||At(t,"ready");try{n.onreadystatechange=r}catch{}}}function Ak(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}P.isActive=function(){return!!this.g};function Cr(t){return t.g?t.g.readyState:0}P.da=function(){try{return 2<Cr(this)?this.g.status:-1}catch{return-1}};P.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),s9(e)}};function LP(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case bk:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function l9(t){let e={};t=(t.g&&2<=Cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(ku(t[r]))continue;var n=OW(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}RW(e,function(r){return r.join(", ")})}P.Ia=function(){return this.m};P.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function xk(t){let e="";return lC(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function CC(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=xk(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ke(t,e,n))}function xu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mk(t){this.Ga=0,this.j=[],this.l=new Dg,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=xu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=xu("baseRetryDelayMs",5e3,t),this.hb=xu("retryDelaySeedMs",1e4,t),this.eb=xu("forwardChannelMaxRetries",2,t),this.xa=xu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new vk(t&&t.concurrentRequestLimit),this.Ja=new n9,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}P=Mk.prototype;P.ra=8;P.H=1;function DC(t){if(Rk(t),t.H==3){var e=t.W++,n=Xr(t.I);if(ke(n,"SID",t.K),ke(n,"RID",e),ke(n,"TYPE","terminate"),Yu(t,n),e=new zu(t,t.l,e),e.L=2,e.A=xg(Xr(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon)try{n=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Z.Image&&(new Image().src=e.A,n=!0),n||(e.g=jk(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Wu(e)}Lk(t)}function Ng(t){t.g&&(TC(t),t.g.cancel(),t.g=null)}function Rk(t){Ng(t),t.u&&(Z.clearTimeout(t.u),t.u=null),gg(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Z.clearTimeout(t.m),t.m=null)}function Pg(t){if(!wk(t.i)&&!t.m){t.m=!0;var e=t.Na;Fu||JP(),Lu||(Fu(),Lu=!0),gC.add(e,t),t.C=0}}function u9(t,e){return Ek(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Hu(Ot(t.Na,t,e),Fk(t,t.C)),t.C++,!0)}P.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new zu(this,this.l,t),s=this.s;if(this.U&&(s?(s=GP(s),zP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Nk(this,i,e),n=Xr(this.I),ke(n,"RID",t),ke(n,"CVER",22),this.F&&ke(n,"X-HTTP-Session-Id",this.F),Yu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(xk(s)))+"&"+e:this.o&&CC(n,this.o,s)),EC(this.i,i),this.bb&&ke(n,"TYPE","init"),this.P?(ke(n,"$req",e),ke(n,"SID","null"),i.aa=!0,tC(i,n,null)):tC(i,n,e),this.H=2}}else this.H==3&&(t?VP(this,t):this.j.length==0||wk(this.i)||VP(this))};function VP(t,e){var n;e?n=e.m:n=t.W++;let r=Xr(t.I);ke(r,"SID",t.K),ke(r,"RID",n),ke(r,"AID",t.V),Yu(t,r),t.o&&t.s&&CC(r,t.o,t.s),n=new zu(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Nk(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),EC(t.i,n),tC(n,r,e)}function Yu(t,e){t.na&&lC(t.na,function(n,r){ke(e,r,n)}),t.h&&pk({},function(n,r){ke(e,r,n)})}function Nk(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ot(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].g,u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{r9(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Pk(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Fu||JP(),Lu||(Fu(),Lu=!0),gC.add(e,t),t.A=0}}function bC(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Hu(Ot(t.Ma,t),Fk(t,t.A)),t.A++,!0)}P.Ma=function(){if(this.u=null,kk(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Hu(Ot(this.jb,this),t)}};P.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Qt(10),Ng(this),kk(this))};function TC(t){t.B!=null&&(Z.clearTimeout(t.B),t.B=null)}function kk(t){t.g=new zu(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Xr(t.wa);ke(e,"RID","rpc"),ke(e,"SID",t.K),ke(e,"AID",t.V),ke(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ke(e,"TO",t.qa),ke(e,"TYPE","xmlhttp"),Yu(t,e),t.o&&t.s&&CC(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=xg(Xr(e)),n.u=null,n.S=!0,uk(n,t)}P.ib=function(){this.v!=null&&(this.v=null,Ng(this),bC(this),Qt(19))};function gg(t){t.v!=null&&(Z.clearTimeout(t.v),t.v=null)}function Ok(t,e){var n=null;if(t.g==e){gg(t),TC(t),t.g=null;var r=2}else if(rC(t.i,e))n=e.F,Ik(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=bg(),At(r,new sk(r,n)),Pg(t)}else Pk(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&u9(t,e)||r==2&&bC(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Zs(t,5);break;case 4:Zs(t,10);break;case 3:Zs(t,6);break;default:Zs(t,2)}}}function Fk(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Zs(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ot(t.pb,t);n||(n=new Xs("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||fg(n,"https"),xg(n)),i9(n.toString(),r)}else Qt(2);t.H=0,t.h&&t.h.za(e),Lk(t),Rk(t)}P.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Qt(2)):(this.l.info("Failed to ping google.com"),Qt(1))};function Lk(t){if(t.H=0,t.ma=[],t.h){let e=Ck(t.i);(e.length!=0||t.j.length!=0)&&(xP(t.ma,e),xP(t.ma,t.j),t.i.i.length=0,aC(t.j),t.j.length=0),t.h.ya()}}function Vk(t,e,n){var r=n instanceof Xs?Xr(n):new Xs(n);if(r.g!="")e&&(r.g=e+"."+r.g),pg(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Xs(null);r&&fg(s,r),e&&(s.g=e),i&&pg(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&ke(r,n,e),ke(r,"VER",t.ra),Yu(t,r),r}function jk(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ge(new Ku({ob:n})):new Ge(t.va),e.Oa(t.J),e}P.isActive=function(){return!!this.h&&this.h.isActive(this)};function Uk(){}P=Uk.prototype;P.Ba=function(){};P.Aa=function(){};P.za=function(){};P.ya=function(){};P.isActive=function(){return!0};P.Va=function(){};function mg(){if(Qa&&!(10<=Number(SW)))throw Error("Environmental error: no available transport.")}mg.prototype.g=function(t,e){return new _n(t,e)};function _n(t,e){vt.call(this),this.g=new Mk(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ku(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ku(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Za(this)}wt(_n,vt);_n.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Qt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Vk(t,null,t.Y),Pg(t)};_n.prototype.close=function(){DC(this.g)};_n.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=pC(t),t=n);e.j.push(new JW(e.fb++,t)),e.H==3&&Pg(e)};_n.prototype.N=function(){this.g.h=null,delete this.j,DC(this.g),delete this.g,_n.$.N.call(this)};function Bk(t){vC.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}wt(Bk,vC);function $k(){wC.call(this),this.status=1}wt($k,wC);function Za(t){this.g=t}wt(Za,Uk);Za.prototype.Ba=function(){At(this.g,"a")};Za.prototype.Aa=function(t){At(this.g,new Bk(t))};Za.prototype.za=function(t){At(this.g,new $k)};Za.prototype.ya=function(){At(this.g,"b")};function d9(){this.blockSize=-1}function Yn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}wt(Yn,d9);Yn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function qI(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Yn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)qI(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){qI(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){qI(this,r),i=0;break}}this.h=i,this.i+=e};Yn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function De(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var h9={};function SC(t){return-128<=t&&128>t?DW(t,function(e){return new De([e|0],0>e?-1:0)}):new De([t|0],0>t?-1:0)}function Dr(t){if(isNaN(t)||!isFinite(t))return Ka;if(0>t)return St(Dr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=iC;return new De(e,0)}function qk(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return St(qk(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Dr(Math.pow(e,8)),r=Ka,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Dr(Math.pow(e,s)),r=r.R(s).add(Dr(o))):(r=r.R(n),r=r.add(Dr(o)))}return r}var iC=4294967296,Ka=SC(0),sC=SC(1),jP=SC(16777216);P=De.prototype;P.ea=function(){if(kn(this))return-St(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:iC+r)*e,e*=iC}return t};P.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Zr(this))return"0";if(kn(this))return"-"+St(this).toString(t);for(var e=Dr(Math.pow(t,6)),n=this,r="";;){var i=_g(n,e).g;n=yg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Zr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};P.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Zr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function kn(t){return t.h==-1}P.X=function(t){return t=yg(this,t),kn(t)?-1:Zr(t)?0:1};function St(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new De(n,~t.h).add(sC)}P.abs=function(){return kn(this)?St(this):this};P.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new De(n,n[n.length-1]&-2147483648?-1:0)};function yg(t,e){return t.add(St(e))}P.R=function(t){if(Zr(this)||Zr(t))return Ka;if(kn(this))return kn(t)?St(this).R(St(t)):St(St(this).R(t));if(kn(t))return St(this.R(St(t)));if(0>this.X(jP)&&0>t.X(jP))return Dr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,hg(n,2*r+2*i),n[2*r+2*i+1]+=s*c,hg(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,hg(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,hg(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new De(n,0)};function hg(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Mu(t,e){this.g=t,this.h=e}function _g(t,e){if(Zr(e))throw Error("division by zero");if(Zr(t))return new Mu(Ka,Ka);if(kn(t))return e=_g(St(t),e),new Mu(St(e.g),St(e.h));if(kn(e))return e=_g(t,St(e)),new Mu(St(e.g),e.h);if(30<t.g.length){if(kn(t)||kn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=sC,r=e;0>=r.X(t);)n=UP(n),r=UP(r);var i=za(n,1),s=za(r,1);for(r=za(r,2),n=za(n,2);!Zr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=za(r,1),n=za(n,1)}return e=yg(t,i.R(e)),new Mu(i,e)}for(i=Ka;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Dr(n),o=s.R(e);kn(o)||0<o.X(t);)n-=r,s=Dr(n),o=s.R(e);Zr(s)&&(s=sC),i=i.add(s),t=yg(t,o)}return new Mu(i,t)}P.gb=function(t){return _g(this,t).h};P.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new De(n,this.h&t.h)};P.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new De(n,this.h|t.h)};P.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new De(n,this.h^t.h)};function UP(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new De(n,t.h)}function za(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new De(i,t.h)}mg.prototype.createWebChannel=mg.prototype.g;_n.prototype.send=_n.prototype.u;_n.prototype.open=_n.prototype.m;_n.prototype.close=_n.prototype.close;Tg.NO_ERROR=0;Tg.TIMEOUT=8;Tg.HTTP_ERROR=6;ok.COMPLETE="complete";ak.EventType=Gu;Gu.OPEN="a";Gu.CLOSE="b";Gu.ERROR="c";Gu.MESSAGE="d";vt.prototype.listen=vt.prototype.O;Ge.prototype.listenOnce=Ge.prototype.P;Ge.prototype.getLastError=Ge.prototype.Sa;Ge.prototype.getLastErrorCode=Ge.prototype.Ia;Ge.prototype.getStatus=Ge.prototype.da;Ge.prototype.getResponseJson=Ge.prototype.Wa;Ge.prototype.getResponseText=Ge.prototype.ja;Ge.prototype.send=Ge.prototype.ha;Ge.prototype.setWithCredentials=Ge.prototype.Oa;Yn.prototype.digest=Yn.prototype.l;Yn.prototype.reset=Yn.prototype.reset;Yn.prototype.update=Yn.prototype.j;De.prototype.add=De.prototype.add;De.prototype.multiply=De.prototype.R;De.prototype.modulo=De.prototype.gb;De.prototype.compare=De.prototype.X;De.prototype.toNumber=De.prototype.ea;De.prototype.toString=De.prototype.toString;De.prototype.getBits=De.prototype.D;De.fromNumber=Dr;De.fromString=qk;var Hk=Zn.createWebChannelTransport=function(){return new mg},Gk=Zn.getStatEventTarget=function(){return bg()},kg=Zn.ErrorCode=Tg,zk=Zn.EventType=ok,Wk=Zn.Event=Js,AC=Zn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},jne=Zn.FetchXmlHttpFactory=Ku,Zu=Zn.WebChannel=ak,Kk=Zn.XhrIo=Ge,Qk=Zn.Md5=Yn,eo=Zn.Integer=De;var Yk="@firebase/firestore";var at=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};at.UNAUTHENTICATED=new at(null),at.GOOGLE_CREDENTIALS=new at("google-credentials-uid"),at.FIRST_PARTY=new at("first-party-uid"),at.MOCK_USER=new at("mock-user");var Sc="10.8.1";var Qi=new li("@firebase/firestore");function nc(){return Qi.logLevel}function Q1(t){Qi.setLogLevel(t)}function C(t,...e){if(Qi.logLevel<=In.DEBUG){let n=e.map(MD);Qi.debug(`Firestore (${Sc}): ${t}`,...n)}}function Ze(t,...e){if(Qi.logLevel<=In.ERROR){let n=e.map(MD);Qi.error(`Firestore (${Sc}): ${t}`,...n)}}function Fn(t,...e){if(Qi.logLevel<=In.WARN){let n=e.map(MD);Qi.warn(`Firestore (${Sc}): ${t}`,...n)}}function MD(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function L(t="Unexpected state"){let e=`FIRESTORE (${Sc}) INTERNAL ASSERTION FAILED: `+t;throw Ze(e),new Error(e)}function B(t,e){t||L()}function Y1(t,e){t||L()}function k(t,e){return t}var _={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends jb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ct=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Gg=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},PC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(at.UNAUTHENTICATED))}shutdown(){}},kC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},OC=class{constructor(e){this.t=e,this.currentUser=at.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ct,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>v(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ct)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(B(typeof r.accessToken=="string"),new Gg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return B(e===null||typeof e=="string"),new at(e)}},FC=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=at.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},LC=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new FC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(at.FIRST_PARTY))}shutdown(){}invalidateToken(){}},VC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},jC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(B(typeof n.token=="string"),this.R=n.token,new VC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function f9(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var zg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=f9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ee(t,e){return t<e?-1:t>e?1:0}function dc(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function Z1(t){return t+"\0"}var Be=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Be(0,0))}static max(){return new t(new Be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Wg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&L(),r===void 0?r=e.length-n:r>e.length-n&&L(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ye=class t extends Wg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(_.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},p9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class t extends Wg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return p9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(_.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(_.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new I(_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(_.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var R=class t{constructor(e){this.path=e}static fromPath(e){return new t(ye.fromString(e))}static fromName(e){return new t(ye.fromString(e).popFirst(5))}static empty(){return new t(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ye(e.slice()))}};var hc=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function UC(t){return t.fields.find(e=>e.kind===2)}function no(t){return t.fields.filter(e=>e.kind!==2)}hc.UNKNOWN_ID=-1;var cc=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var ld=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Ln.min())}};function X1(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new Ln(i,R.empty(),e)}function J1(t){return new Ln(t.readTime,t.key,-1)}var Ln=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(q.min(),R.empty(),-1)}static max(){return new t(q.max(),R.empty(),-1)}};function RD(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=R.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}var eO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ss(t){return v(this,null,function*(){if(t.code!==_.FAILED_PRECONDITION||t.message!==eO)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var y=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Qg=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ct,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new co(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=ND(r.target.error);this.V.reject(new co(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new co(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new $C(n)}},ti=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Bc())===12.2&&Ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),ro(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Kd())return!1;if(t.C())return!0;let e=Bc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new co(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new I(_.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new I(_.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new co(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Qg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),y.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},BC=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return ro(this.k.delete())}},co=class extends I{constructor(e,n){super(_.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function os(t){return t.name==="IndexedDbTransactionError"}var $C=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ro(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),ro(this.store.add(e))}get(e){return ro(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),ro(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),ro(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new y((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{let o=ND(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new BC(a),l=n(a.primaryKey,a.value,c);if(l instanceof y){let u=l.catch(d=>(c.done(),y.reject(d)));r.push(u)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function ro(t){return new y((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=ND(r.target.error);n(i)}})}var Zk=!1;function ND(t){let e=ti.S(Bc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Zk||(Zk=!0,setTimeout(()=>{throw r},0)),r}}return t}var qC=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){os(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield ss(n)}yield this.ee(6e4)}))}},HC=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return y.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=J1(s);RD(o,r)>0&&(r=o)}),new Ln(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var vn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Nd(t){return t==null}function ud(t){return t===0&&1/t==-1/0}function tO(t){return typeof t=="number"&&Number.isInteger(t)&&!ud(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Yt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Xk(e)),e=g9(t.get(n),e);return Xk(e)}function g9(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Xk(t){return t+""}function br(t){let e=t.length;if(B(e>=2),e===2)return B(t.charAt(0)===""&&t.charAt(1)===""),ye.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&L(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:L()}s=o+2}return new ye(r)}var Jk=["userId","batchId"];function jg(t,e){return[t,Yt(e)]}function nO(t,e,n){return[t,Yt(e),n]}var m9={},y9=["prefixPath","collectionGroup","readTime","documentId"],_9=["prefixPath","collectionGroup","documentId"],v9=["collectionGroup","readTime","prefixPath","documentId"],w9=["canonicalId","targetId"],E9=["targetId","path"],I9=["path","targetId"],C9=["collectionId","parent"],D9=["indexId","uid"],b9=["uid","sequenceNumber"],T9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],S9=["indexId","uid","orderedDocumentKey"],A9=["userId","collectionPath","documentId"],x9=["userId","collectionPath","largestBatchId"],M9=["userId","collectionGroup","largestBatchId"],rO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],R9=[...rO,"documentOverlays"],iO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],sO=iO,N9=[...sO,"indexConfiguration","indexState","indexEntries"];var dd=class extends Kg{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function It(t,e){let n=k(t);return ti.M(n.ae,e)}function e1(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Eo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oO(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Oe=class t{constructor(e,n){this.comparator=e,this.root=n||Sr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Sr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ac(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ac(this.root,e,this.comparator,!1)}getReverseIterator(){return new ac(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ac(this.root,e,this.comparator,!0)}},ac=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Sr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();let e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}};Sr.EMPTY=null,Sr.RED=!0,Sr.BLACK=!1;Sr.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Sr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var xe=class t{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Yg(this.data.getIterator())}getIteratorFrom(e){return new Yg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Yg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Xa(t){return t.hasNext()?t.getNext():void 0}var wn=class t{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new t([])}unionWith(e){let n=new xe(Xe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return dc(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Zg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function aO(){return typeof atob<"u"}var Et=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Et.EMPTY_BYTE_STRING=new Et("");var P9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(t){if(B(!!t),typeof t=="string"){let e=0,n=P9.exec(t);if(B(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ze(t.seconds),nanos:ze(t.nanos)}}function ze(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zi(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}function Bm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function PD(t){let e=t.mapValue.fields.__previous_value__;return Bm(e)?PD(e):e}function hd(t){let e=Yi(t.mapValue.fields.__local_write_time__.timestampValue);return new Be(e.seconds,e.nanos)}var GC=class{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Xi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Wi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ug={nullValue:"NULL_VALUE"};function lo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bm(t)?4:cO(t)?9007199254740991:10:L()}function Mr(t,e){if(t===e)return!0;let n=lo(t);if(n!==lo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hd(t).isEqual(hd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Yi(i.timestampValue),a=Yi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Zi(i.bytesValue).isEqual(Zi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ze(i.geoPointValue.latitude)===ze(s.geoPointValue.latitude)&&ze(i.geoPointValue.longitude)===ze(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ze(i.integerValue)===ze(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ze(i.doubleValue),a=ze(s.doubleValue);return o===a?ud(o)===ud(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return dc(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(e1(o)!==e1(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Mr(o[c],a[c])))return!1;return!0}(t,e);default:return L()}}function fd(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function Ji(t,e){if(t===e)return 0;let n=lo(t),r=lo(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=ze(s.integerValue||s.doubleValue),c=ze(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return t1(t.timestampValue,e.timestampValue);case 4:return t1(hd(t),hd(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Zi(s),c=Zi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=ee(a[l],c[l]);if(u!==0)return u}return ee(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ee(ze(s.latitude),ze(o.latitude));return a!==0?a:ee(ze(s.longitude),ze(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let u=Ji(a[l],c[l]);if(u)return u}return ee(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Wi.mapValue&&o===Wi.mapValue)return 0;if(s===Wi.mapValue)return 1;if(o===Wi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){let h=ee(c[d],u[d]);if(h!==0)return h;let f=Ji(a[c[d]],l[u[d]]);if(f!==0)return f}return ee(c.length,u.length)}(t.mapValue,e.mapValue);default:throw L()}}function t1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);let n=Yi(t),r=Yi(e),i=ee(n.seconds,r.seconds);return i!==0?i:ee(n.nanos,r.nanos)}function fc(t){return zC(t)}function zC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Yi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Zi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return R.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=zC(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${zC(n.fields[o])}`;return i+"}"}(t.mapValue):L()}function uo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function WC(t){return!!t&&"integerValue"in t}function pd(t){return!!t&&"arrayValue"in t}function n1(t){return!!t&&"nullValue"in t}function r1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bg(t){return!!t&&"mapValue"in t}function id(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Eo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=id(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=id(t.arrayValue.values[n]);return e}return Object.assign({},t)}function cO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function k9(t){return"nullValue"in t?Ug:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?uo(Xi.empty(),R.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:L()}function O9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?uo(Xi.empty(),R.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Wi:L()}function i1(t,e){let n=Ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function s1(t,e){let n=Ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Vt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=id(n)}setAll(e){let n=Xe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=id(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Bg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Bg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Eo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(id(this.value))}};function lO(t){let e=[];return Eo(t.fields,(n,r)=>{let i=new Xe([n]);if(Bg(r)){let s=lO(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new wn(e)}var lt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,q.min(),q.min(),q.min(),Vt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,q.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,q.min(),q.min(),Vt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,q.min(),q.min(),Vt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Rr=class{constructor(e,n){this.position=e,this.inclusive=n}};function o1(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=R.comparator(R.fromName(o.referenceValue),n.key):r=Ji(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function a1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}var ho=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function F9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Xg=class{},fe=class t extends Xg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new YC(e,n,r):n==="array-contains"?new JC(e,r):n==="in"?new Jg(e,r):n==="not-in"?new e0(e,r):n==="array-contains-any"?new t0(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ZC(e,r):new XC(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ji(n,this.value)):n!==null&&lo(this.value)===lo(n)&&this.matchesComparison(Ji(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},be=class t extends Xg{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return pc(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function pc(t){return t.op==="and"}function KC(t){return t.op==="or"}function kD(t){return uO(t)&&pc(t)}function uO(t){for(let e of t.filters)if(e instanceof be)return!1;return!0}function QC(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+fc(t.value);if(kD(t))return t.filters.map(e=>QC(e)).join(",");{let e=t.filters.map(n=>QC(n)).join(",");return`${t.op}(${e})`}}function dO(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&dO(o,i.filters[a]),!0):!1}(t,e):void L()}function hO(t,e){let n=t.filters.concat(e);return be.create(n,t.op)}function fO(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${fc(n.value)}`}(t):t instanceof be?function(n){return n.op.toString()+" {"+n.getFilters().map(fO).join(" ,")+"}"}(t):"Filter"}var YC=class extends fe{constructor(e,n,r){super(e,n,r),this.key=R.fromName(r.referenceValue)}matches(e){let n=R.comparator(e.key,this.key);return this.matchesComparison(n)}},ZC=class extends fe{constructor(e,n){super(e,"in",n),this.keys=pO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},XC=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=pO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function pO(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>R.fromName(r.referenceValue))}var JC=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return pd(n)&&fd(n.arrayValue,this.value)}},Jg=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&fd(this.value.arrayValue,n)}},e0=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(fd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!fd(this.value.arrayValue,n)}},t0=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!pd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>fd(this.value.arrayValue,r))}};var n0=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function r0(t,e=null,n=[],r=[],i=null,s=null,o=null){return new n0(t,e,n,r,i,s,o)}function fo(t){let e=k(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>QC(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Nd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>fc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>fc(r)).join(",")),e.ce=n}return e.ce}function Pd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!F9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!dO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!a1(t.startAt,e.startAt)&&a1(t.endAt,e.endAt)}function em(t){return R.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function tm(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function c1(t,e,n){let r=Ug,i=!0;for(let s of tm(t,e)){let o=Ug,a=!0;switch(s.op){case"<":case"<=":o=k9(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ug}i1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];i1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function l1(t,e,n){let r=Wi,i=!0;for(let s of tm(t,e)){let o=Wi,a=!0;switch(s.op){case">=":case">":o=O9(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Wi}s1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];s1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Xn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function gO(t,e,n,r,i,s,o,a){return new Xn(t,e,n,r,i,s,o,a)}function Ac(t){return new Xn(t)}function u1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function OD(t){return t.collectionGroup!==null}function lc(t){let e=k(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(Xe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new ho(s,r))}),n.has(Xe.keyField().canonicalString())||e.le.push(new ho(Xe.keyField(),r))}return e.le}function Zt(t){let e=k(t);return e.he||(e.he=L9(e,lc(t))),e.he}function L9(t,e){if(t.limitType==="F")return r0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new ho(i.field,s)});let n=t.endAt?new Rr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Rr(t.startAt.position,t.startAt.inclusive):null;return r0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function i0(t,e){let n=t.filters.concat([e]);return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function nm(t,e,n){return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function kd(t,e){return Pd(Zt(t),Zt(e))&&t.limitType===e.limitType}function mO(t){return`${fo(Zt(t))}|lt:${t.limitType}`}function rc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>fO(i)).join(", ")}]`),Nd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>fc(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>fc(i)).join(",")),`Target(${r})`}(Zt(t))}; limitType=${t.limitType})`}function Od(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):R.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of lc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=o1(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,lc(r),i)||r.endAt&&!function(o,a,c){let l=o1(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,lc(r),i))}(t,e)}function yO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _O(t){return(e,n)=>{let r=!1;for(let i of lc(t)){let s=V9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function V9(t,e,n){let r=t.field.isKeyField()?R.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?Ji(c,l):L()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return L()}}var Nr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Eo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return oO(this.inner)}size(){return this.innerSize}};var j9=new Oe(R.comparator);function cn(){return j9}var vO=new Oe(R.comparator);function nd(...t){let e=vO;for(let n of t)e=e.insert(n.key,n);return e}function wO(t){let e=vO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Tr(){return sd()}function EO(){return sd()}function sd(){return new Nr(t=>t.toString(),(t,e)=>t.isEqual(e))}var U9=new Oe(R.comparator),B9=new xe(R.comparator);function te(...t){let e=B9;for(let n of t)e=e.add(n);return e}var $9=new xe(ee);function FD(){return $9}function IO(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ud(e)?"-0":e}}function CO(t){return{integerValue:""+t}}function DO(t,e){return tO(e)?CO(e):IO(t,e)}var gc=class{constructor(){this._=void 0}};function q9(t,e,n){return t instanceof es?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Bm(s)&&(s=PD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ni?TO(t,e):t instanceof ri?SO(t,e):function(i,s){let o=bO(i,s),a=d1(o)+d1(i.Ie);return WC(o)&&WC(i.Ie)?CO(a):IO(i.serializer,a)}(t,e)}function H9(t,e,n){return t instanceof ni?TO(t,e):t instanceof ri?SO(t,e):n}function bO(t,e){return t instanceof ts?function(r){return WC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var es=class extends gc{},ni=class extends gc{constructor(e){super(),this.elements=e}};function TO(t,e){let n=AO(e);for(let r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var ri=class extends gc{constructor(e){super(),this.elements=e}};function SO(t,e){let n=AO(e);for(let r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}var ts=class extends gc{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function d1(t){return ze(t.integerValue||t.doubleValue)}function AO(t){return pd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var po=class{constructor(e,n){this.field=e,this.transform=n}};function G9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ni&&i instanceof ni||r instanceof ri&&i instanceof ri?dc(r.elements,i.elements,Mr):r instanceof ts&&i instanceof ts?Mr(r.Ie,i.Ie):r instanceof es&&i instanceof es}(t.transform,e.transform)}var s0=class{constructor(e,n){this.version=e,this.transformResults=n}},We=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function $g(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var mc=class{};function xO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rs(t.key,We.none()):new ns(t.key,t.data,We.none());{let n=t.data,r=Vt.empty(),i=new xe(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Jn(t.key,r,new wn(i.toArray()),We.none())}}function z9(t,e,n){t instanceof ns?function(i,s,o){let a=i.value.clone(),c=f1(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Jn?function(i,s,o){if(!$g(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=f1(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(MO(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function od(t,e,n,r){return t instanceof ns?function(s,o,a,c){if(!$g(s.precondition,o))return a;let l=s.value.clone(),u=p1(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Jn?function(s,o,a,c){if(!$g(s.precondition,o))return a;let l=p1(s.fieldTransforms,c,o),u=o.data;return u.setAll(MO(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return $g(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function W9(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=bO(r.transform,i||null);s!=null&&(n===null&&(n=Vt.empty()),n.set(r.field,s))}return n||null}function h1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&dc(r,i,(s,o)=>G9(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ns=class extends mc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Jn=class extends mc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function MO(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function f1(t,e,n){let r=new Map;B(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,H9(o,a,n[i]))}return r}function p1(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,q9(s,o,e))}return r}var rs=class extends mc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},gd=class extends mc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var md=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&z9(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=od(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=od(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=EO();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=xO(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&dc(this.mutations,e.mutations,(n,r)=>h1(n,r))&&dc(this.baseMutations,e.baseMutations,(n,r)=>h1(n,r))}},o0=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){B(e.mutations.length===r.length);let i=function(){return U9}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var yd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var a0=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var st,me;function RO(t){switch(t){default:return L();case _.CANCELLED:case _.UNKNOWN:case _.DEADLINE_EXCEEDED:case _.RESOURCE_EXHAUSTED:case _.INTERNAL:case _.UNAVAILABLE:case _.UNAUTHENTICATED:return!1;case _.INVALID_ARGUMENT:case _.NOT_FOUND:case _.ALREADY_EXISTS:case _.PERMISSION_DENIED:case _.FAILED_PRECONDITION:case _.ABORTED:case _.OUT_OF_RANGE:case _.UNIMPLEMENTED:case _.DATA_LOSS:return!0}}function NO(t){if(t===void 0)return Ze("GRPC error has no .code"),_.UNKNOWN;switch(t){case st.OK:return _.OK;case st.CANCELLED:return _.CANCELLED;case st.UNKNOWN:return _.UNKNOWN;case st.DEADLINE_EXCEEDED:return _.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return _.RESOURCE_EXHAUSTED;case st.INTERNAL:return _.INTERNAL;case st.UNAVAILABLE:return _.UNAVAILABLE;case st.UNAUTHENTICATED:return _.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return _.INVALID_ARGUMENT;case st.NOT_FOUND:return _.NOT_FOUND;case st.ALREADY_EXISTS:return _.ALREADY_EXISTS;case st.PERMISSION_DENIED:return _.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return _.FAILED_PRECONDITION;case st.ABORTED:return _.ABORTED;case st.OUT_OF_RANGE:return _.OUT_OF_RANGE;case st.UNIMPLEMENTED:return _.UNIMPLEMENTED;case st.DATA_LOSS:return _.DATA_LOSS;default:return L()}}(me=st||(st={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var g1=null;function PO(){return new TextEncoder}var K9=new eo([4294967295,4294967295],0);function m1(t){let e=PO().encode(t),n=new Qk;return n.update(e),new Uint8Array(n.digest())}function y1(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new eo([n,r],0),new eo([i,s],0)]}var c0=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ao(`Invalid padding: ${n}`);if(r<0)throw new ao(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ao(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ao(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=eo.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(eo.fromNumber(r)));return i.compare(K9)===1&&(i=new eo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=m1(e),[r,i]=y1(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=m1(e),[r,i]=y1(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},ao=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var _d=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,vd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(q.min(),i,new Oe(ee),cn(),te())}},vd=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var uc=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},rm=class{constructor(e,n){this.targetId=e,this.fe=n}},im=class{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},sm=class{constructor(){this.ge=0,this.pe=v1(),this.ye=Et.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:L()}}),new vd(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=v1()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,B(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},l0=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=cn(),this.Qe=_1(),this.Ke=new Oe(ee)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:L()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(em(s))if(r===0){let o=new R(s.path);this.We(n,o,lt.newNoDocument(o,q.min()))}else B(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}g1?.tt(function(u,d,h,f,p){var g,m,w,O,S,V;let H={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},z=d.unchangedNames;return z&&(H.bloomFilter={applied:p===0,hashCount:(g=z?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(O=(w=(m=z?.bits)===null||m===void 0?void 0:m.bitmap)===null||w===void 0?void 0:w.length)!==null&&O!==void 0?O:0,padding:(V=(S=z?.bits)===null||S===void 0?void 0:S.padding)!==null&&V!==void 0?V:0,mightContain:Ee=>{var Jt;return(Jt=f?.mightContain(Ee))!==null&&Jt!==void 0&&Jt}}),H}(o,e.fe,this.Le.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Zi(r).toUint8Array()}catch(c){if(c instanceof Zg)return Fn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new c0(o,i,s)}catch(c){return Fn(c instanceof ao?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&em(a.target)){let c=new R(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,lt.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new _d(e,n,this.Ke,this.qe,r);return this.qe=cn(),this.Qe=_1(),this.Ke=new Oe(ee),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new sm,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new xe(ee),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new sm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function _1(){return new Oe(R.comparator)}function v1(){return new Oe(R.comparator)}var Q9={asc:"ASCENDING",desc:"DESCENDING"},Y9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Z9={and:"AND",or:"OR"},u0=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function d0(t,e){return t.useProto3Json||Nd(e)?e:{value:e}}function yc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function X9(t,e){return yc(t,e.toTimestamp())}function Je(t){return B(!!t),q.fromTimestamp(function(n){let r=Yi(n);return new Be(r.seconds,r.nanos)}(t))}function LD(t,e){return h0(t,e).canonicalString()}function h0(t,e){let n=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function OO(t){let e=ye.fromString(t);return B(GO(e)),e}function wd(t,e){return LD(t.databaseId,e.path)}function Ar(t,e){let n=OO(e);if(n.get(1)!==t.databaseId.projectId)throw new I(_.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(_.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new R(VO(n))}function FO(t,e){return LD(t.databaseId,e)}function LO(t){let e=OO(t);return e.length===4?ye.emptyPath():VO(e)}function f0(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function VO(t){return B(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function w1(t,e,n){return{name:wd(t,e),fields:n.value.mapValue.fields}}function jO(t,e,n){let r=Ar(t,e.name),i=Je(e.updateTime),s=e.createTime?Je(e.createTime):q.min(),o=new Vt({mapValue:{fields:e.fields}}),a=lt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function J9(t,e){return"found"in e?function(r,i){B(!!i.found),i.found.name,i.found.updateTime;let s=Ar(r,i.found.name),o=Je(i.found.updateTime),a=i.found.createTime?Je(i.found.createTime):q.min(),c=new Vt({mapValue:{fields:i.found.fields}});return lt.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){B(!!i.missing),B(!!i.readTime);let s=Ar(r,i.missing),o=Je(i.readTime);return lt.newNoDocument(s,o)}(t,e):L()}function e5(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(B(u===void 0||typeof u=="string"),Et.fromBase64String(u||"")):(B(u===void 0||u instanceof Uint8Array),Et.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let u=l.code===void 0?_.UNKNOWN:NO(l.code);return new I(u,l.message||"")}(o);n=new im(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ar(t,r.document.name),s=Je(r.document.updateTime),o=r.document.createTime?Je(r.document.createTime):q.min(),a=new Vt({mapValue:{fields:r.document.fields}}),c=lt.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new uc(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ar(t,r.document),s=r.readTime?Je(r.readTime):q.min(),o=lt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new uc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ar(t,r.document),s=r.removedTargetIds||[];n=new uc([],s,i,null)}else{if(!("filter"in e))return L();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new a0(i,s),a=r.targetId;n=new rm(a,o)}}return n}function Ed(t,e){let n;if(e instanceof ns)n={update:w1(t,e.key,e.value)};else if(e instanceof rs)n={delete:wd(t,e.key)};else if(e instanceof Jn)n={update:w1(t,e.key,e.data),updateMask:o5(e.fieldMask)};else{if(!(e instanceof gd))return L();n={verify:wd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof es)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ni)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ri)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ts)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw L()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:X9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L()}(t,e.precondition)),n}function p0(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?We.updateTime(Je(s.updateTime)):s.exists!==void 0?We.exists(s.exists):We.none()}(e.currentDocument):We.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)B(a.setToServerValue==="REQUEST_TIME"),c=new es;else if("appendMissingElements"in a){let u=a.appendMissingElements.values||[];c=new ni(u)}else if("removeAllFromArray"in a){let u=a.removeAllFromArray.values||[];c=new ri(u)}else"increment"in a?c=new ts(o,a.increment):L();let l=Xe.fromServerFormat(a.fieldPath);return new po(l,c)}(t,i)):[];if(e.update){e.update.name;let i=Ar(t,e.update.name),s=new Vt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new wn(l.map(u=>Xe.fromServerFormat(u)))}(e.updateMask);return new Jn(i,s,o,n,r)}return new ns(i,s,n,r)}if(e.delete){let i=Ar(t,e.delete);return new rs(i,n)}if(e.verify){let i=Ar(t,e.verify);return new gd(i,n)}return L()}function t5(t,e){return t&&t.length>0?(B(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Je(i.updateTime):Je(s);return o.isEqual(q.min())&&(o=Je(s)),new s0(o,i.transformResults||[])}(n,e))):[]}function UO(t,e){return{documents:[FO(t,e.path)]}}function BO(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=FO(t,i);let s=function(l){if(l.length!==0)return HO(be.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:ic(h.field),direction:r5(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=d0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ut:n,parent:i}}function $O(t){let e=LO(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){B(r===1);let u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){let h=qO(d);return h instanceof be&&kD(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new ho(sc(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Nd(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Rr(f,h)}(n.startAt));let l=null;return n.endAt&&(l=function(d){let h=!d.before,f=d.values||[];return new Rr(f,h)}(n.endAt)),gO(e,i,o,s,a,"F",c,l)}function n5(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function qO(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=sc(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=sc(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=sc(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=sc(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(sc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return be.create(n.compositeFilter.filters.map(r=>qO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L()}}(n.compositeFilter.op))}(t):L()}function r5(t){return Q9[t]}function i5(t){return Y9[t]}function s5(t){return Z9[t]}function ic(t){return{fieldPath:t.canonicalString()}}function sc(t){return Xe.fromServerFormat(t.fieldPath)}function HO(t){return t instanceof fe?function(n){if(n.op==="=="){if(r1(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NAN"}};if(n1(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(r1(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NOT_NAN"}};if(n1(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(n.field),op:i5(n.op),value:n.value}}}(t):t instanceof be?function(n){let r=n.getFilters().map(i=>HO(i));return r.length===1?r[0]:{compositeFilter:{op:s5(n.op),filters:r}}}(t):L()}function o5(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function GO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var _c=class t{constructor(e,n,r,i,s=q.min(),o=q.min(),a=Et.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var om=class{constructor(e){this.ct=e}};function a5(t,e){let n;if(e.document)n=jO(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=R.fromSegments(e.noDocument.path),i=mo(e.noDocument.readTime);n=lt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return L();{let r=R.fromSegments(e.unknownDocument.path),i=mo(e.unknownDocument.version);n=lt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Be(i[0],i[1]);return q.fromTimestamp(s)}(e.readTime)),n}function E1(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:am(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:wd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:yc(s,o.version.toTimestamp()),createTime:yc(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:go(e.version)};else{if(!e.isUnknownDocument())return L();r.unknownDocument={path:n.path.toArray(),version:go(e.version)}}return r}function am(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function go(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mo(t){let e=new Be(t.seconds,t.nanoseconds);return q.fromTimestamp(e)}function io(t,e){let n=(e.baseMutations||[]).map(s=>p0(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>p0(t.ct,s)),i=Be.fromMillis(e.localWriteTimeMs);return new md(e.batchId,i,n,r)}function rd(t){let e=mo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?mo(t.lastLimboFreeSnapshotVersion):q.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return B(s.documents.length===1),Zt(Ac(LO(s.documents[0])))}(t.query):function(s){return Zt($O(s))}(t.query),new _c(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function zO(t,e){let n=go(e.snapshotVersion),r=go(e.lastLimboFreeSnapshotVersion),i;i=em(e.target)?UO(t.ct,e.target):BO(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function VD(t){let e=$O({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nm(e,e.limit,"L"):e}function xC(t,e){return new yd(e.largestBatchId,p0(t.ct,e.overlayMutation))}function I1(t,e){let n=e.path.lastSegment();return[t,Yt(e.path.popLast()),n]}function C1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:go(r.readTime),documentKey:Yt(r.documentKey.path),largestBatchId:r.largestBatchId}}var g0=class{getBundleMetadata(e,n){return D1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:mo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return D1(e).put(function(i){return{bundleId:i.id,createTime:go(Je(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return b1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:VD(s.bundledQuery),readTime:mo(s.readTime)}}(r)})}saveNamedQuery(e,n){return b1(e).put(function(i){return{name:i.name,readTime:go(Je(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function D1(t){return It(t,"bundles")}function b1(t){return It(t,"namedQueries")}var cm=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Xu(e).get(I1(this.userId,n)).next(r=>r?xC(this.serializer,r):null)}getOverlays(e,n){let r=Tr();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new yd(n,o);i.push(this.ht(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Yt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Xu(e).H("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Tr(),s=Yt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Xu(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=xC(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Tr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Xu(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{let d=xC(this.serializer,l);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>s)}ht(e,n){return Xu(e).put(function(i,s,o){let[a,c,l]=I1(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ed(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Xu(t){return It(t,"documentOverlays")}var Jr=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(ze(e.integerValue));else if("doubleValue"in e){let r=ze(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),ud(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Zi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?cO(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):L()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),R.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Jr.bt=new Jr;function c5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function T1(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=c5(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var m0=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=T1(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=T1(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},y0=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},_0=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},so=class{constructor(){this.Gt=new m0,this.zt=new y0(this.Gt),this.jt=new _0(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var oo=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function qi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=S1(t.arrayValue,e.arrayValue),n!==0?n:(n=S1(t.directionalValue,e.directionalValue),n!==0?n:R.comparator(t.documentKey,e.documentKey)))}function S1(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var lm=class{constructor(e){this.Yt=new xe((n,r)=>Xe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(B(e.collectionGroup===this.collectionId),this.en)return!1;let n=UC(e);if(n!==void 0&&!this.nn(n))return!1;let r=no(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new xe(Xe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new cc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new cc(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new cc(r.field,r.dir==="asc"?0:1)));return new hc(hc.UNKNOWN_ID,this.collectionId,n,ld.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function WO(t){var e,n;if(B(t instanceof fe||t instanceof be),t instanceof fe){if(t instanceof Jg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return be.create(i,"or")}return t}let r=t.filters.map(i=>WO(i));return be.create(r,t.op)}function l5(t){if(t.getFilters().length===0)return[];let e=E0(WO(t));return B(KO(e)),v0(e)||w0(e)?[e]:e.getFilters()}function v0(t){return t instanceof fe}function w0(t){return t instanceof be&&kD(t)}function KO(t){return v0(t)||w0(t)||function(n){if(n instanceof be&&KC(n)){for(let r of n.getFilters())if(!v0(r)&&!w0(r))return!1;return!0}return!1}(t)}function E0(t){if(B(t instanceof fe||t instanceof be),t instanceof fe)return t;if(t.filters.length===1)return E0(t.filters[0]);let e=t.filters.map(r=>E0(r)),n=be.create(e,t.op);return n=um(n),KO(n)?n:(B(n instanceof be),B(pc(n)),B(n.filters.length>1),n.filters.reduce((r,i)=>jD(r,i)))}function jD(t,e){let n;return B(t instanceof fe||t instanceof be),B(e instanceof fe||e instanceof be),n=t instanceof fe?e instanceof fe?function(i,s){return be.create([i,s],"and")}(t,e):A1(t,e):e instanceof fe?A1(e,t):function(i,s){if(B(i.filters.length>0&&s.filters.length>0),pc(i)&&pc(s))return hO(i,s.getFilters());let o=KC(i)?i:s,a=KC(i)?s:i,c=o.filters.map(l=>jD(l,a));return be.create(c,"or")}(t,e),um(n)}function A1(t,e){if(pc(e))return hO(e,t.getFilters());{let n=e.filters.map(r=>jD(t,r));return be.create(n,"or")}}function um(t){if(B(t instanceof fe||t instanceof be),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return um(e[0]);if(uO(t))return t;let n=e.map(i=>um(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof be&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:be.create(r,t.op)}var I0=class{constructor(){this._n=new Id}addToCollectionParentIndex(e,n){return this._n.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}deleteAllFieldIndexes(e){return y.resolve()}createTargetIndexes(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Ln.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Ln.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}},Id=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new xe(ye.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(ye.comparator)).toArray()}};var Og=new Uint8Array(0),C0=class{constructor(e,n){this.databaseId=n,this.an=new Id,this.un=new Nr(r=>fo(r),(r,i)=>Pd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Yt(i)};return x1(e).put(s)}return y.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[Z1(n),""],!1,!0);return x1(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(br(o.parent))}return r})}addFieldIndex(e,n){let r=Ju(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=ec(e);return s.next(a=>{o.put(C1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Ju(e),i=ec(e),s=Ja(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Ju(e),r=Ja(e),i=ec(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return y.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new lm(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Ja(e),i=!0,s=new Map;return y.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return y.forEach(s,(c,l)=>{C("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(c)} to execute ${fo(n)}`);let u=function(S,V){let H=UC(V);if(H===void 0)return null;for(let z of tm(S,H.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(l,c),d=function(S,V){let H=new Map;for(let z of no(V))for(let Ee of tm(S,z.fieldPath))switch(Ee.op){case"==":case"in":H.set(z.fieldPath.canonicalString(),Ee.value);break;case"not-in":case"!=":return H.set(z.fieldPath.canonicalString(),Ee.value),Array.from(H.values())}return null}(l,c),h=function(S,V){let H=[],z=!0;for(let Ee of no(V)){let Jt=Ee.kind===0?c1(S,Ee.fieldPath,S.startAt):l1(S,Ee.fieldPath,S.startAt);H.push(Jt.value),z&&(z=Jt.inclusive)}return new Rr(H,z)}(l,c),f=function(S,V){let H=[],z=!0;for(let Ee of no(V)){let Jt=Ee.kind===0?l1(S,Ee.fieldPath,S.endAt):c1(S,Ee.fieldPath,S.endAt);H.push(Jt.value),z&&(z=Jt.inclusive)}return new Rr(H,z)}(l,c),p=this.hn(c,l,h),g=this.hn(c,l,f),m=this.Pn(c,l,d),w=this.In(c.indexId,u,p,h.inclusive,g,f.inclusive,m);return y.forEach(w,O=>r.j(O,n.limit).next(S=>{S.forEach(V=>{let H=R.fromSegments(V.documentKey);o.has(H)||(o=o.add(H),a.push(H))})}))}).next(()=>a)}return y.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=l5(be.create(e.filters,"and")).map(r=>r0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),l=c/(n!=null?n.length:1),u=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/l]):Og,f=this.En(e,h,r[d%l],i),p=this.dn(e,h,s[d%l],o),g=a.map(m=>this.En(e,h,m,!0));u.push(...this.createRange(f,p,g))}return u}En(e,n,r,i){let s=new oo(e,R.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new oo(e,R.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new lm(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return y.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new xe(Xe.comparator),u=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:l=l.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(l=l.add(d.field));return l.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new so;for(let i of no(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Jr.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new so;return Jr.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new so;return Jr.bt.Pt(uo(this.databaseId,n),r.Ht(function(s){let o=no(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new so);let s=0;for(let o of no(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&pd(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);Jr.bt.Pt(a,l)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new so;c.seed(a.Wt()),Jr.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Ju(e),i=ec(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(u,d){let h=d?new ld(d.sequenceNumber,new Ln(mo(d.readTime),new R(br(d.documentKey)),d.largestBatchId)):ld.empty(),f=u.fields.map(([p,g])=>new cc(Xe.fromServerFormat(p),g));return new hc(u.indexId,u.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Ju(e),s=ec(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,c=>s.put(C1(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return y.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,c=>this.pn(e,i,c).next(l=>{let u=this.yn(s,c);return l.isEqual(u)?y.resolve():this.wn(e,s,c,l,u)}))))})}Sn(e,n,r,i){return Ja(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Ja(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Ja(e),s=new xe(qi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new oo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new xe(qi),i=this.An(n,e);if(i==null)return r;let s=UC(n);if(s!=null){let o=e.data.field(s.fieldPath);if(pd(o))for(let a of o.arrayValue.values||[])r=r.add(new oo(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new oo(n.indexId,e.key,Og,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,l,u,d,h){let f=c.getIterator(),p=l.getIterator(),g=Xa(f),m=Xa(p);for(;g||m;){let w=!1,O=!1;if(g&&m){let S=u(g,m);S<0?O=!0:S>0&&(w=!0)}else g!=null?O=!0:w=!0;w?(d(m),m=Xa(p)):O?(h(g),g=Xa(f)):(g=Xa(f),m=Xa(p))}}(i,s,qi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),y.waitFor(o)}gn(e){let n=1;return ec(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>qi(o,a)).filter((o,a,c)=>!a||qi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=qi(o,e),c=qi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Og,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Og,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return qi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(M1)}getMinOffset(e,n){return y.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||L())).next(M1)}};function x1(t){return It(t,"collectionParents")}function Ja(t){return It(t,"indexEntries")}function Ju(t){return It(t,"indexConfiguration")}function ec(t){return It(t,"indexState")}function M1(t){B(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;RD(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Ln(e.readTime,e.documentKey,n)}var R1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},On=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function QO(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(u,d,h)=>(a++,h.delete()));s.push(c.next(()=>{B(a===1)}));let l=[];for(let u of n.mutations){let d=nO(e,u.key.path,n.batchId);s.push(i.delete(d)),l.push(u.key)}return y.waitFor(s).next(()=>l)}function dm(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw L();e=t.noDocument}return JSON.stringify(e).length}On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(41943040,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);var hm=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){B(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=oc(e),o=Hi(e);return o.add({}).next(a=>{B(typeof a=="number");let c=new md(a,n,r,i),l=function(f,p,g){let m=g.baseMutations.map(O=>Ed(f.ct,O)),w=g.mutations.map(O=>Ed(f.ct,O));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:w}}(this.serializer,this.userId,c),u=[],d=new xe((h,f)=>ee(h.canonicalString(),f.canonicalString()));for(let h of i){let f=nO(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),u.push(o.put(l)),u.push(s.put(f,m9))}return d.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),y.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Hi(e).get(n).next(r=>r?(B(r.userId===this.userId),io(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?y.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Hi(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(B(a.batchId>=r),s=io(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Hi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Hi(e).W("userMutationsIndex",n).next(r=>r.map(i=>io(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=jg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return oc(e).Y({range:i},(o,a,c)=>{let[l,u,d]=o,h=br(u);if(l===this.userId&&n.path.isEqual(h))return Hi(e).get(d).next(f=>{if(!f)throw L();B(f.userId===this.userId),s.push(io(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(ee),i=[];return n.forEach(s=>{let o=jg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=oc(e).Y({range:a},(l,u,d)=>{let[h,f,p]=l,g=br(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(c)}),y.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=jg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new xe(ee);return oc(e).Y({range:o},(c,l,u)=>{let[d,h,f]=c,p=br(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):u.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Hi(e).get(s).next(o=>{if(o===null)throw L();B(o.userId===this.userId),r.push(io(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return QO(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return oc(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=br(s[1]);i.push(c)}else a.done()}).next(()=>{B(i.length===0)})})}containsKey(e,n){return YO(e,this.userId,n)}xn(e){return ZO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function YO(t,e,n){let r=jg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return oc(t).Y({range:s,J:!0},(a,c,l)=>{let[u,d,h]=a;u===e&&d===i&&(o=!0),l.done()}).next(()=>o)}function Hi(t){return It(t,"mutations")}function oc(t){return It(t,"documentMutations")}function ZO(t){return It(t,"mutationQueues")}var vc=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var D0=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new vc(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>q.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>tc(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(B(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return tc(e).Y((o,a)=>{let c=rd(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return tc(e).Y((r,i)=>{let s=rd(i);n(s)})}Ln(e){return N1(e).get("targetGlobalKey").next(n=>(B(n!==null),n))}kn(e,n){return N1(e).put("targetGlobalKey",n)}qn(e,n){return tc(e).put(zO(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=fo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return tc(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=rd(a);Pd(n,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Gi(e);return n.forEach(o=>{let a=Yt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){let i=Gi(e);return y.forEach(n,s=>{let o=Yt(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Gi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Gi(e),s=te();return i.Y({range:r,J:!0},(o,a,c)=>{let l=br(o[1]),u=new R(l);s=s.add(u)}).next(()=>s)}containsKey(e,n){let r=Yt(n.path),i=IDBKeyRange.bound([r],[Z1(r)],!1,!0),s=0;return Gi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return tc(e).get(n).next(r=>r?rd(r):null)}};function tc(t){return It(t,"targets")}function N1(t){return It(t,"targetGlobal")}function Gi(t){return It(t,"targetDocuments")}function P1([t,e],[n,r]){let i=ee(t,n);return i===0?ee(e,r):i}var b0=class{constructor(e){this.Kn=e,this.buffer=new xe(P1),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();P1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},T0=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){os(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield ss(n)}yield this.zn(3e5)}))}},S0=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(vn._e);let r=new b0(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(R1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),R1):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(l=Date.now(),nc()<=In.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function u5(t,e){return new S0(t,e)}var A0=class{constructor(e,n){this.db=e,this.garbageCollector=u5(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Fg(e,r)}removeReference(e,n,r){return Fg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Fg(e,n)}er(e,n){return function(i,s){let o=!1;return ZO(i).Z(a=>YO(i,a,s).next(c=>(c&&(o=!0),y.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,q.min()),Gi(e).delete(function(d){return[0,Yt(d.path)]}(o))))});i.push(c)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Fg(e,n)}Xn(e,n){let r=Gi(e),i,s=vn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==vn._e&&n(new R(br(i)),s),s=l,i=c):s=vn._e}).next(()=>{s!==vn._e&&n(new R(br(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Fg(t,e){return Gi(t).put(function(r,i){return{targetId:0,path:Yt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var fm=class{constructor(){this.changes=new Nr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,lt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var x0=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return to(e).put(r)}removeEntry(e,n,r){return to(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],am(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=lt.newInvalidDocument(n);return to(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ed(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:lt.newInvalidDocument(n)};return to(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ed(n))},(i,s)=>{r={document:this.nr(n,s),size:dm(s)}}).next(()=>r)}getEntries(e,n){let r=cn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=cn(),i=new Oe(R.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,dm(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return y.resolve();let i=new xe(F1);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(ed(i.first()),ed(i.last())),o=i.getIterator(),a=o.getNext();return to(e).Y({index:"documentKeyIndex",range:s},(c,l,u)=>{let d=R.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&F1(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.U(ed(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),am(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return to(e).W(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let u=cn();for(let d of l){let h=this.nr(R.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Od(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=cn(),o=O1(n,r),a=O1(n,Ln.max());return to(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{let d=this.nr(R.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(d.key,d),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new M0(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return k1(e).get("remoteDocumentGlobalKey").next(n=>(B(!!n),n))}tr(e,n){return k1(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=a5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(q.min())))return r}return lt.newInvalidDocument(e)}};function XO(t){return new x0(t)}var M0=class extends fm{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Nr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new xe((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=E1(this.ar.serializer,o);i=i.add(s.path.popLast());let l=dm(c);r+=l-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=E1(this.ar.serializer,o.convertToNoDocument(q.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function k1(t){return It(t,"remoteDocumentGlobal")}function to(t){return It(t,"remoteDocumentsV14")}function ed(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function O1(t,e){let n=e.documentKey.path.toArray();return[t,am(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function F1(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ee(n[s],r[s]),i)return i;return i=ee(n.length,r.length),i||(i=ee(n[n.length-2],r[r.length-2]),i||ee(n[n.length-1],r[r.length-1]))}var R0=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var pm=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&od(r.mutation,i,wn.empty(),Be.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=Tr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=nd();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Tr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=cn(),o=sd(),a=function(){return sd()}();return n.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof Jn)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),od(u.mutation,l,u.mutation.getFieldMask(),Be.now())):o.set(l.key,wn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var d;return a.set(l,new R0(u,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=sd(),i=new Oe((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=n.get(c);if(l===null)return;let u=r.get(c)||wn.empty();u=a.applyToLocalView(l,u),r.set(c,u);let d=(i.get(a.batchId)||te()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,d=EO();u.forEach(h=>{if(!s.has(h)){let f=xO(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return R.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):OD(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(Tr()),a=-1,c=s;return o.next(l=>y.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?y.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,te())).next(u=>({batchId:a,changes:wO(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new R(n)).next(r=>{let i=nd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=nd();return this.indexManager.getCollectionParents(e,s).next(a=>y.forEach(a,c=>{let l=function(d,h){return new Xn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,lt.newInvalidDocument(u)))});let a=nd();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&od(u.mutation,l,wn.empty(),Be.now()),Od(n,l)&&(a=a.insert(c,l))}),a})}};var N0=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return y.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:VD(i.bundledQuery),readTime:Je(i.readTime)}}(n)),y.resolve()}};var P0=class{constructor(){this.overlays=new Oe(R.comparator),this.hr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Tr();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){let i=Tr(),s=n.length+1,o=new R(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Oe((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=Tr(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=Tr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return y.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yd(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Cd=class{constructor(){this.Pr=new xe(ot.Ir),this.Tr=new xe(ot.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new ot(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ot(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new R(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new R(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new ot(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ot=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return R.comparator(e.key,n.key)||ee(e.pr,n.pr)}static Er(e,n){return ee(e.pr,n.pr)||R.comparator(e.key,n.key)}};var k0=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new xe(ot.Ir)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new md(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ot(n,0),i=new ot(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(ee);return n.forEach(i=>{let s=new ot(i,0),o=new ot(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),y.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;R.isDocumentKey(s)||(s=s.child(""));let o=new ot(new R(s),0),a=new xe(ee);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),y.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){B(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return y.forEach(n.mutations,i=>{let s=new ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new ot(n,0),i=this.wr.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var O0=class{constructor(e){this.vr=e,this.docs=function(){return new Oe(R.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():lt.newInvalidDocument(n))}getEntries(e,n){let r=cn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():lt.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=cn(),o=n.path,a=new R(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||RD(J1(u),r)<=0||(i.has(u.key)||Od(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){L()}Fr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new F0(this)}getSize(e){return y.resolve(this.size)}},F0=class extends fm{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var L0=class{constructor(e){this.persistence=e,this.Mr=new Nr(n=>fo(n),Pd),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Cd,this.targetCount=0,this.Br=vc.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),y.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new vc(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.qn(n),y.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),y.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Nr.containsKey(n))}};var gm=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new vn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new L0(this),this.indexManager=new I0,this.remoteDocumentCache=function(i){return new O0(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new om(n),this.$r=new N0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new P0,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new k0(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new V0(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return y.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},V0=class extends Kg{constructor(e){super(),this.currentSequenceNumber=e}},mm=class t{constructor(e){this.persistence=e,this.zr=new Cd,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw L()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),y.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Jr,r=>{let i=R.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,q.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return y.or([()=>y.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var j0=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Qg("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Jk,{unique:!0}),c.createObjectStore("documentMutations")}(e),L1(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),L1(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:q.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").W().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Jk,{unique:!0});let d=l.store("mutations"),h=u.map(f=>d.put(f));return y.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:A9});l.createIndex("collectionPathOverlayIndex",x9,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",M9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:y9});l.createIndex("documentKeyIndex",_9),l.createIndex("collectionGroupIndex",v9)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:D9}).createIndex("sequenceNumberIndex",b9,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:T9}).createIndex("documentKeyIndex",S9,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=dm(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>y.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>y.forEach(a,c=>{B(c.userId===s.userId);let l=io(this.serializer,c);return QO(e,s.userId,l).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new ye(o),l=function(d){return[0,Yt(d)]}(c);s.push(n.get(l).next(u=>u?y.resolve():(d=>n.put({targetId:0,path:Yt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>y.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:C9});let r=n.store("collectionParents"),i=new Id,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Yt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new ye(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],l)=>{let u=br(a);return s(u.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=rd(i),o=zO(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new R(ye.fromString(d.document.name).popFirst(5)):d.noDocument?R.fromSegments(d.noDocument.path):d.unknownDocument?R.fromSegments(d.unknownDocument.path):L()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>y.waitFor(i))}si(e,n){let r=n.store("mutations"),i=XO(this.serializer),s=new gm(mm.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:te();io(this.serializer,c).keys().forEach(d=>u=u.add(d)),a.set(c.userId,u)}),y.forEach(a,(c,l)=>{let u=new at(l),d=cm.lt(this.serializer,u),h=s.getIndexManager(u),f=hm.lt(u,this.serializer,h,s.referenceDelegate);return new pm(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new dd(n,vn._e),c).next()})})}};function L1(t){t.createObjectStore("targetDocuments",{keyPath:E9}).createIndex("documentTargetsIndex",I9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",w9,{unique:!0}),t.createObjectStore("targetGlobal")}var MC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",U0=class t{constructor(e,n,r,i,s,o,a,c,l,u,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=u,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new I(_.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new A0(this,i),this.Ti=n+"main",this.serializer=new om(c),this.Ei=new ti(this.Ti,this.ui,new j0(this.serializer)),this.Qr=new D0(this.referenceDelegate,this.serializer),this.remoteDocumentCache=XO(this.serializer),this.$r=new g0,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,u===!1&&Ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new I(_.FAILED_PRECONDITION,MC);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new vn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Lg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(os(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return td(e).get("owner").next(n=>y.resolve(this.Si(n)))}bi(e){return Lg(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=It(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?y.resolve(!0):td(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new I(_.FAILED_PRECONDITION,MC);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lg(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new dd(e,vn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Lg(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return hm.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new C0(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return cm.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?N9:c===14?sO:c===13?iO:c===12?R9:c===11?rO:void L()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new dd(a,this.kr?this.kr.next():vn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new I(_.FAILED_PRECONDITION,eO);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return td(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new I(_.FAILED_PRECONDITION,MC)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return td(e).put("owner",n)}static D(){return ti.D()}yi(e){let n=td(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;dy()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ze("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function td(t){return It(t,"owner")}function Lg(t){return It(t,"clientMetadata")}function UD(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var B0=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var $0=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ym=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return dy()?8:ti.v(Bc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $0;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(nc()<=In.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",rc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),y.resolve()):(nc()<=In.DEBUG&&C("QueryEngine","Query:",rc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(nc()<=In.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",rc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zt(n))):y.resolve())}ji(e,n){if(u1(n))return y.resolve(null);let r=Zt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=nm(n,null,"F"),r=Zt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(n,a);return this.Xi(n,l,o,c.readTime)?this.ji(e,nm(n,null,"F")):this.es(e,l,n,c)}))})))}Hi(e,n,r,i){return u1(n)||i.isEqual(q.min())?y.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?y.resolve(null):(nc()<=In.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),rc(n)),this.es(e,o,n,X1(i,-1)).next(a=>a))})}Zi(e,n){let r=new xe(_O(e));return n.forEach((i,s)=>{Od(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return nc()<=In.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",rc(n)),this.zi.getDocumentsMatchingQuery(e,n,Ln.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var q0=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Oe(ee),this.rs=new Nr(s=>fo(s),Pd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pm(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function JO(t,e,n,r){return new q0(t,e,n,r)}function eF(t,e){return v(this,null,function*(){let n=k(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=te();for(let l of i){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function d5(t,e){let n=k(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){let d=l.batch,h=d.keys(),f=y.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(c,p)).next(g=>{let m=l.docVersions.get(p);B(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,l),g.isValidDocument()&&(g.setReadTime(l.commitVersion),u.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=te();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function tF(t){let e=k(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function h5(t,e){let n=k(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((u,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,u.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Et.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(d,f),function(g,m,w){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(h,f,u)&&a.push(n.Qr.updateTargetData(s,f))});let c=cn(),l=te();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(nF(s,o,e.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!r.isEqual(q.min())){let u=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.ns=i,s))}function nF(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=cn();return n.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(q.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function f5(t,e){let n=k(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wc(t,e){let n=k(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new _c(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Ec(t,e,n){return v(this,null,function*(){let r=k(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!os(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function _m(t,e,n){let r=k(t),i=q.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){let d=k(c),h=d.rs.get(u);return h!==void 0?y.resolve(d.ns.get(h)):d.Qr.getTargetData(l,u)}(r,o,Zt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:q.min(),n?s:te())).next(a=>(sF(r,yO(e),a),{documents:a,hs:s})))}function rF(t,e){let n=k(t),r=k(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function iF(t,e){let n=k(t),r=n.ss.get(e)||q.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,X1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(sF(n,e,i),i))}function sF(t,e,n){let r=t.ss.get(e)||q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function p5(t,e,n,r){return v(this,null,function*(){let i=k(t),s=te(),o=cn();for(let l of n){let u=e.Ps(l.metadata.name);l.document&&(s=s.add(u));let d=e.Is(l);d.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(u,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield wc(i,function(u){return Zt(Ac(ye.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>nF(l,a,o).next(u=>(a.apply(l),u)).next(u=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,u.cs,u.ls)).next(()=>u.cs)))})}function g5(r,i){return v(this,arguments,function*(t,e,n=te()){let s=yield wc(t,Zt(VD(e.bundledQuery))),o=k(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Je(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Et.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function V1(t,e){return`firestore_clients_${t}_${e}`}function j1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function RC(t,e){return`firestore_targets_${t}_${e}`}var vm=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new I(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ad=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new I(r.error.code,r.error.message))),s?new t(e,r.state,i):(Ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},wm=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=FD();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=tO(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},H0=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},Dd=class{constructor(){this.activeTargetIds=FD()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},cd=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Oe(ee),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=V1(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Dd),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(V1(this.persistenceKey,r));if(i){let s=wm.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(RC(this.persistenceKey,e));if(r){let i=ad.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(RC(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=vn._e;if(s!=null)try{let a=JSON.parse(s);B(typeof a=="number"),o=a}catch(a){Ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==vn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new vm(this.currentUser,e,n,r),s=j1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=j1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=RC(this.persistenceKey,e),s=new ad(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return wm.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return vm.Es(new at(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return ad.Es(i,n)}xs(e){return H0.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=FD();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Em=class{constructor(){this.no=new Dd,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Dd,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var G0=class{io(e){}shutdown(){}};var Im=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Vg=null;function NC(){return Vg===null?Vg=function(){return 268435456+Math.round(2147483648*Math.random())}():Vg++,"0x"+Vg.toString(16)}var m5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var z0=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Lt="WebChannelConnection",W0=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=NC(),c=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(l,s,o),this.Co(n,c,l,i).then(u=>(C("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Fn("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=m5[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=NC();return new Promise((o,a)=>{let c=new Kk;c.setWithCredentials(!0),c.listenOnce(zk.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case kg.NO_ERROR:let u=c.getResponseJson();C(Lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case kg.TIMEOUT:C(Lt,`RPC '${e}' ${s} timed out`),a(new I(_.DEADLINE_EXCEEDED,"Request time out"));break;case kg.HTTP_ERROR:let d=c.getStatus();if(C(Lt,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let w=m.toLowerCase().replace(/_/g,"-");return Object.values(_).indexOf(w)>=0?w:_.UNKNOWN}(f.status);a(new I(p,f.message))}else a(new I(_.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new I(_.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{C(Lt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);C(Lt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",l,r,15)})}Fo(e,n,r){let i=NC(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Hk(),a=Gk(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let u=s.join("");C(Lt,`Creating RPC '${e}' stream ${i}: ${u}`,c);let d=o.createWebChannel(u,c),h=!1,f=!1,p=new z0({lo:m=>{f?C(Lt,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(C(Lt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Lt,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},ho:()=>d.close()}),g=(m,w,O)=>{m.listen(w,S=>{try{O(S)}catch(V){setTimeout(()=>{throw V},0)}})};return g(d,Zu.EventType.OPEN,()=>{f||C(Lt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,Zu.EventType.CLOSE,()=>{f||(f=!0,C(Lt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,Zu.EventType.ERROR,m=>{f||(f=!0,Fn(Lt,`RPC '${e}' stream ${i} transport errored:`,m),p.Vo(new I(_.UNAVAILABLE,"The operation could not be completed")))}),g(d,Zu.EventType.MESSAGE,m=>{var w;if(!f){let O=m.data[0];B(!!O);let S=O,V=S.error||((w=S[0])===null||w===void 0?void 0:w.error);if(V){C(Lt,`RPC '${e}' stream ${i} received error:`,V);let H=V.status,z=function(cy){let Hd=st[cy];if(Hd!==void 0)return NO(Hd)}(H),Ee=V.message;z===void 0&&(z=_.INTERNAL,Ee="Unknown error status: "+H+" with message "+V.message),f=!0,p.Vo(new I(z,Ee)),d.close()}else C(Lt,`RPC '${e}' stream ${i} received:`,O),p.mo(O)}}),g(a,Wk.STAT_EVENT,m=>{m.stat===AC.PROXY?C(Lt,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===AC.NOPROXY&&C(Lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function oF(){return typeof window<"u"?window:null}function qg(){return typeof document<"u"?document:null}function Fd(t){return new u0(t,!0)}var bd=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var Cm=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new bd(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===_.RESOURCE_EXHAUSTED?(Ze(n.toString()),Ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===_.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new I(_.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},K0=class extends Cm{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=e5(this.serializer,e),r=function(s){if(!("targetChange"in s))return q.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?q.min():o.readTime?Je(o.readTime):q.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=f0(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=em(c)?{documents:UO(s,c)}:{query:BO(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=kO(s,o.resumeToken);let l=d0(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(q.min())>0){a.readTime=yc(s,o.snapshotVersion.toTimestamp());let l=d0(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=n5(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=f0(this.serializer),n.removeTarget=e,this.t_(n)}},Q0=class extends Cm{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(B(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=t5(e.writeResults,e.commitTime),r=Je(e.commitTime);return this.listener.T_(r,n)}return B(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=f0(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Ed(this.serializer,r))};this.t_(n)}};var Y0=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new I(_.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,h0(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(_.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,h0(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(_.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var Z0=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ze(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var X0=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){as(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(c){return v(this,null,function*(){let l=k(c);l.v_.add(4),yield xc(l),l.x_.set("Unknown"),l.v_.delete(4),yield Ld(l)})}(this))}))}),this.x_=new Z0(r,i)}};function Ld(t){return v(this,null,function*(){if(as(t))for(let e of t.F_)yield e(!0)})}function xc(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function $m(t,e){let n=k(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),qD(n)?$D(n):Rc(n).Jo()&&BD(n,e))}function Td(t,e){let n=k(t),r=Rc(n);n.C_.delete(e),r.Jo()&&aF(n,e),n.C_.size===0&&(r.Jo()?r.Xo():as(n)&&n.x_.set("Unknown"))}function BD(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Rc(t).c_(e)}function aF(t,e){t.O_.Oe(e),Rc(t).l_(e)}function $D(t){t.O_=new l0({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Rc(t).start(),t.x_.p_()}function qD(t){return as(t)&&!Rc(t).Ho()&&t.C_.size>0}function as(t){return k(t).v_.size===0}function cF(t){t.O_=void 0}function y5(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{BD(t,e)})})}function _5(t,e){return v(this,null,function*(){cF(t),qD(t)?(t.x_.S_(e),$D(t)):t.x_.set("Unknown")})}function v5(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof im&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Dm(t,r)}else if(e instanceof uc?t.O_.$e(e):e instanceof rm?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(q.min()))try{let r=yield tF(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.C_.get(l);u&&s.C_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.C_.get(c);if(!u)return;s.C_.set(c,u.withResumeToken(Et.EMPTY_BYTE_STRING,u.snapshotVersion)),aF(s,c);let d=new _c(u.target,c,l,u.sequenceNumber);BD(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield Dm(t,r)}})}function Dm(t,e,n){return v(this,null,function*(){if(!os(e))throw e;t.v_.add(1),yield xc(t),t.x_.set("Offline"),n||(n=()=>tF(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Ld(t)}))})}function lF(t,e){return e().catch(n=>Dm(t,n,e))}function Mc(t){return v(this,null,function*(){let e=k(t),n=is(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;w5(e);)try{let i=yield f5(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,E5(e,i)}catch(i){yield Dm(e,i)}uF(e)&&dF(e)})}function w5(t){return as(t)&&t.D_.length<10}function E5(t,e){t.D_.push(e);let n=is(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function uF(t){return as(t)&&!is(t).Ho()&&t.D_.length>0}function dF(t){is(t).start()}function I5(t){return v(this,null,function*(){is(t).d_()})}function C5(t){return v(this,null,function*(){let e=is(t);for(let n of t.D_)e.I_(n.mutations)})}function D5(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=o0.from(r,e,n);yield lF(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Mc(t)})}function b5(t,e){return v(this,null,function*(){e&&is(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return RO(o)&&o!==_.ABORTED}(i.code)){let s=r.D_.shift();is(r).Zo(),yield lF(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Mc(r)}})}(t,e)),uF(t)&&dF(t)})}function U1(t,e){return v(this,null,function*(){let n=k(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=as(n);n.v_.add(3),yield xc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Ld(n)})}function J0(t,e){return v(this,null,function*(){let n=k(t);e?(n.v_.delete(2),yield Ld(n)):e||(n.v_.add(2),yield xc(n),n.x_.set("Unknown"))})}function Rc(t){return t.N_||(t.N_=function(n,r,i){let s=k(n);return s.R_(),new K0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:y5.bind(null,t),To:_5.bind(null,t),u_:v5.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),qD(t)?$D(t):t.x_.set("Unknown")):(yield t.N_.stop(),cF(t))}))),t.N_}function is(t){return t.B_||(t.B_=function(n,r,i){let s=k(n);return s.R_(),new Q0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:I5.bind(null,t),To:b5.bind(null,t),E_:C5.bind(null,t),T_:D5.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.B_.Zo(),yield Mc(t)):(yield t.B_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var eD=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(_.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Nc(t,e){if(Ze("AsyncQueue",`${e}: ${t}`),os(t))return new I(_.UNAVAILABLE,`${e}: ${t}`);throw t}var bm=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||R.comparator(n.key,r.key):(n,r)=>R.comparator(n.key,r.key),this.keyedMap=nd(),this.sortedSet=new Oe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Tm=class{constructor(){this.L_=new Oe(R.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):L():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ic=class t{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,bm.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var tD=class{constructor(){this.q_=void 0,this.Q_=[]}},nD=class{constructor(){this.queries=new Nr(e=>mO(e),kd),this.onlineState="Unknown",this.K_=new Set}};function HD(t,e){return v(this,null,function*(){let n=k(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new tD),i)try{s.q_=yield n.onListen(r)}catch(o){let a=Nc(o,`Initialization of query '${rc(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&zD(n)})}function GD(t,e){return v(this,null,function*(){let n=k(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function T5(t,e){let n=k(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&zD(n)}function S5(t,e,n){let r=k(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function zD(t){t.K_.forEach(e=>{e.next()})}var Sd=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ic(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=Ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var rD=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var Sm=class{constructor(e){this.serializer=e}Ps(e){return Ar(this.serializer,e)}Is(e){return e.metadata.exists?jO(this.serializer,e.document,!1):lt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Je(e)}},iD=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=hF(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=ye.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new Sm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield p5(this.localStore,new Sm(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield g5(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function hF(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Am=class{constructor(e){this.key=e}},xm=class{constructor(e){this.key=e}},Mm=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=te(),this.mutatedKeys=te(),this.ua=_O(e),this.ca=new bm(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new Tm,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let h=i.get(u),f=Od(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),m=!0,(c&&this.ua(f,c)>0||l&&this.ua(f,l)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(c||l)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((u,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return g(f)-g(p)}(u.type,d.type)||this.ua(u.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],c=this.aa.size===0&&this.current&&!i?1:0,l=c!==this._a;return this._a=c,o.length!==0||l?{snapshot:new Ic(this.query,e.ca,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Tm,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=te(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new xm(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new Am(r))}),n}Ra(e){this.oa=e.hs,this.aa=te();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return Ic.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},sD=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},oD=class{constructor(e){this.key=e,this.ma=!1}},aD=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new Nr(a=>mO(a),kd),this.pa=new Map,this.ya=new Set,this.wa=new Oe(R.comparator),this.Sa=new Map,this.ba=new Cd,this.Da={},this.Ca=new Map,this.va=vc.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function A5(t,e){return v(this,null,function*(){let n=ZD(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield wc(n.localStore,Zt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield WD(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&$m(n.remoteStore,o)}return i})}function WD(t,e,n,r,i){return v(this,null,function*(){t.Ma=(d,h,f)=>function(g,m,w,O){return v(this,null,function*(){let S=m.view.ha(w);S.Xi&&(S=yield _m(g.localStore,m.query,!1).then(({documents:Ee})=>m.view.ha(Ee,S)));let V=O&&O.targetChanges.get(m.targetId),H=O&&O.targetMismatches.get(m.targetId)!=null,z=m.view.applyChanges(S,g.isPrimaryClient,V,H);return cD(g,m.targetId,z.da),z.snapshot})}(t,d,h,f);let s=yield _m(t.localStore,e,!0),o=new Mm(e,s.hs),a=o.ha(s.documents),c=vd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);cD(t,n,l.da);let u=new sD(e,n,o);return t.ga.set(e,u),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),l.snapshot})}function x5(t,e){return v(this,null,function*(){let n=k(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!kd(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ec(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Td(n.remoteStore,r.targetId),Cc(n,r.targetId)}).catch(ss))):(Cc(n,r.targetId),yield Ec(n.localStore,r.targetId,!0))})}function M5(t,e,n){return v(this,null,function*(){let r=XD(t);try{let i=yield function(o,a){let c=k(o),l=Be.now(),u=a.reduce((f,p)=>f.add(p.key),te()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=cn(),g=te();return c.os.getEntries(f,u).next(m=>{p=m,p.forEach((w,O)=>{O.isValidDocument()||(g=g.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let w=[];for(let O of a){let S=W9(O,d.get(O.key).overlayedDocument);S!=null&&w.push(new Jn(O.key,S,lO(S.value.mapValue),We.exists(!0)))}return c.mutationQueue.addMutationBatch(f,l,w,a)}).next(m=>{h=m;let w=m.applyToLocalDocumentSet(d,g);return c.documentOverlayCache.saveOverlays(f,m.batchId,w)})}).then(()=>({batchId:h.batchId,changes:wO(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Da[o.currentUser.toKey()];l||(l=new Oe(ee)),l=l.insert(a,c),o.Da[o.currentUser.toKey()]=l}(r,i.batchId,n),yield oi(r,i.changes),yield Mc(r.remoteStore)}catch(i){let s=Nc(i,"Failed to persist write");n.reject(s)}})}function fF(t,e){return v(this,null,function*(){let n=k(t);try{let r=yield h5(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(B(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?B(o.ma):i.removedDocuments.size>0&&(B(o.ma),o.ma=!1))}),yield oi(n,r,e)}catch(r){yield ss(r)}})}function B1(t,e,n){let r=k(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=k(o);c.onlineState=a;let l=!1;c.queries.forEach((u,d)=>{for(let h of d.Q_)h.U_(a)&&(l=!0)}),l&&zD(c)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function R5(t,e,n){return v(this,null,function*(){let r=k(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Oe(R.comparator);o=o.insert(s,lt.newNoDocument(s,q.min()));let a=te().add(s),c=new _d(q.min(),new Map,new Oe(ee),o,a);yield fF(r,c),r.wa=r.wa.remove(s),r.Sa.delete(e),YD(r)}else yield Ec(r.localStore,e,!1).then(()=>Cc(r,e,n)).catch(ss)})}function N5(t,e){return v(this,null,function*(){let n=k(t),r=e.batch.batchId;try{let i=yield d5(n.localStore,e);QD(n,r,null),KD(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield oi(n,i)}catch(i){yield ss(i)}})}function P5(t,e,n){return v(this,null,function*(){let r=k(t);try{let i=yield function(o,a){let c=k(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(B(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,e);QD(r,e,n),KD(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield oi(r,i)}catch(i){yield ss(i)}})}function k5(t,e){return v(this,null,function*(){let n=k(t);as(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=k(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=Nc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function KD(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function QD(t,e,n){let r=k(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function Cc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||pF(t,r)})}function pF(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(Td(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),YD(t))}function cD(t,e,n){for(let r of n)r instanceof Am?(t.ba.addReference(r.key,e),O5(t,r)):r instanceof xm?(C("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||pF(t,r.key)):L()}function O5(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ya.add(r),YD(t))}function YD(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new R(ye.fromString(e)),r=t.va.next();t.Sa.set(r,new oD(n)),t.wa=t.wa.insert(n,r),$m(t.remoteStore,new _c(Zt(Ac(n.path)),r,"TargetPurposeLimboResolution",vn._e))}}function oi(t,e,n){return v(this,null,function*(){let r=k(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);let u=B0.Ki(c.targetId,l);s.push(u)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(c,l){return v(this,null,function*(){let u=k(c);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>y.forEach(l,h=>y.forEach(h.qi,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>y.forEach(h.Qi,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!os(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of l){let h=d.targetId;if(!d.fromCache){let f=u.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);u.ns=u.ns.insert(h,g)}}})}(r.localStore,s))})}function F5(t,e){return v(this,null,function*(){let n=k(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield eF(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(c=>{c.reject(new I(_.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield oi(n,r.us)}})}function L5(t,e){let n=k(t),r=n.Sa.get(e);if(r&&r.ma)return te().add(r.key);{let i=te(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function V5(t,e){return v(this,null,function*(){let n=k(t),r=yield _m(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&cD(n,e.targetId,i.da),i})}function j5(t,e){return v(this,null,function*(){let n=k(t);return iF(n.localStore,e).then(r=>oi(n,r))})}function U5(t,e,n,r){return v(this,null,function*(){let i=k(t),s=yield function(a,c){let l=k(a),u=k(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.vn(d,c).next(h=>h?l.localDocuments.getDocuments(d,h):y.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Mc(i.remoteStore):n==="acknowledged"||n==="rejected"?(QD(i,e,r||null),KD(i,e),function(a,c){k(k(a).mutationQueue).Mn(c)}(i.localStore,e)):L(),yield oi(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function B5(t,e){return v(this,null,function*(){let n=k(t);if(ZD(n),XD(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield $1(n,r.toArray());n.Fa=!0,yield J0(n.remoteStore,!0);for(let s of i)$m(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Cc(n,o),Ec(n.localStore,o,!0))),Td(n.remoteStore,o)}),yield i,yield $1(n,r),function(o){let a=k(o);a.Sa.forEach((c,l)=>{Td(a.remoteStore,l)}),a.ba.mr(),a.Sa=new Map,a.wa=new Oe(R.comparator)}(n),n.Fa=!1,yield J0(n.remoteStore,!1)}})}function $1(t,e,n){return v(this,null,function*(){let r=k(t),i=[],s=[];for(let o of e){let a,c=r.pa.get(o);if(c&&c.length!==0){a=yield wc(r.localStore,Zt(c[0]));for(let l of c){let u=r.ga.get(l),d=yield V5(r,u);d.snapshot&&s.push(d.snapshot)}}else{let l=yield rF(r.localStore,o);a=yield wc(r.localStore,l),yield WD(r,gF(l),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function gF(t){return gO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function $5(t){return function(n){return k(k(n).persistence).Li()}(k(t).localStore)}function q5(t,e,n,r){return v(this,null,function*(){let i=k(t);if(i.Fa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield iF(i.localStore,yO(s[0])),a=_d.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Et.EMPTY_BYTE_STRING);yield oi(i,o,a);break}case"rejected":yield Ec(i.localStore,e,!0),Cc(i,e,r);break;default:L()}})}function H5(t,e,n){return v(this,null,function*(){let r=ZD(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield rF(r.localStore,i),o=yield wc(r.localStore,s);yield WD(r,gF(s),o.targetId,!1,o.resumeToken),$m(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield Ec(r.localStore,i,!1).then(()=>{Td(r.remoteStore,i),Cc(r,i)}).catch(ss))}})}function ZD(t){let e=k(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=fF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=L5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=R5.bind(null,e),e.fa.u_=T5.bind(null,e.eventManager),e.fa.xa=S5.bind(null,e.eventManager),e}function XD(t){let e=k(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=N5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P5.bind(null,e),e}function G5(t,e,n){let r=k(t);(function(s,o,a){return v(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let g=k(f),m=Je(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",w=>g.$r.getBundleMetadata(w,p.id)).then(w=>!!w&&w.createTime.compareTo(m)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(hF(c));let l=new iD(c,s.localStore,o.serializer),u=yield o.Oa();for(;u;){let h=yield l.na(u);h&&a._updateProgress(h),u=yield o.Oa()}let d=yield l.complete();return yield oi(s,d.sa,void 0),yield function(f,p){let g=k(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.$r.saveBundleMetadata(m,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(c){return Fn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Ad=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=Fd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return JO(this.persistence,new ym,e.initialUser,this.serializer)}createPersistence(e){return new gm(mm.Hr,this.serializer)}createSharedClientState(e){return new Em}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Rm=class t extends Ad{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield ly(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield XD(this.Na.syncEngine),yield Mc(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return JO(this.persistence,new ym,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new T0(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new HC(n,this.persistence);return new qC(e.asyncQueue,r)}createPersistence(e){let n=UD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new U0(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,oF(),qg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Em}},lD=class t extends Rm{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield ly(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof cd&&(this.sharedClientState.syncEngine={Zs:U5.bind(null,n),Xs:q5.bind(null,n),eo:H5.bind(null,n),Li:$5.bind(null,n),Ys:j5.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield B5(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=oF();if(!cd.D(n))throw new I(_.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=UD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cd(n,e.asyncQueue,r,e.clientId,e.initialUser)}},xd=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>B1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=F5.bind(null,this.syncEngine),yield J0(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new nD}()}createDatastore(e){let n=Fd(e.databaseInfo.databaseId),r=function(s){return new W0(s)}(e.databaseInfo);return function(s,o,a,c){return new Y0(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new X0(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>B1(this.syncEngine,n,0),function(){return Im.D()?new Im:new G0}())}createSyncEngine(e,n){return function(i,s,o,a,c,l,u){let d=new aD(i,s,o,a,c,l);return u&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=k(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield xc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function q1(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Dc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):Ze("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var uD=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new ct,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Oa(){return v(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return v(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new rD(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return v(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return v(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var dD=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new I(_.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=k(i),a={documents:s.map(d=>wd(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ye.emptyPath(),a,s.length),l=new Map;c.forEach(d=>{let h=J9(o.serializer,d);l.set(h.key.toString(),h)});let u=[];return s.forEach(d=>{let h=l.get(d.toString());B(!!h),u.push(h)}),u})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new rs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=R.fromPath(r);this.mutations.push(new gd(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=k(r),o={writes:i.map(a=>Ed(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ye.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw L();n=q.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new I(_.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(q.min())?We.exists(!1):We.updateTime(n):We.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(q.min()))throw new I(_.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return We.updateTime(n)}return We.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var hD=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new bd(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>v(this,null,function*(){let e=new dD(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!Nd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!RO(n)}return!1}};var fD=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=at.UNAUTHENTICATED,this.clientId=zg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(_.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Nc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Hg(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield eF(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function pD(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield JD(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>U1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>U1(e.remoteStore,i)),t._onlineComponents=e})}function mF(t){return t.name==="FirebaseError"?t.code===_.FAILED_PRECONDITION||t.code===_.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function JD(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Hg(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!mF(n))throw n;Fn("Error using user provided cache. Falling back to memory cache: "+n),yield Hg(t,new Ad)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield Hg(t,new Ad);return t._offlineComponents})}function qm(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield pD(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield pD(t,new xd))),t._onlineComponents})}function yF(t){return JD(t).then(e=>e.persistence)}function eb(t){return JD(t).then(e=>e.localStore)}function _F(t){return qm(t).then(e=>e.remoteStore)}function tb(t){return qm(t).then(e=>e.syncEngine)}function z5(t){return qm(t).then(e=>e.datastore)}function bc(t){return v(this,null,function*(){let e=yield qm(t),n=e.eventManager;return n.onListen=A5.bind(null,e.syncEngine),n.onUnlisten=x5.bind(null,e.syncEngine),n})}function W5(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield yF(t),n=yield _F(t);return e.setNetworkEnabled(!0),function(i){let s=k(i);return s.v_.delete(0),Ld(s)}(n)}))}function K5(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield yF(t),n=yield _F(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=k(i);s.v_.add(0),yield xc(s),s.x_.set("Offline")})}(n)}))}function Q5(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(l,u){let d=k(l);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new I(_.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Nc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield eb(t),e,n)})),n.promise}function vF(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,c,l){let u=new Dc({next:h=>{o.enqueueAndForget(()=>GD(s,d));let f=h.docs.has(a);!f&&h.fromCache?l.reject(new I(_.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?l.reject(new I(_.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new Sd(Ac(a.path),u,{includeMetadataChanges:!0,Z_:!0});return HD(s,d)}(yield bc(t),t.asyncQueue,e,n,r)})),r.promise}function Y5(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield _m(i,s,!0),c=new Mm(s,a.hs),l=c.ha(a.documents),u=c.applyChanges(l,!1);o.resolve(u.snapshot)}catch(a){let c=Nc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield eb(t),e,n)})),n.promise}function wF(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,c,l){let u=new Dc({next:h=>{o.enqueueAndForget(()=>GD(s,d)),h.fromCache&&c.source==="server"?l.reject(new I(_.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new Sd(a,u,{includeMetadataChanges:!0,Z_:!0});return HD(s,d)}(yield bc(t),t.asyncQueue,e,n,r)})),r.promise}function Z5(t,e){let n=new Dc(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){k(i).K_.add(s),s.next()}(yield bc(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){k(i).K_.delete(s)}(yield bc(t),n)}))}}function X5(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?PO().encode(o):o,function(u,d){return new uD(u,d)}(function(u,d){if(u instanceof Uint8Array)return q1(u,d);if(u instanceof ArrayBuffer)return q1(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Fd(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){G5(yield tb(t),i,r)}))}function J5(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=k(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield eb(t),e)}))}function EF(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var H1=new Map;function nb(t,e,n){if(!n)throw new I(_.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function rb(t,e,n,r){if(e===!0&&r===!0)throw new I(_.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function G1(t){if(!R.isDocumentKey(t))throw new I(_.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function z1(t){if(R.isDocumentKey(t))throw new I(_.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Hm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":L()}function _e(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(_.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Hm(t);throw new I(_.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function IF(t,e){if(e<=0)throw new I(_.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Nm=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(_.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=EF((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},yo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PC;switch(r.type){case"firstParty":return new LC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(_.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=H1.get(n);r&&(C("ComponentProvider","Removing Datastore"),H1.delete(n),r.terminate())}(this),Promise.resolve()}};function CF(t,e,n,r={}){var i;let s=(t=_e(t,yo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=at.MOCK_USER;else{a=Wd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new I(_.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new at(l)}t._authCredentials=new kC(new Gg(a,c))}}var xt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Pe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},xr=class t extends xt{constructor(e,n,r){super(e,n,Ac(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new R(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function ib(t,e,...n){if(t=ue(t),nb("collection","path",e),t instanceof yo){let r=ye.fromString(e,...n);return z1(r),new xr(t,null,r)}{if(!(t instanceof Pe||t instanceof xr))throw new I(_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return z1(r),new xr(t.firestore,null,r)}}function DF(t,e){if(t=_e(t,yo),nb("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(_.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new xt(t,null,function(r){return new Xn(ye.emptyPath(),r)}(e))}function Vd(t,e,...n){if(t=ue(t),arguments.length===1&&(e=zg.newId()),nb("doc","path",e),t instanceof yo){let r=ye.fromString(e,...n);return G1(r),new Pe(t,null,new R(r))}{if(!(t instanceof Pe||t instanceof xr))throw new I(_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return G1(r),new Pe(t.firestore,t instanceof xr?t.converter:null,new R(r))}}function sb(t,e){return t=ue(t),e=ue(e),(t instanceof Pe||t instanceof xr)&&(e instanceof Pe||e instanceof xr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function ob(t,e){return t=ue(t),e=ue(e),t instanceof xt&&e instanceof xt&&t.firestore===e.firestore&&kd(t._query,e._query)&&t.converter===e.converter}var gD=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new bd(this,"async_queue_retry"),this._u=()=>{let n=qg();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=qg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=qg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new ct;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return v(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!os(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=eD.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&L()}verifyOperationInProgress(){}hu(){return v(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function mD(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var yD=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ct,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var bF=-1,Ve=class extends yo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new gD}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||TF(this),this._firestoreClient.terminate()}};function ft(t){return t._firestoreClient||TF(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function TF(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,l,u){return new GC(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,EF(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new fD(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function SF(t,e){FF(t=_e(t,Ve));let n=ft(t);if(n._uninitializedComponentsProvider)throw new I(_.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new xd;return xF(n,i,new Rm(i,r.cacheSizeBytes,e?.forceOwnership))}function AF(t){FF(t=_e(t,Ve));let e=ft(t);if(e._uninitializedComponentsProvider)throw new I(_.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new xd;return xF(e,r,new lD(r,n.cacheSizeBytes))}function xF(t,e,n){let r=new ct;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield Hg(t,n),yield pD(t,e),r.resolve()}catch(i){let s=i;if(!mF(s))throw s;Fn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function MF(t){if(t._initialized&&!t._terminated)throw new I(_.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ct;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!ti.D())return Promise.resolve();let i=r+"main";yield ti.delete(i)})}(UD(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function RF(t){return function(n){let r=new ct;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return k5(yield tb(n),r)})),r.promise}(ft(t=_e(t,Ve)))}function NF(t){return W5(ft(t=_e(t,Ve)))}function PF(t){return K5(ft(t=_e(t,Ve)))}function kF(t,e){let n=ft(t=_e(t,Ve)),r=new yD;return X5(n,t._databaseId,e,r),r}function OF(t,e){return J5(ft(t=_e(t,Ve)),e).then(n=>n?new xt(t,null,n.query):null)}function FF(t){if(t._initialized||t._terminated)throw new I(_.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Et.fromBase64String(e))}catch(n){throw new I(_.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var er=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ii=class{constructor(e){this._methodName=e}};var _o=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var e6=/^__.*__$/,_D=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Jn(e,this.data,this.fieldMask,n,this.fieldTransforms):new ns(e,this.data,n,this.fieldTransforms)}},Pm=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Jn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function LF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}var km=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return Om(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(LF(this.du)&&e6.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},vD=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Fd(e)}Su(e,n,r,i=!1){return new km({du:e,methodName:n,wu:r,path:Xe.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Io(t){let e=t._freezeSettings(),n=Fd(t._databaseId);return new vD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Gm(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);lb("Data must be an object, but it was:",o,r);let a=UF(r,o),c,l;if(s.merge)c=new wn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=DD(e,d,n);if(!o.contains(h))throw new I(_.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);$F(u,h)||u.push(h)}c=new wn(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new _D(new Vt(a),c,l)}var Md=class t extends ii{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function VF(t,e,n){return new km({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var wD=class t extends ii{_toFieldTransform(e){return new po(e.path,new es)}isEqual(e){return e instanceof t}},ED=class t extends ii{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=VF(this,e,!0),r=this.bu.map(s=>Co(s,n)),i=new ni(r);return new po(e.path,i)}isEqual(e){return e instanceof t&&hy(this.bu,e.bu)}},ID=class t extends ii{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=VF(this,e,!0),r=this.bu.map(s=>Co(s,n)),i=new ri(r);return new po(e.path,i)}isEqual(e){return e instanceof t&&hy(this.bu,e.bu)}},CD=class t extends ii{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new ts(e.serializer,DO(e.serializer,this.Du));return new po(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function ab(t,e,n,r){let i=t.Su(1,e,n);lb("Data must be an object, but it was:",i,r);let s=[],o=Vt.empty();Eo(r,(c,l)=>{let u=ub(e,c,n);l=ue(l);let d=i.fu(u);if(l instanceof Md)s.push(u);else{let h=Co(l,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new wn(s);return new Pm(o,a,i.fieldTransforms)}function cb(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[DD(e,r,n)],c=[i];if(s.length%2!=0)throw new I(_.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(DD(e,s[h])),c.push(s[h+1]);let l=[],u=Vt.empty();for(let h=a.length-1;h>=0;--h)if(!$F(l,a[h])){let f=a[h],p=c[h];p=ue(p);let g=o.fu(f);if(p instanceof Md)l.push(f);else{let m=Co(p,g);m!=null&&(l.push(f),u.set(f,m))}}let d=new wn(l);return new Pm(u,d,o.fieldTransforms)}function jF(t,e,n,r=!1){return Co(n,t.Su(r?4:3,e))}function Co(t,e){if(BF(t=ue(t)))return lb("Unsupported field value:",e,t),UF(t,e);if(t instanceof ii)return function(r,i){if(!LF(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Co(a,i.gu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return DO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Be.fromDate(r);return{timestampValue:yc(i.serializer,s)}}if(r instanceof Be){let s=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yc(i.serializer,s)}}if(r instanceof _o)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pr)return{bytesValue:kO(i.serializer,r._byteString)};if(r instanceof Pe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:LD(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${Hm(r)}`)}(t,e)}function UF(t,e){let n={};return oO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Eo(t,(r,i)=>{let s=Co(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function BF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof _o||t instanceof Pr||t instanceof Pe||t instanceof ii)}function lb(t,e,n){if(!BF(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Hm(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function DD(t,e,n){if((e=ue(e))instanceof er)return e._internalPath;if(typeof e=="string")return ub(t,e);throw Om("Field path arguments must be of type string or ",t,!1,void 0,n)}var t6=new RegExp("[~\\*/\\[\\]]");function ub(t,e,n){if(e.search(t6)>=0)throw Om(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new er(...e.split("."))._internalPath}catch{throw Om(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Om(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new I(_.INVALID_ARGUMENT,a+t+c)}function $F(t,e){return t.some(n=>n.isEqual(e))}var vo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new bD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(zm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},bD=class extends vo{data(){return super.data()}};function zm(t,e){return typeof e=="string"?ub(t,e):e instanceof er?e._internalPath:e._delegate._internalPath}function qF(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(_.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rd=class{},wo=class extends Rd{};function ai(t,e,...n){let r=[];e instanceof Rd&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof TD).length,a=s.filter(c=>c instanceof Fm).length;if(o>1||o>0&&a>0)throw new I(_.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Fm=class t extends wo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return JF(e._query,n),new xt(e.firestore,e.converter,i0(e._query,n))}_parse(e){let n=Io(e.firestore);return function(s,o,a,c,l,u,d){let h;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new I(_.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){K1(d,u);let f=[];for(let p of d)f.push(W1(c,s,p));h={arrayValue:{values:f}}}else h=W1(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||K1(d,u),h=jF(a,o,d,u==="in"||u==="not-in");return fe.create(l,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function HF(t,e,n){let r=e,i=zm("where",t);return Fm._create(i,r,n)}var TD=class t extends Rd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:be.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)JF(o,c),o=i0(o,c)}(e._query,n),new xt(e.firestore,e.converter,i0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var SD=class t extends wo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new I(_.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new I(_.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ho(s,o)}(e._query,this._field,this._direction);return new xt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Xn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function GF(t,e="asc"){let n=e,r=zm("orderBy",t);return SD._create(r,n)}var Lm=class t extends wo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new xt(e.firestore,e.converter,nm(e._query,this._limit,this._limitType))}};function zF(t){return IF("limit",t),Lm._create("limit",t,"F")}function WF(t){return IF("limitToLast",t),Lm._create("limitToLast",t,"L")}var Vm=class t extends wo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=XF(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(i,s){return new Xn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function KF(...t){return Vm._create("startAt",t,!0)}function QF(...t){return Vm._create("startAfter",t,!1)}var jm=class t extends wo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=XF(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(i,s){return new Xn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function YF(...t){return jm._create("endBefore",t,!1)}function ZF(...t){return jm._create("endAt",t,!0)}function XF(t,e,n,r){if(n[0]=ue(n[0]),n[0]instanceof vo)return function(s,o,a,c,l){if(!c)throw new I(_.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let u=[];for(let d of lc(s))if(d.field.isKeyField())u.push(uo(o,c.key));else{let h=c.data.field(d.field);if(Bm(h))throw new I(_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new I(_.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Rr(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Io(t.firestore);return function(o,a,c,l,u,d){let h=o.explicitOrderBy;if(u.length>h.length)throw new I(_.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<u.length;p++){let g=u[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new I(_.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof g}`);if(!OD(o)&&g.indexOf("/")!==-1)throw new I(_.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(ye.fromString(g));if(!R.isDocumentKey(m))throw new I(_.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let w=new R(m);f.push(uo(a,w))}else{let m=jF(c,l,g);f.push(m)}}return new Rr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function W1(t,e,n){if(typeof(n=ue(n))=="string"){if(n==="")throw new I(_.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!OD(e)&&n.indexOf("/")!==-1)throw new I(_.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ye.fromString(n));if(!R.isDocumentKey(r))throw new I(_.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uo(t,new R(r))}if(n instanceof Pe)return uo(t,n._key);throw new I(_.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hm(n)}.`)}function K1(t,e){if(!Array.isArray(t)||t.length===0)throw new I(_.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JF(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(_.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(_.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Tc=class{convertValue(e,n="none"){switch(lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw L()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Eo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new _o(ze(e.latitude),ze(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=PD(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(hd(e));default:return null}}convertTimestamp(e){let n=Yi(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ye.fromString(e);B(GO(r));let i=new Xi(r.get(1),r.get(3)),s=new R(r.popFirst(5));return i.isEqual(n)||Ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Wm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var AD=class extends Tc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};var ei=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vn=class extends vo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ki(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(zm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ki=class extends Vn{data(e={}){return super.data(e)}},tr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ei(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ki(this._firestore,this._userDataWriter,r.key,r,new ei(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Ki(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ei(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ki(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ei(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:n6(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function n6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}function db(t,e){return t instanceof Vn&&e instanceof Vn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof tr&&e instanceof tr&&t._firestore===e._firestore&&ob(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function eL(t){t=_e(t,Pe);let e=_e(t.firestore,Ve);return vF(ft(e),t._key).then(n=>gb(e,t,n))}var si=class extends Tc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};function tL(t){t=_e(t,Pe);let e=_e(t.firestore,Ve),n=ft(e),r=new si(e);return Q5(n,t._key).then(i=>new Vn(e,r,t._key,i,new ei(i!==null&&i.hasLocalMutations,!0),t.converter))}function nL(t){t=_e(t,Pe);let e=_e(t.firestore,Ve);return vF(ft(e),t._key,{source:"server"}).then(n=>gb(e,t,n))}function rL(t){t=_e(t,xt);let e=_e(t.firestore,Ve),n=ft(e),r=new si(e);return qF(t._query),wF(n,t._query).then(i=>new tr(e,r,t,i))}function iL(t){t=_e(t,xt);let e=_e(t.firestore,Ve),n=ft(e),r=new si(e);return Y5(n,t._query).then(i=>new tr(e,r,t,i))}function sL(t){t=_e(t,xt);let e=_e(t.firestore,Ve),n=ft(e),r=new si(e);return wF(n,t._query,{source:"server"}).then(i=>new tr(e,r,t,i))}function hb(t,e,n){t=_e(t,Pe);let r=_e(t.firestore,Ve),i=Wm(t.converter,e,n);return Pc(r,[Gm(Io(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,We.none())])}function fb(t,e,n,...r){t=_e(t,Pe);let i=_e(t.firestore,Ve),s=Io(i),o;return o=typeof(e=ue(e))=="string"||e instanceof er?cb(s,"updateDoc",t._key,e,n,r):ab(s,"updateDoc",t._key,e),Pc(i,[o.toMutation(t._key,We.exists(!0))])}function oL(t){return Pc(_e(t.firestore,Ve),[new rs(t._key,We.none())])}function aL(t,e){let n=_e(t.firestore,Ve),r=Vd(t),i=Wm(t.converter,e);return Pc(n,[Gm(Io(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,We.exists(!1))]).then(()=>r)}function pb(t,...e){var n,r,i;t=ue(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||mD(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(mD(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,l,u;if(t instanceof Pe)l=_e(t.firestore,Ve),u=Ac(t._key.path),c={next:d=>{e[o]&&e[o](gb(l,t,d))},error:e[o+1],complete:e[o+2]};else{let d=_e(t,xt);l=_e(d.firestore,Ve),u=d._query;let h=new si(l);c={next:f=>{e[o]&&e[o](new tr(l,h,d,f))},error:e[o+1],complete:e[o+2]},qF(t._query)}return function(h,f,p,g){let m=new Dc(g),w=new Sd(f,m,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return HD(yield bc(h),w)})),()=>{m.La(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return GD(yield bc(h),w)}))}}(ft(l),u,a,c)}function cL(t,e){return Z5(ft(t=_e(t,Ve)),mD(e)?e:{next:e})}function Pc(t,e){return function(r,i){let s=new ct;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return M5(yield tb(r),i,s)})),s.promise}(ft(t),e)}function gb(t,e,n){let r=n.docs.get(e._key),i=new si(t);return new Vn(t,i,e._key,r,new ei(n.hasPendingWrites,n.fromCache),e.converter)}var r6={maxAttempts:5};var Um=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Io(e)}set(e,n,r){this._verifyNotCommitted();let i=zi(e,this._firestore),s=Wm(i.converter,n,r),o=Gm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,We.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=zi(e,this._firestore),o;return o=typeof(n=ue(n))=="string"||n instanceof er?cb(this._dataReader,"WriteBatch.update",s._key,n,r,i):ab(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,We.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=zi(e,this._firestore);return this._mutations=this._mutations.concat(new rs(n._key,We.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(_.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function zi(t,e){if((t=ue(t)).firestore!==e)throw new I(_.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var xD=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Io(n)}get(n){let r=zi(n,this._firestore),i=new AD(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return L();let o=s[0];if(o.isFoundDocument())return new vo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new vo(this._firestore,i,r._key,null,r.converter);throw L()})}set(n,r,i){let s=zi(n,this._firestore),o=Wm(s.converter,r,i),a=Gm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=zi(n,this._firestore),a;return a=typeof(r=ue(r))=="string"||r instanceof er?cb(this._dataReader,"Transaction.update",o._key,r,i,s):ab(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=zi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=zi(e,this._firestore),r=new si(this._firestore);return super.get(e).then(i=>new Vn(this._firestore,r,n._key,i._document,new ei(!1,!1),n.converter))}};function lL(t,e,n){t=_e(t,Ve);let r=Object.assign(Object.assign({},r6),n);return function(s){if(s.maxAttempts<1)throw new I(_.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new ct;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let l=yield z5(s);new hD(s.asyncQueue,l,a,o,c).ja()})),c.promise}(ft(t),i=>e(new xD(t,i)),r)}function uL(){return new Md("deleteField")}function dL(){return new wD("serverTimestamp")}function hL(...t){return new ED("arrayUnion",t)}function fL(...t){return new ID("arrayRemove",t)}function pL(t){return new CD("increment",t)}(function(e,n=!0){(function(i){Sc=i})(Xd),ls(new ln("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ve(new OC(r.getProvider("auth-internal")),new jC(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new I(_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xi(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),jn(Yk,"4.4.3",e),jn(Yk,"4.4.3","esm2017")})();var i6="@firebase/firestore-compat",s6="0.3.26";function Eb(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new I("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function gL(){if(typeof Uint8Array>"u")throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function mL(){if(!aO())throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Km=class t{constructor(e){this._delegate=e}static fromBase64String(e){return mL(),new t(Pr.fromBase64String(e))}static fromUint8Array(e){return gL(),new t(Pr.fromUint8Array(e))}toBase64(){return mL(),this._delegate.toBase64()}toUint8Array(){return gL(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function mb(t){return o6(t,["next","error","complete"])}function o6(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var yb=class{enableIndexedDbPersistence(e,n){return SF(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return AF(e._delegate)}clearIndexedDbPersistence(e){return MF(e._delegate)}},Qm=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Fn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){CF(this._delegate,e,n,r)}enableNetwork(){return NF(this._delegate)}disableNetwork(){return PF(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,rb("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return RF(this._delegate)}onSnapshotsInSync(e){return cL(this._delegate,e)}get app(){if(!this._appCompat)throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Fc(this,ib(this._delegate,e))}catch(n){throw Xt(n,"collection()","Firestore.collection()")}}doc(e){try{return new kr(this,Vd(this._delegate,e))}catch(n){throw Xt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new So(this,DF(this._delegate,e))}catch(n){throw Xt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return lL(this._delegate,n=>e(new Ym(this,n)))}batch(){return ft(this._delegate),new Zm(new Um(this._delegate,e=>Pc(this._delegate,e)))}loadBundle(e){return kF(this._delegate,e)}namedQuery(e){return OF(this._delegate,e).then(n=>n?new So(this,n):null)}},kc=class extends Tc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Km(new Pr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return kr.forKey(n,this.firestore,null)}};function a6(t){Q1(t)}var Ym=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new kc(e)}get(e){let n=Do(e);return this._delegate.get(n).then(r=>new bo(this._firestore,new Vn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Do(e);return r?(Eb("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Do(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Do(e);return this._delegate.delete(n),this}},Zm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Do(e);return r?(Eb("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Do(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Do(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Oc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ki(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new To(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new kc(e),n),i.set(n,s)),s}};Oc.INSTANCES=new WeakMap;var kr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new kc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new I("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Pe(n._delegate,r,new R(e)))}static forKey(e,n,r){return new t(n,new Pe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Fc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Fc(this.firestore,ib(this._delegate,e))}catch(n){throw Xt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ue(e),e instanceof Pe?sb(this._delegate,e):!1}set(e,n){n=Eb("DocumentReference.set",n);try{return n?hb(this._delegate,e,n):hb(this._delegate,e)}catch(r){throw Xt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?fb(this._delegate,e):fb(this._delegate,e,n,...r)}catch(i){throw Xt(i,"updateDoc()","DocumentReference.update()")}}delete(){return oL(this._delegate)}onSnapshot(...e){let n=yL(e),r=_L(e,i=>new bo(this.firestore,new Vn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return pb(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=tL(this._delegate):e?.source==="server"?n=nL(this._delegate):n=eL(this._delegate),n.then(r=>new bo(this.firestore,new Vn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Xt(t,e,n){return t.message=t.message.replace(e,n),t}function yL(t){for(let e of t)if(typeof e=="object"&&!mb(e))return e;return{}}function _L(t,e){var n,r;let i;return mb(t[0])?i=t[0]:mb(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var bo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new kr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return db(this._delegate,e._delegate)}},To=class extends bo{data(e){let n=this._delegate.data(e);return this._delegate._converter||Y1(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},So=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new kc(e)}where(e,n,r){try{return new t(this.firestore,ai(this._delegate,HF(e,n,r)))}catch(i){throw Xt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,ai(this._delegate,GF(e,n)))}catch(r){throw Xt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,ai(this._delegate,zF(e)))}catch(n){throw Xt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,ai(this._delegate,WF(e)))}catch(n){throw Xt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,ai(this._delegate,KF(...e)))}catch(n){throw Xt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,ai(this._delegate,QF(...e)))}catch(n){throw Xt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,ai(this._delegate,YF(...e)))}catch(n){throw Xt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,ai(this._delegate,ZF(...e)))}catch(n){throw Xt(n,"endAt()","Query.endAt()")}}isEqual(e){return ob(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=iL(this._delegate):e?.source==="server"?n=sL(this._delegate):n=rL(this._delegate),n.then(r=>new jd(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=yL(e),r=_L(e,i=>new jd(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return pb(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},_b=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new To(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},jd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new So(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new To(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new _b(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new To(this._firestore,r))})}isEqual(e){return db(this._delegate,e._delegate)}},Fc=class t extends So{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new kr(this.firestore,e):null}doc(e){try{return e===void 0?new kr(this.firestore,Vd(this._delegate)):new kr(this.firestore,Vd(this._delegate,e))}catch(n){throw Xt(n,"doc()","CollectionReference.doc()")}}add(e){return aL(this._delegate,e).then(n=>new kr(this.firestore,n))}isEqual(e){return sb(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Do(t){return _e(t,Pe)}var vb=class t{constructor(...e){this._delegate=new er(...e)}static documentId(){return new t(Xe.keyField().canonicalString())}isEqual(e){return e=ue(e),e instanceof er?this._delegate._internalPath.isEqual(e._internalPath):!1}};var wb=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=dL();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=uL();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=hL(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=fL(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=pL(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var c6={Firestore:Qm,GeoPoint:_o,Timestamp:Be,Blob:Km,Transaction:Ym,WriteBatch:Zm,DocumentReference:kr,DocumentSnapshot:bo,Query:So,QueryDocumentSnapshot:To,QuerySnapshot:jd,CollectionReference:Fc,FieldPath:vb,FieldValue:wb,setLogLevel:a6,CACHE_SIZE_UNLIMITED:bF};function l6(t,e){t.INTERNAL.registerComponent(new ln("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},c6)))}function u6(t){l6(t,(e,n)=>new Qm(e,n,new yb)),t.registerVersion(i6,s6)}u6(Ct);function d6(t,e=ps){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function vL(t,e){return d6(t,e)}function h6(t,e){return vL(t,e).pipe(gs(void 0),Kc(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Db(t,e){return vL(t,e).pipe(j(n=>({payload:n,type:"query"})))}var Xm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=IL(r,n);return new ey(i,s,this.afs)}snapshotChanges(){return h6(this.ref,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?le(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return pe(this.ref.get(e)).pipe(Ye)}};function Jm(t,e){return Db(t,e).pipe(gs(void 0),Kc(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=s.find(d=>d.doc.ref.isEqual(a.ref)),u=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function wL(t,e,n){return Jm(t,n).pipe(ir((r,i)=>f6(r,i.map(s=>s.payload),e),[]),Wc(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function f6(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=p6(t,r))}),t}function Ib(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function p6(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Ib(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return Ib(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Ib(t,e.oldIndex,1);break}return t}function EL(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var ey=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Jm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(gs(void 0),Kc(),dt(([r,i])=>i.length>0||!r),j(([,r])=>r),Ye)}auditTrail(e){return this.stateChanges(e).pipe(ir((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=EL(e);return wL(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return Db(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?le(A({},r.data()),{[e.idField]:r.id}):r.data())),Ye)}get(e){return pe(this.query.get(e)).pipe(Ye)}add(e){return this.ref.add(e)}doc(e){return new Xm(this.ref.doc(e),this.afs)}},Cb=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Jm(this.query,this.afs.schedulers.outsideAngular).pipe(Ye):Jm(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),dt(n=>n.length>0),Ye)}auditTrail(e){return this.stateChanges(e).pipe(ir((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=EL(e);return wL(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return Db(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),Ye)}get(e){return pe(this.query.get(e)).pipe(Ye)}},g6=new N("angularfire2.enableFirestorePersistence"),m6=new N("angularfire2.firestore.persistenceSettings"),y6=new N("angularfire2.firestore.settings"),_6=new N("angularfire2.firestore.use-emulator");function IL(t,e=n=>n){return{query:e(t),ref:t}}var Lc=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,g,m,w,O){this.schedulers=c;let S=Fs(n,a,r),V=u;d&&Al(S,a,h,p,g,m,f,w),[this.firestore,this.persistenceEnabled$]=va(`${S.name}.firestore`,"AngularFirestore",S.name,()=>{let H=a.runOutsideAngular(()=>S.firestore());if(s&&H.settings(s),V&&H.useEmulator(...V),i&&!Ps(o)){let z=()=>{try{return pe(H.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Ee){return typeof console<"u"&&console.warn(Ee),U(!1)}};return[H,a.runOutsideAngular(z)]}else return[H,U(!1)]},[s,V,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=IL(i,r),a=this.schedulers.ngZone.run(()=>s);return new ey(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Cb(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Xm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(Di),E(bi,8),E(g6,8),E(y6,8),E(gt),E(de),E(_a),E(m6,8),E(_6,8),E(Kf,8),E(Il,8),E(Cl,8),E(Dl,8),E(bl,8),E(Tl,8),E(Sl,8),E(Kr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var CL=(()=>{let e=class e{constructor(r){this.firestore=r,this.tipos=[],this.tipos=[{id:0,descripcion:"Sin definir"},{id:1,descripcion:"Clientes Activos"},{id:2,descripcion:"Clientes Inactivos"},{id:3,descripcion:"Clientes Deudores"}]}getClientes(){return this.firestore.collection("clientes").snapshotChanges()}getTipos(){return this.tipos}createCliente(r){return this.firestore.collection("clientes").add(Object.assign({},r))}updateCliente(r){this.firestore.doc("clientes/"+r.id).update(r)}deleteCliente(r){this.firestore.doc("clientes/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(Lc))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var NL=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ie(Hr),ie(dr))},e.\u0275dir=Tt({type:e});let t=e;return t})(),iy=(()=>{let e=class e extends NL{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275dir=Tt({type:e,features:[Gr]});let t=e;return t})(),qd=new N("");var w6={provide:qd,useExisting:Ei(()=>cs),multi:!0};function E6(){let t=fr()?fr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var I6=new N(""),cs=(()=>{let e=class e extends NL{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!E6())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(ie(Hr),ie(dr),ie(I6,8))},e.\u0275dir=Tt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&je("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[fa([w6]),Gr]});let t=e;return t})();var C6=new N(""),D6=new N("");function PL(t){return t!=null}function kL(t){return xs(t)?pe(t):t}function OL(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function FL(t,e){return e.map(n=>n(t))}function b6(t){return!t.validate}function LL(t){return t.map(e=>b6(e)?e:n=>e.validate(n))}function T6(t){if(!t)return null;let e=t.filter(PL);return e.length==0?null:function(n){return OL(FL(n,e))}}function VL(t){return t!=null?T6(LL(t)):null}function S6(t){if(!t)return null;let e=t.filter(PL);return e.length==0?null:function(n){let r=FL(n,e).map(kL);return Ny(r).pipe(j(OL))}}function jL(t){return t!=null?S6(LL(t)):null}function DL(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function A6(t){return t._rawValidators}function x6(t){return t._rawAsyncValidators}function Tb(t){return t?Array.isArray(t)?t:[t]:[]}function ny(t,e){return Array.isArray(t)?t.includes(e):t===e}function bL(t,e){let n=Tb(e);return Tb(t).forEach(i=>{ny(n,i)||n.push(i)}),n}function TL(t,e){return Tb(e).filter(n=>!ny(t,n))}var ry=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=VL(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=jL(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Sb=class extends ry{get formDirective(){return null}get path(){return null}},$d=class extends ry{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ab=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},M6={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Lre=le(A({},M6),{"[class.ng-submitted]":"isSubmitted"}),jc=(()=>{let e=class e extends Ab{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(ie($d,2))},e.\u0275dir=Tt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Ev("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Gr]});let t=e;return t})();var Ud="VALID",ty="INVALID",Vc="PENDING",Bd="DISABLED";function R6(t){return(sy(t)?t.validators:t)||null}function N6(t){return Array.isArray(t)?VL(t):t||null}function P6(t,e){return(sy(e)?e.asyncValidators:t)||null}function k6(t){return Array.isArray(t)?jL(t):t||null}function sy(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var xb=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ud}get invalid(){return this.status===ty}get pending(){return this.status==Vc}get disabled(){return this.status===Bd}get enabled(){return this.status!==Bd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(bL(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(bL(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(TL(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(TL(e,this._rawAsyncValidators))}hasValidator(e){return ny(this._rawValidators,e)}hasAsyncValidator(e){return ny(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Vc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Bd,this.errors=null,this._forEachChild(r=>{r.disable(le(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(le(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ud,this._forEachChild(r=>{r.enable(le(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(le(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ud||this.status===Vc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bd:Ud}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Vc,this._hasOwnPendingAsyncValidator=!0;let n=kL(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ht,this.statusChanges=new ht}_calculateStatus(){return this._allControlsDisabled()?Bd:this.errors?ty:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Vc)?Vc:this._anyControlsHaveStatus(ty)?ty:Ud}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){sy(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=N6(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=k6(this._rawAsyncValidators)}};var UL=new N("CallSetDisabledState",{providedIn:"root",factory:()=>Mb}),Mb="always";function O6(t,e){return[...e.path,t]}function F6(t,e,n=Mb){V6(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),j6(t,e),B6(t,e),U6(t,e),L6(t,e)}function SL(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function L6(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function V6(t,e){let n=A6(t);e.validator!==null?t.setValidators(DL(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=x6(t);e.asyncValidator!==null?t.setAsyncValidators(DL(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();SL(e._rawValidators,i),SL(e._rawAsyncValidators,i)}function j6(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&BL(t,e)})}function U6(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&BL(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function BL(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function B6(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function $6(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function q6(t){return Object.getPrototypeOf(t.constructor)===iy}function H6(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===cs?n=s:q6(s)?r=s:i=s}),i||r||n||null}function AL(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function xL(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var G6=class extends xb{constructor(e=null,n,r){super(R6(n),P6(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),sy(n)&&(n.nonNullable||n.initialValueIsDefault)&&(xL(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){AL(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){AL(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){xL(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var z6={provide:$d,useExisting:Ei(()=>Ao)},ML=Promise.resolve(),Ao=(()=>{let e=class e extends $d{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new G6,this._registered=!1,this.name="",this.update=new ht,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=H6(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),$6(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){F6(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){ML.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ns(i);ML.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?O6(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(ie(Sb,9),ie(C6,10),ie(D6,10),ie(qd,10),ie(Rs,8),ie(UL,8))},e.\u0275dir=Tt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[$t.None,"disabled","isDisabled"],model:[$t.None,"ngModel","model"],options:[$t.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[fa([z6]),Gr,bs]});let t=e;return t})();var W6={provide:qd,useExisting:Ei(()=>Rb),multi:!0},Rb=(()=>{let e=class e extends iy{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275dir=Tt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&je("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[fa([W6]),Gr]});let t=e;return t})();var K6={provide:qd,useExisting:Ei(()=>Uc),multi:!0};function $L(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function Q6(t){return t.split(":")[0]}var Uc=(()=>{let e=class e extends iy{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=$L(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=Q6(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275dir=Tt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&je("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[fa([K6]),Gr]});let t=e;return t})(),oy=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue($L(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ie(dr),ie(Hr),ie(Uc,9))},e.\u0275dir=Tt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),Y6={provide:qd,useExisting:Ei(()=>qL),multi:!0};function RL(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function Z6(t){return t.split(":")[0]}var qL=(()=>{let e=class e extends iy{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],u=this._getOptionValue(l.value);s.push(u)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let u=this._getOptionValue(l.value);s.push(u)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=Z6(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ii(e)))(s||e)}})(),e.\u0275dir=Tt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&je("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[fa([Y6]),Gr]});let t=e;return t})(),ay=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(RL(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(RL(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ie(dr),ie(Hr),ie(qL,9))},e.\u0275dir=Tt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var X6=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({});let t=e;return t})();var HL=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:UL,useValue:r.callSetDisabledState??Mb}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({imports:[X6]});let t=e;return t})();function J6(t,e){t&1&&(D(0,"div"),x(1,"No hay clientes registrados"),b())}function e8(t,e){if(t&1&&(D(0,"option",18),x(1),b()),t&2){let n=e.$implicit;da("value",n.id),K(),ha(" ",n.descripcion," ")}}function t8(t,e){if(t&1){let n=As();D(0,"div",7)(1,"p")(2,"label",8),x(3,"Nombre:"),b(),D(4,"input",9),Gt("ngModelChange",function(i){un(n);let s=Nt();return an(s.cliente.nombre,i)||(s.cliente.nombre=i),dn(i)}),b()(),D(5,"p")(6,"label",8),x(7,"RFC:"),b(),D(8,"input",9),Gt("ngModelChange",function(i){un(n);let s=Nt();return an(s.cliente.rfc,i)||(s.cliente.rfc=i),dn(i)}),b()(),D(9,"p")(10,"label",8),x(11,"Domicilio:"),b(),D(12,"input",9),Gt("ngModelChange",function(i){un(n);let s=Nt();return an(s.cliente.domicilio,i)||(s.cliente.domicilio=i),dn(i)}),b()(),D(13,"p")(14,"label"),x(15,"Selecciona el tipo de cliente:"),b(),D(16,"select",10),Gt("ngModelChange",function(i){un(n);let s=Nt();return an(s.cliente.tipoCliente,i)||(s.cliente.tipoCliente=i),dn(i)}),on(17,e8,2,2,"option",11),b()(),D(18,"table",12)(19,"tr",13)(20,"td",14)(21,"button",15),je("click",function(){un(n);let i=Nt();return dn(i.insertarCliente())}),x(22,"Insertar"),b()(),D(23,"td",14)(24,"button",16),je("click",function(){un(n);let i=Nt();return dn(i.updateCliente())}),x(25,"Modificar"),b()(),D(26,"td",14)(27,"button",17),je("click",function(){un(n);let i=Nt();return dn(i.deleteCliente(i.cliente.id))}),x(28,"Eliminar"),b()()()()()}if(t&2){let n=Nt();K(4),Ht("ngModel",n.cliente.nombre),K(4),Ht("ngModel",n.cliente.rfc),K(4),Ht("ngModel",n.cliente.domicilio),K(4),Ht("ngModel",n.cliente.tipoCliente),K(),Fe("ngForOf",n.tipos)}}function n8(t,e){if(t&1){let n=As();D(0,"tr")(1,"td"),x(2),b(),D(3,"td"),x(4),b(),D(5,"td"),x(6),b(),D(7,"td"),x(8),b(),D(9,"td")(10,"button",15),je("click",function(){let s=un(n).$implicit,o=Nt(2);return dn(o.selectCliente(s))}),x(11," Seleccionar "),b()()()}if(t&2){let n=e.$implicit;K(2),hn(n.nombre),K(2),hn(n.rfc),K(2),hn(n.domicilio),K(2),hn(n.tipoCliente)}}function r8(t,e){if(t&1&&(D(0,"table",19)(1,"thead")(2,"th"),x(3,"Nombre"),b(),D(4,"th"),x(5,"RFC"),b(),D(6,"th"),x(7,"Domicilio"),b(),D(8,"th"),x(9,"Tipo de cliente"),b()(),D(10,"tbody"),on(11,n8,12,4,"tr",20),b()()),t&2){let n=Nt();K(11),Fe("ngForOf",n.clientes)}}function i8(t,e){t&1&&(D(0,"div",21)(1,"strong"),x(2,"Tipos de cliente:"),b(),it(3,"br"),x(4," 1: Clientes activos"),it(5,"br"),x(6," 2: Clientes inactivos"),it(7,"br"),x(8,` 3: Clientes deudores
`),b())}var GL=(()=>{let e=class e{constructor(r){this.clienteService=r,this.clientes=[],this.cliente=new Qs,this.tipos=[]}ngOnInit(){this.clienteService.getClientes().subscribe(r=>{this.clientes=r.map(i=>le(A({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.tipos=this.clienteService.getTipos()}insertarCliente(){this.clienteService.createCliente(this.cliente),this.cliente=new Qs}selectCliente(r){this.cliente=r}updateCliente(){this.clienteService.updateCliente,this.cliente=new Qs}deleteCliente(r){this.clienteService.deleteCliente(r),this.cliente=new Qs}};e.\u0275fac=function(i){return new(i||e)(ie(CL))},e.\u0275cmp=Rt({type:e,selectors:[["app-lista-clientes"]],decls:8,vars:4,consts:[[1,"mt-3","text-center"],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"w-50"],["class","col-sm mb-4",4,"ngIf"],["class","table",4,"ngIf"],["class","mb-4 text-center",4,"ngIf"],[1,"col-sm","mb-4"],["for",""],["type","text","name","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"w-100"],[1,"row"],[1,"col","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[3,"value"],[1,"table"],[4,"ngFor","ngForOf"],[1,"mb-4","text-center"]],template:function(i,s){i&1&&(D(0,"h3",0),x(1,"Listado de clientes"),b(),on(2,J6,2,0,"div",1),D(3,"div",2)(4,"div",3),on(5,t8,29,5,"div",4),b()(),on(6,r8,12,1,"table",5)(7,i8,9,0,"div",6)),i&2&&(K(2),Fe("ngIf",!s.clientes.length),K(3),Fe("ngIf",s.clientes.length),K(),Fe("ngIf",s.clientes.length),K(),Fe("ngIf",s.clientes.length))},dependencies:[ma,Ff,oy,ay,cs,Uc,jc,Ao]});let t=e;return t})();var xo=class{};var zL=(()=>{let e=class e{constructor(r){this.firestore=r}getLibros(){return this.firestore.collection("libros").snapshotChanges()}createLibro(r){return this.firestore.collection("libros").add(Object.assign({},r))}updateLibro(r){this.firestore.doc("libros/"+r.id).update(r)}deleteLibro(r){this.firestore.doc("libros/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(Lc))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function o8(t,e){if(t&1){let n=As();D(0,"tr")(1,"td"),x(2),b(),D(3,"td"),x(4),b(),D(5,"td"),x(6),b(),D(7,"td"),x(8),b(),D(9,"td")(10,"button",11),je("click",function(){let s=un(n).$implicit,o=Nt();return dn(o.selectLibro(s))}),x(11," Seleccionar "),b()()()}if(t&2){let n=e.$implicit;K(2),hn(n.titulo),K(2),hn(n.autor),K(2),hn(n.editorial),K(2),hn(n.fecha)}}var WL=(()=>{let e=class e{constructor(r){this.libroService=r,this.libros=[],this.libro=new xo}ngOnInit(){this.libroService.getLibros().subscribe(r=>{this.libros=r.map(i=>le(A({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarLibro(){this.libroService.createLibro(this.libro),this.libro=new xo}selectLibro(r){this.libro=r}updateLibro(){this.libroService.updateLibro,this.libro=new xo}deleteLibro(r){this.libroService.deleteLibro(r),this.libro=new xo}};e.\u0275fac=function(i){return new(i||e)(ie(zL))},e.\u0275cmp=Rt({type:e,selectors:[["app-listado-libros"]],decls:47,vars:5,consts:[[1,"container"],[1,"mt-3","text-center"],[1,"d-flex","justify-content-center"],[1,"w-50"],[1,"col-sm","mb-4"],["for",""],["type","text","name","",1,"form-control",3,"ngModel","ngModelChange"],["type","number","name","",1,"form-control",3,"ngModel","ngModelChange"],[1,"w-100"],[1,"row"],[1,"col","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(i,s){i&1&&(D(0,"div",0)(1,"h3",1),x(2,"Alta de libros"),b(),D(3,"div",2)(4,"div",3)(5,"div",4)(6,"p")(7,"label",5),x(8,"T\xEDtulo:"),b(),D(9,"input",6),Gt("ngModelChange",function(a){return an(s.libro.titulo,a)||(s.libro.titulo=a),a}),b()(),D(10,"p")(11,"label",5),x(12,"Autor:"),b(),D(13,"input",6),Gt("ngModelChange",function(a){return an(s.libro.autor,a)||(s.libro.autor=a),a}),b()(),D(14,"p")(15,"label",5),x(16,"Editorial:"),b(),D(17,"input",6),Gt("ngModelChange",function(a){return an(s.libro.editorial,a)||(s.libro.editorial=a),a}),b()(),D(18,"p")(19,"label",5),x(20,"Fecha:"),b(),D(21,"input",7),Gt("ngModelChange",function(a){return an(s.libro.fecha,a)||(s.libro.fecha=a),a}),b()(),D(22,"table",8)(23,"tr",9)(24,"td",10)(25,"button",11),je("click",function(){return s.insertarLibro()}),x(26,"Insertar"),b()(),D(27,"td",10)(28,"button",12),je("click",function(){return s.updateLibro()}),x(29,"Modificar"),b()(),D(30,"td",10)(31,"button",13),je("click",function(){return s.deleteLibro(s.libro.id)}),x(32,"Eliminar"),b()()()()()()(),D(33,"table",14)(34,"thead")(35,"th"),x(36,"Titulo"),b(),D(37,"th"),x(38,"Autor"),b(),D(39,"th"),x(40,"Editorial"),b(),D(41,"th"),x(42,"Fecha de publicacion"),b(),D(43,"th"),x(44,"Seleccionar"),b()(),D(45,"tbody"),on(46,o8,12,4,"tr",15),b()()()),i&2&&(K(9),Ht("ngModel",s.libro.titulo),K(4),Ht("ngModel",s.libro.autor),K(4),Ht("ngModel",s.libro.editorial),K(4),Ht("ngModel",s.libro.fecha),K(25),Fe("ngForOf",s.libros))},dependencies:[ma,cs,Rb,jc,Ao]});let t=e;return t})();var Mo=class{};var KL=(()=>{let e=class e{constructor(r){this.firestore=r,this.generos=[],this.generos=[{id:0,descripcion:"Sin definir"},{id:1,descripcion:"M\xFAsica cl\xE1sica"},{id:2,descripcion:"Jazz"},{id:3,descripcion:"Blues"},{id:4,descripcion:"Salsa"},{id:5,descripcion:"Flamenco"},{id:6,descripcion:"Pop"},{id:7,descripcion:"Rock"},{id:8,descripcion:"Metal"},{id:9,descripcion:"Hip Hop"}]}getAlbumes(){return this.firestore.collection("albumes").snapshotChanges()}getGeneros(){return this.generos}createAlbum(r){return this.firestore.collection("albumes").add(Object.assign({},r))}updateAlbum(r){this.firestore.doc("albumes/"+r.id).update(r)}deleteAlbum(r){this.firestore.doc("albumes/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(Lc))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function c8(t,e){if(t&1&&(D(0,"option",15),x(1),b()),t&2){let n=e.$implicit;da("value",n.id),K(),ha(" ",n.descripcion," ")}}function l8(t,e){t&1&&(D(0,"div",16),x(1,"No hay \xE1lbumes disponibles "),it(2,"i",17),b())}function u8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: M\xFAsica cl\xE1sica"),b())}function d8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Jazz"),b())}function h8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Blues"),b())}function f8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Salsa"),b())}function p8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Flamenco"),b())}function g8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Pop"),b())}function m8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Rock"),b())}function y8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Metal"),b())}function _8(t,e){t&1&&(D(0,"p"),x(1,"G\xE9nero: Hip Hop"),b())}function v8(t,e){if(t&1){let n=As();D(0,"div",20)(1,"div",21),it(2,"img",22),D(3,"div",23)(4,"h5",24),x(5),b(),on(6,u8,2,0,"p",25)(7,d8,2,0,"p",25)(8,h8,2,0,"p",25)(9,f8,2,0,"p",25)(10,p8,2,0,"p",25)(11,g8,2,0,"p",25)(12,m8,2,0,"p",25)(13,y8,2,0,"p",25)(14,_8,2,0,"p",25),D(15,"button",10),je("click",function(){let s=un(n).$implicit,o=Nt(2);return dn(o.selectAlbum(s))}),x(16," Seleccionar "),b()()()()}if(t&2){let n=e.$implicit;K(2),da("src",n.urlImagen,av),K(3),hn(n.nombre),K(),Fe("ngIf",n.generoAlbum==1),K(),Fe("ngIf",n.generoAlbum==2),K(),Fe("ngIf",n.generoAlbum==3),K(),Fe("ngIf",n.generoAlbum==4),K(),Fe("ngIf",n.generoAlbum==5),K(),Fe("ngIf",n.generoAlbum==6),K(),Fe("ngIf",n.generoAlbum==7),K(),Fe("ngIf",n.generoAlbum==8),K(),Fe("ngIf",n.generoAlbum==9)}}function w8(t,e){if(t&1&&(D(0,"div",18),on(1,v8,17,11,"div",19),b()),t&2){let n=Nt();K(),Fe("ngForOf",n.albumes)}}var QL=(()=>{let e=class e{constructor(r){this.albumService=r,this.albumes=[],this.album=new Mo,this.generos=[]}ngOnInit(){this.albumService.getAlbumes().subscribe(r=>{this.albumes=r.map(i=>le(A({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.generos=this.albumService.getGeneros()}insertarAlbum(){this.albumService.createAlbum(this.album),this.album=new Mo}selectAlbum(r){this.album=r}updateAlbum(){this.albumService.updateAlbum,this.album=new Mo}deleteAlbum(r){this.albumService.deleteAlbum(r),this.album=new Mo}};e.\u0275fac=function(i){return new(i||e)(ie(KL))},e.\u0275cmp=Rt({type:e,selectors:[["app-lista-albumes"]],decls:34,vars:6,consts:[[1,"mt-3","text-center"],[1,"d-flex","justify-content-center"],[1,"w-50"],[1,"col-sm","mb-4"],["type","text","name","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"w-100"],[1,"row"],[1,"col","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["class","nes-table-responsive mb-4",4,"ngIf"],["class","row row-cols-1 row-cols-md-5 g-4",4,"ngIf"],[3,"value"],[1,"nes-table-responsive","mb-4"],[1,"nes-pokeball"],[1,"row","row-cols-1","row-cols-md-5","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card"],["alt","...",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[4,"ngIf"]],template:function(i,s){i&1&&(D(0,"h3",0),x(1,"Agregar \xC1lbum de M\xFAsica"),b(),D(2,"div",1)(3,"div",2)(4,"div",3)(5,"p")(6,"label"),x(7,"Nombre del \xE1lbum:"),b(),D(8,"input",4),Gt("ngModelChange",function(a){return an(s.album.nombre,a)||(s.album.nombre=a),a}),b()(),D(9,"p")(10,"label"),x(11,"URL de im\xE1gen del \xE1lbum:"),b(),D(12,"input",4),Gt("ngModelChange",function(a){return an(s.album.urlImagen,a)||(s.album.urlImagen=a),a}),b()(),it(13,"br"),D(14,"label"),x(15,"Selecciona el g\xE9nero del \xE1lbum:"),b(),D(16,"select",5),Gt("ngModelChange",function(a){return an(s.album.generoAlbum,a)||(s.album.generoAlbum=a),a}),on(17,c8,2,2,"option",6),b(),it(18,"br"),D(19,"table",7)(20,"tr",8)(21,"td",9)(22,"button",10),je("click",function(){return s.insertarAlbum()}),x(23,"Insertar"),b()(),D(24,"td",9)(25,"button",11),je("click",function(){return s.updateAlbum()}),x(26,"Modificar"),b()(),D(27,"td",9)(28,"button",12),je("click",function(){return s.deleteAlbum(s.album.id)}),x(29,"Eliminar"),b()()()()()()(),D(30,"h3",0),x(31,"Lista de \xC1lbumes"),b(),on(32,l8,3,0,"div",13)(33,w8,2,1,"div",14)),i&2&&(K(8),Ht("ngModel",s.album.nombre),K(4),Ht("ngModel",s.album.urlImagen),K(4),Ht("ngModel",s.album.generoAlbum),K(),Fe("ngForOf",s.generos),K(15),Fe("ngIf",!s.albumes.length),K(),Fe("ngIf",s.albumes.length))},dependencies:[ma,Ff,oy,ay,cs,Uc,jc,Ao]});let t=e;return t})();var E8=[{path:"home",component:SP},{path:"libros",component:WL},{path:"clientes",component:GL},{path:"albumes",component:QL},{path:"about",component:AP},{path:"**",redirectTo:"home"}],YL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e}),e.\u0275inj=qe({imports:[VI.forRoot(E8),VI]});let t=e;return t})();var ZL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-menu"]],decls:20,vars:0,consts:[["data-bs-theme","light",1,"navbar","navbar-expand-lg","bg-light"],[1,"container-fluid"],["routerLink","/home",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarColor03","aria-controls","navbarColor03","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarColor03",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto"],[1,"nav-item"],["routerLink","/libros",1,"nav-link"],["routerLink","/clientes",1,"nav-link"],["routerLink","/albumes",1,"nav-link"],["routerLink","/about",1,"nav-link"]],template:function(i,s){i&1&&(D(0,"nav",0)(1,"div",1)(2,"a",2),x(3,"Home"),b(),D(4,"button",3),it(5,"span",4),b(),D(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),x(10,"Libros"),b()(),D(11,"li",7)(12,"a",9),x(13,"Clientes"),b()(),D(14,"li",7)(15,"a",10),x(16,"Ejercicio 1er Parcial (Albums)"),b()(),D(17,"li",7)(18,"a",11),x(19,"Acerca de..."),b()()()()()())},dependencies:[IP]});let t=e;return t})();var XL=(()=>{let e=class e{constructor(){this.title="evaluaciondos"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){i&1&&it(0,"app-menu")(1,"router-outlet")},dependencies:[RI,ZL]});let t=e;return t})();var JL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$e({type:e,bootstrap:[XL]}),e.\u0275inj=qe({imports:[Wx,YL,HL,Xx.initializeApp(FN.firebaseConfig),ON,Vx]});let t=e;return t})();zx().bootstrapModule(JL).catch(t=>console.error(t));
